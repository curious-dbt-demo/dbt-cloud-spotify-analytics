2022-12-25 15:58:41.543692 (MainThread): Running with dbt=1.3.1
2022-12-25 15:58:42.113045 (MainThread): 15:58:42  [WARNING]: Deprecated functionality
The `source-paths` config has been renamed to `model-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
2022-12-25 15:58:42.113353 (MainThread): 15:58:42  Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c219730>]}
2022-12-25 15:58:42.113595 (MainThread): 15:58:42  [WARNING]: Deprecated functionality
The `data-paths` config has been renamed to `seed-paths`. Please update your
`dbt_project.yml` configuration to reflect this change.
2022-12-25 15:58:42.113764 (MainThread): 15:58:42  Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c26d7f0>]}
2022-12-25 15:58:42.146711 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt_rpc.task.server.RPCServerTask'>, debug=None, defer=None, exclude=None, fail_fast=None, host='0.0.0.0', log_cache_events=False, log_format=None, models=None, partial_parse=True, port=8580, printer_width=None, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='rpc', write_json=None)
2022-12-25 15:58:42.158857 (MainThread): Tracking: tracking
2022-12-25 15:58:42.168043 (MainThread): 15:58:42  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c2194c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c258af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35427b16a0>]}
2022-12-25 15:58:42.168396 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=22
2022-12-25 15:58:42.168683 (MainThread): Supported methods: ['build', 'cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'list', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'source-freshness', 'status', 'test']
2022-12-25 15:58:42.168849 (MainThread): Send requests to http://localhost:8580/jsonrpc
2022-12-25 15:58:43.220312 (Thread-13): handling ps request
2022-12-25 15:58:43.221317 (Thread-14): handling status request
2022-12-25 15:58:43.221605 (Thread-13): 15:58:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c23daf0>]}
2022-12-25 15:58:43.221908 (Thread-14): 15:58:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c1d3340>]}
2022-12-25 15:58:43.222558 (Thread-13): sending response (<Response 100 bytes [200 OK]>) to 10.0.33.202
2022-12-25 15:58:43.223034 (Thread-14): sending response (<Response 356 bytes [200 OK]>) to 10.0.33.202
2022-12-25 15:58:44.366740 (Thread-15): handling status request
2022-12-25 15:58:44.367145 (Thread-15): 15:58:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c23d7f0>]}
2022-12-25 15:58:44.367571 (Thread-15): sending response (<Response 356 bytes [200 OK]>) to 10.0.33.202
2022-12-25 15:59:01.670376 (Thread-16): handling status request
2022-12-25 15:59:01.671502 (Thread-16): 15:59:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c23d820>]}
2022-12-25 15:59:01.671937 (Thread-16): sending response (<Response 356 bytes [200 OK]>) to 10.0.33.202
2022-12-25 15:59:01.725946 (Thread-17): handling cli_args request
2022-12-25 15:59:01.726334 (Thread-17): 15:59:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c23da30>]}
2022-12-25 15:59:01.726764 (Thread-17): sending response (<Response 676 bytes [200 OK]>) to 10.0.33.202
2022-12-25 15:59:02.010601 (Thread-18): handling ps request
2022-12-25 15:59:02.011009 (Thread-18): 15:59:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c1d32b0>]}
2022-12-25 15:59:02.011414 (Thread-18): sending response (<Response 100 bytes [200 OK]>) to 10.0.33.202
2022-12-25 15:59:02.020587 (Thread-19): handling poll request
2022-12-25 15:59:02.020889 (Thread-19): 15:59:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c1d3520>]}
2022-12-25 15:59:02.021434 (Thread-19): sending response (<Response 341 bytes [200 OK]>) to 10.0.33.202
2022-12-25 15:59:02.167750 (Thread-20): handling status request
2022-12-25 15:59:02.168212 (Thread-20): 15:59:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c23d3d0>]}
2022-12-25 15:59:02.168636 (Thread-20): sending response (<Response 356 bytes [200 OK]>) to 10.0.33.202
2022-12-25 15:59:10.105366 (Thread-21): handling status request
2022-12-25 15:59:10.106483 (Thread-21): 15:59:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c1d3850>]}
2022-12-25 15:59:10.106919 (Thread-21): sending response (<Response 356 bytes [200 OK]>) to 10.0.33.202
2022-12-25 15:59:19.176211 (Thread-22): handling status request
2022-12-25 15:59:19.176638 (Thread-22): 15:59:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c1d39d0>]}
2022-12-25 15:59:19.177061 (Thread-22): sending response (<Response 356 bytes [200 OK]>) to 10.0.33.202
2022-12-25 15:59:19.185716 (Thread-23): handling ps request
2022-12-25 15:59:19.185978 (Thread-23): 15:59:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c1d3b50>]}
2022-12-25 15:59:19.186290 (Thread-23): sending response (<Response 100 bytes [200 OK]>) to 10.0.33.202
2022-12-25 15:59:19.317989 (Thread-24): handling deps request
2022-12-25 15:59:19.318373 (Thread-24): 15:59:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c1d3d00>]}
2022-12-25 15:59:19.361032 (Thread-24): sending response (<Response 133 bytes [200 OK]>) to 10.0.33.202
2022-12-25 15:59:19.403553 (Thread-25): handling status request
2022-12-25 15:59:19.403993 (Thread-25): 15:59:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c1f8bb0>]}
2022-12-25 15:59:19.404632 (Thread-25): sending response (<Response 180 bytes [200 OK]>) to 10.0.33.202
2022-12-25 15:59:19.640747 (Thread-26): handling ps request
2022-12-25 15:59:19.641211 (Thread-26): 15:59:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c1d3550>]}
2022-12-25 15:59:19.641802 (Thread-26): sending response (<Response 464 bytes [200 OK]>) to 10.0.33.202
2022-12-25 15:59:19.649516 (Thread-27): handling poll request
2022-12-25 15:59:19.649794 (Thread-27): 15:59:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c1d3d90>]}
2022-12-25 15:59:19.650264 (Thread-27): sending response (<Response 279 bytes [200 OK]>) to 10.0.33.202
2022-12-25 15:59:19.893924 (Thread-28): handling status request
2022-12-25 15:59:19.894363 (Thread-28): 15:59:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c1f8ee0>]}
2022-12-25 15:59:19.894797 (Thread-28): sending response (<Response 180 bytes [200 OK]>) to 10.0.33.202
2022-12-25 15:59:19.904142 (Thread-29): handling ps request
2022-12-25 15:59:19.904436 (Thread-29): 15:59:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c1d3340>]}
2022-12-25 15:59:19.904825 (Thread-29): sending response (<Response 464 bytes [200 OK]>) to 10.0.33.202
2022-12-25 15:59:20.098552 (Thread-30): handling status request
2022-12-25 15:59:20.098959 (Thread-30): 15:59:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c1d32b0>]}
2022-12-25 15:59:20.099414 (Thread-30): sending response (<Response 180 bytes [200 OK]>) to 10.0.33.202
2022-12-25 15:59:20.814938 (Thread-31): handling status request
2022-12-25 15:59:20.815348 (Thread-31): 15:59:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c1f8b80>]}
2022-12-25 15:59:20.815786 (Thread-31): sending response (<Response 180 bytes [200 OK]>) to 10.0.33.202
2022-12-25 15:59:20.876781 (Thread-32): handling poll request
2022-12-25 15:59:20.877196 (Thread-32): 15:59:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c1f8760>]}
2022-12-25 15:59:20.877661 (Thread-32): sending response (<Response 279 bytes [200 OK]>) to 10.0.33.202
2022-12-25 15:59:21.552711 (Thread-33): handling status request
2022-12-25 15:59:21.553094 (Thread-33): 15:59:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c1f8fa0>]}
2022-12-25 15:59:21.553528 (Thread-33): sending response (<Response 180 bytes [200 OK]>) to 10.0.33.202
2022-12-25 15:59:21.952135 (MainThread): 15:59:21  Set downloads directory='/tmp/dbt-downloads-tx7k1kw3'
2022-12-25 15:59:21.952826 (MainThread): 15:59:21  Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
2022-12-25 15:59:22.026685 (MainThread): 15:59:22  Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
2022-12-25 15:59:22.026963 (MainThread): 15:59:22  Making package registry request: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json
2022-12-25 15:59:22.097229 (MainThread): 15:59:22  Response from registry: GET https://hub.getdbt.com/api/v1/fishtown-analytics/dbt_utils.json 200
2022-12-25 15:59:22.097735 (MainThread): 15:59:22  [WARNING]: Deprecated functionality
The `fishtown-analytics/dbt_utils` package is deprecated in favor of
`dbt-labs/dbt_utils`. Please update your `packages.yml` configuration to use
`dbt-labs/dbt_utils` instead.
2022-12-25 15:59:22.097844 (MainThread): 15:59:22  Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7c7cb3d1-13c3-4dc5-9b2c-6806802c1676', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa90b553d0>]}
2022-12-25 15:59:22.125891 (MainThread): 15:59:22  Installing fishtown-analytics/dbt_utils
2022-12-25 15:59:22.134787 (Thread-34): handling poll request
2022-12-25 15:59:22.135109 (Thread-34): 15:59:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c1d34c0>]}
2022-12-25 15:59:22.135635 (Thread-34): sending response (<Response 3210 bytes [200 OK]>) to 10.0.33.202
2022-12-25 15:59:22.145124 (Thread-35): handling ps request
2022-12-25 15:59:22.145421 (Thread-35): 15:59:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c23d850>]}
2022-12-25 15:59:22.145811 (Thread-35): sending response (<Response 464 bytes [200 OK]>) to 10.0.33.202
2022-12-25 15:59:22.257001 (Thread-36): handling status request
2022-12-25 15:59:22.257383 (Thread-36): 15:59:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c23dd00>]}
2022-12-25 15:59:22.257762 (Thread-36): sending response (<Response 180 bytes [200 OK]>) to 10.0.33.202
2022-12-25 15:59:22.964419 (Thread-37): handling status request
2022-12-25 15:59:22.964812 (Thread-37): 15:59:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c23dd60>]}
2022-12-25 15:59:22.965246 (Thread-37): sending response (<Response 180 bytes [200 OK]>) to 10.0.33.202
2022-12-25 15:59:23.338115 (Thread-38): handling poll request
2022-12-25 15:59:23.338546 (Thread-38): 15:59:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c23d490>]}
2022-12-25 15:59:23.339033 (Thread-38): sending response (<Response 279 bytes [200 OK]>) to 10.0.33.202
2022-12-25 15:59:23.666307 (Thread-39): handling status request
2022-12-25 15:59:23.666668 (Thread-39): 15:59:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c23d640>]}
2022-12-25 15:59:23.693837 (Thread-39): sending response (<Response 180 bytes [200 OK]>) to 10.0.33.202
2022-12-25 15:59:24.390492 (Thread-40): handling ps request
2022-12-25 15:59:24.390901 (Thread-40): 15:59:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c23da30>]}
2022-12-25 15:59:24.391399 (Thread-40): sending response (<Response 464 bytes [200 OK]>) to 10.0.33.202
2022-12-25 15:59:24.430135 (Thread-41): handling status request
2022-12-25 15:59:24.430473 (Thread-41): 15:59:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c23d580>]}
2022-12-25 15:59:24.430855 (Thread-41): sending response (<Response 180 bytes [200 OK]>) to 10.0.33.202
2022-12-25 15:59:24.539990 (Thread-42): handling poll request
2022-12-25 15:59:24.540264 (Thread-42): 15:59:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c1ffe50>]}
2022-12-25 15:59:24.540651 (Thread-42): sending response (<Response 279 bytes [200 OK]>) to 10.0.33.202
2022-12-25 15:59:25.140726 (Thread-43): handling status request
2022-12-25 15:59:25.141122 (Thread-43): 15:59:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c1ff970>]}
2022-12-25 15:59:25.141563 (Thread-43): sending response (<Response 180 bytes [200 OK]>) to 10.0.33.202
2022-12-25 15:59:25.748883 (Thread-44): handling poll request
2022-12-25 15:59:25.749297 (Thread-44): 15:59:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c1ffca0>]}
2022-12-25 15:59:25.749764 (Thread-44): sending response (<Response 279 bytes [200 OK]>) to 10.0.33.202
2022-12-25 15:59:25.848680 (Thread-45): handling status request
2022-12-25 15:59:25.848965 (Thread-45): 15:59:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c1fffd0>]}
2022-12-25 15:59:25.849349 (Thread-45): sending response (<Response 180 bytes [200 OK]>) to 10.0.33.202
2022-12-25 15:59:25.943685 (MainThread): 15:59:25    Installed from version 0.6.2
2022-12-25 15:59:25.943864 (MainThread): 15:59:25    Updated version available: 0.7.0
2022-12-25 15:59:25.944034 (MainThread): 15:59:25  Sending event: {'category': 'dbt', 'action': 'package', 'label': '7c7cb3d1-13c3-4dc5-9b2c-6806802c1676', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa9028bf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa9028b730>]}
2022-12-25 15:59:25.944255 (MainThread): 15:59:25  
2022-12-25 15:59:25.944340 (MainThread): 15:59:25  Updates available for packages: ['fishtown-analytics/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
2022-12-25 15:59:26.605131 (Thread-46): handling status request
2022-12-25 15:59:26.605590 (Thread-46): 15:59:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c208820>]}
2022-12-25 15:59:26.606150 (Thread-46): sending response (<Response 5486 bytes [200 OK]>) to 10.0.33.202
2022-12-25 15:59:26.652684 (Thread-47): handling ps request
2022-12-25 15:59:26.653087 (Thread-47): 15:59:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c208cd0>]}
2022-12-25 15:59:26.653611 (Thread-47): sending response (<Response 487 bytes [200 OK]>) to 10.0.33.202
2022-12-25 15:59:26.855246 (Thread-48): handling status request
2022-12-25 15:59:26.855600 (Thread-48): 15:59:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c2083d0>]}
2022-12-25 15:59:26.856122 (Thread-48): sending response (<Response 5486 bytes [200 OK]>) to 10.0.33.202
2022-12-25 15:59:26.967469 (Thread-49): handling poll request
2022-12-25 15:59:26.967803 (Thread-49): 15:59:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c18f550>]}
2022-12-25 15:59:26.968206 (Thread-49): sending response (<Response 788 bytes [200 OK]>) to 10.0.33.202
2022-12-25 15:59:29.632741 (Thread-50): handling status request
2022-12-25 15:59:29.633219 (Thread-50): 15:59:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c18f940>]}
2022-12-25 15:59:29.633791 (Thread-50): sending response (<Response 5486 bytes [200 OK]>) to 10.0.33.202
2022-12-25 15:59:44.687635 (Thread-51): handling ps request
2022-12-25 15:59:44.689634 (Thread-51): 15:59:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c1f8460>]}
2022-12-25 15:59:44.690164 (Thread-51): sending response (<Response 487 bytes [200 OK]>) to 10.0.33.202
2022-12-25 15:59:44.831120 (Thread-52): handling ps request
2022-12-25 15:59:44.831613 (Thread-52): 15:59:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c18f760>]}
2022-12-25 15:59:44.832135 (Thread-52): sending response (<Response 487 bytes [200 OK]>) to 10.0.33.202
2022-12-25 15:59:44.891569 (Thread-53): handling status request
2022-12-25 15:59:44.891982 (Thread-53): 15:59:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c1f89d0>]}
2022-12-25 15:59:44.892533 (Thread-53): sending response (<Response 5486 bytes [200 OK]>) to 10.0.33.202
2022-12-25 15:59:44.959375 (Thread-54): handling status request
2022-12-25 15:59:44.959720 (Thread-54): 15:59:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c1f87c0>]}
2022-12-25 15:59:44.960236 (Thread-54): sending response (<Response 5469 bytes [200 OK]>) to 10.0.33.202
2022-12-25 15:59:49.315801 (Thread-55): handling status request
2022-12-25 15:59:49.316203 (Thread-55): 15:59:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': '7683b612-d295-477b-ae06-4680d7c26172', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350c1f8b80>]}
2022-12-25 15:59:49.316755 (Thread-55): sending response (<Response 5469 bytes [200 OK]>) to 10.0.33.202
2022-12-25 17:17:14.880873 (MainThread): Running with dbt=1.3.1
2022-12-25 17:17:15.485501 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt_rpc.task.server.RPCServerTask'>, debug=None, defer=None, exclude=None, fail_fast=None, host='0.0.0.0', log_cache_events=False, log_format=None, models=None, partial_parse=True, port=8580, printer_width=None, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='rpc', write_json=None)
2022-12-25 17:17:15.489190 (MainThread): Tracking: tracking
2022-12-25 17:17:15.510116 (Thread-12): 17:17:15  Partial parse save file not found. Starting full parse.
2022-12-25 17:17:15.510745 (Thread-12): 17:17:15  Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf944b42b0>]}
2022-12-25 17:17:15.511758 (MainThread): 17:17:15  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfcd3ecb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf944b42b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf944b43d0>]}
2022-12-25 17:17:15.512075 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=29
2022-12-25 17:17:15.512382 (MainThread): Supported methods: ['build', 'cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'list', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'source-freshness', 'status', 'test']
2022-12-25 17:17:15.512664 (MainThread): Send requests to http://localhost:8580/jsonrpc
2022-12-25 17:17:15.599153 (Thread-12): 17:17:15  Parsing macros/etc.sql
2022-12-25 17:17:15.602083 (Thread-12): 17:17:15  Parsing macros/catalog.sql
2022-12-25 17:17:15.607606 (Thread-12): 17:17:15  Parsing macros/adapters.sql
2022-12-25 17:17:15.627637 (Thread-12): 17:17:15  Parsing macros/adapters/apply_grants.sql
2022-12-25 17:17:15.630127 (Thread-12): 17:17:15  Parsing macros/materializations/seed.sql
2022-12-25 17:17:15.632602 (Thread-12): 17:17:15  Parsing macros/materializations/incremental.sql
2022-12-25 17:17:15.648948 (Thread-12): 17:17:15  Parsing macros/materializations/snapshot.sql
2022-12-25 17:17:15.650532 (Thread-12): 17:17:15  Parsing macros/materializations/table.sql
2022-12-25 17:17:15.657044 (Thread-12): 17:17:15  Parsing macros/materializations/copy.sql
2022-12-25 17:17:15.659557 (Thread-12): 17:17:15  Parsing macros/materializations/view.sql
2022-12-25 17:17:15.662187 (Thread-12): 17:17:15  Parsing macros/utils/intersect.sql
2022-12-25 17:17:15.662611 (Thread-12): 17:17:15  Parsing macros/utils/position.sql
2022-12-25 17:17:15.663161 (Thread-12): 17:17:15  Parsing macros/utils/escape_single_quotes.sql
2022-12-25 17:17:15.663724 (Thread-12): 17:17:15  Parsing macros/utils/safe_cast.sql
2022-12-25 17:17:15.664243 (Thread-12): 17:17:15  Parsing macros/utils/array_construct.sql
2022-12-25 17:17:15.665069 (Thread-12): 17:17:15  Parsing macros/utils/datediff.sql
2022-12-25 17:17:15.666257 (Thread-12): 17:17:15  Parsing macros/utils/timestamps.sql
2022-12-25 17:17:15.667360 (Thread-12): 17:17:15  Parsing macros/utils/array_concat.sql
2022-12-25 17:17:15.667898 (Thread-12): 17:17:15  Parsing macros/utils/right.sql
2022-12-25 17:17:15.668531 (Thread-12): 17:17:15  Parsing macros/utils/array_append.sql
2022-12-25 17:17:15.669176 (Thread-12): 17:17:15  Parsing macros/utils/split_part.sql
2022-12-25 17:17:15.670559 (Thread-12): 17:17:15  Parsing macros/utils/date_trunc.sql
2022-12-25 17:17:15.671125 (Thread-12): 17:17:15  Parsing macros/utils/hash.sql
2022-12-25 17:17:15.671635 (Thread-12): 17:17:15  Parsing macros/utils/except.sql
2022-12-25 17:17:15.672015 (Thread-12): 17:17:15  Parsing macros/utils/bool_or.sql
2022-12-25 17:17:15.672459 (Thread-12): 17:17:15  Parsing macros/utils/dateadd.sql
2022-12-25 17:17:15.673104 (Thread-12): 17:17:15  Parsing macros/utils/listagg.sql
2022-12-25 17:17:15.674082 (Thread-12): 17:17:15  Parsing macros/etc/statement.sql
2022-12-25 17:17:15.678811 (Thread-12): 17:17:15  Parsing macros/etc/datetime.sql
2022-12-25 17:17:15.686512 (Thread-12): 17:17:15  Parsing macros/adapters/apply_grants.sql
2022-12-25 17:17:15.699419 (Thread-12): 17:17:15  Parsing macros/adapters/freshness.sql
2022-12-25 17:17:15.701303 (Thread-12): 17:17:15  Parsing macros/adapters/columns.sql
2022-12-25 17:17:15.710314 (Thread-12): 17:17:15  Parsing macros/adapters/timestamps.sql
2022-12-25 17:17:15.713575 (Thread-12): 17:17:15  Parsing macros/adapters/relation.sql
2022-12-25 17:17:15.727540 (Thread-12): 17:17:15  Parsing macros/adapters/schema.sql
2022-12-25 17:17:15.729644 (Thread-12): 17:17:15  Parsing macros/adapters/persist_docs.sql
2022-12-25 17:17:15.733956 (Thread-12): 17:17:15  Parsing macros/adapters/metadata.sql
2022-12-25 17:17:15.740571 (Thread-12): 17:17:15  Parsing macros/adapters/indexes.sql
2022-12-25 17:17:15.743149 (Thread-12): 17:17:15  Parsing macros/get_custom_name/get_custom_database.sql
2022-12-25 17:17:15.744601 (Thread-12): 17:17:15  Parsing macros/get_custom_name/get_custom_schema.sql
2022-12-25 17:17:15.746970 (Thread-12): 17:17:15  Parsing macros/get_custom_name/get_custom_alias.sql
2022-12-25 17:17:15.748341 (Thread-12): 17:17:15  Parsing macros/python_model/python.sql
2022-12-25 17:17:15.754092 (Thread-12): 17:17:15  Parsing macros/materializations/hooks.sql
2022-12-25 17:17:15.757695 (Thread-12): 17:17:15  Parsing macros/materializations/configs.sql
2022-12-25 17:17:15.759903 (Thread-12): 17:17:15  Parsing macros/materializations/seeds/seed.sql
2022-12-25 17:17:15.766212 (Thread-12): 17:17:15  Parsing macros/materializations/seeds/helpers.sql
2022-12-25 17:17:15.782900 (Thread-12): 17:17:15  Parsing macros/materializations/tests/test.sql
2022-12-25 17:17:15.786963 (Thread-12): 17:17:15  Parsing macros/materializations/tests/helpers.sql
2022-12-25 17:17:15.788580 (Thread-12): 17:17:15  Parsing macros/materializations/tests/where_subquery.sql
2022-12-25 17:17:15.790314 (Thread-12): 17:17:15  Parsing macros/materializations/models/view/helpers.sql
2022-12-25 17:17:15.791555 (Thread-12): 17:17:15  Parsing macros/materializations/models/view/create_or_replace_view.sql
2022-12-25 17:17:15.794607 (Thread-12): 17:17:15  Parsing macros/materializations/models/view/create_view_as.sql
2022-12-25 17:17:15.796748 (Thread-12): 17:17:15  Parsing macros/materializations/models/view/view.sql
2022-12-25 17:17:15.801744 (Thread-12): 17:17:15  Parsing macros/materializations/models/incremental/strategies.sql
2022-12-25 17:17:15.808055 (Thread-12): 17:17:15  Parsing macros/materializations/models/incremental/column_helpers.sql
2022-12-25 17:17:15.815436 (Thread-12): 17:17:15  Parsing macros/materializations/models/incremental/incremental.sql
2022-12-25 17:17:15.824744 (Thread-12): 17:17:15  Parsing macros/materializations/models/incremental/on_schema_change.sql
2022-12-25 17:17:15.839688 (Thread-12): 17:17:15  Parsing macros/materializations/models/incremental/is_incremental.sql
2022-12-25 17:17:15.841097 (Thread-12): 17:17:15  Parsing macros/materializations/models/incremental/merge.sql
2022-12-25 17:17:15.854763 (Thread-12): 17:17:15  Parsing macros/materializations/models/table/create_table_as.sql
2022-12-25 17:17:15.858028 (Thread-12): 17:17:15  Parsing macros/materializations/models/table/table.sql
2022-12-25 17:17:15.863002 (Thread-12): 17:17:15  Parsing macros/materializations/snapshots/strategies.sql
2022-12-25 17:17:15.877395 (Thread-12): 17:17:15  Parsing macros/materializations/snapshots/snapshot_merge.sql
2022-12-25 17:17:15.878950 (Thread-12): 17:17:15  Parsing macros/materializations/snapshots/snapshot.sql
2022-12-25 17:17:15.890166 (Thread-12): 17:17:15  Parsing macros/materializations/snapshots/helpers.sql
2022-12-25 17:17:15.905793 (Thread-12): 17:17:15  Parsing macros/generic_test_sql/not_null.sql
2022-12-25 17:17:15.907042 (Thread-12): 17:17:15  Parsing macros/generic_test_sql/relationships.sql
2022-12-25 17:17:15.907946 (Thread-12): 17:17:15  Parsing macros/generic_test_sql/unique.sql
2022-12-25 17:17:15.908648 (Thread-12): 17:17:15  Parsing macros/generic_test_sql/accepted_values.sql
2022-12-25 17:17:15.910294 (Thread-12): 17:17:15  Parsing macros/utils/intersect.sql
2022-12-25 17:17:15.911289 (Thread-12): 17:17:15  Parsing macros/utils/position.sql
2022-12-25 17:17:15.912597 (Thread-12): 17:17:15  Parsing macros/utils/escape_single_quotes.sql
2022-12-25 17:17:15.914302 (Thread-12): 17:17:15  Parsing macros/utils/safe_cast.sql
2022-12-25 17:17:15.915616 (Thread-12): 17:17:15  Parsing macros/utils/array_construct.sql
2022-12-25 17:17:15.917689 (Thread-12): 17:17:15  Parsing macros/utils/cast_bool_to_text.sql
2022-12-25 17:17:15.919080 (Thread-12): 17:17:15  Parsing macros/utils/datediff.sql
2022-12-25 17:17:15.920705 (Thread-12): 17:17:15  Parsing macros/utils/concat.sql
2022-12-25 17:17:15.921699 (Thread-12): 17:17:15  Parsing macros/utils/length.sql
2022-12-25 17:17:15.923177 (Thread-12): 17:17:15  Parsing macros/utils/any_value.sql
2022-12-25 17:17:15.924308 (Thread-12): 17:17:15  Parsing macros/utils/data_types.sql
2022-12-25 17:17:15.933467 (Thread-12): 17:17:15  Parsing macros/utils/array_concat.sql
2022-12-25 17:17:15.934529 (Thread-12): 17:17:15  Parsing macros/utils/right.sql
2022-12-25 17:17:15.936029 (Thread-12): 17:17:15  Parsing macros/utils/array_append.sql
2022-12-25 17:17:15.937698 (Thread-12): 17:17:15  Parsing macros/utils/last_day.sql
2022-12-25 17:17:15.939788 (Thread-12): 17:17:15  Parsing macros/utils/split_part.sql
2022-12-25 17:17:15.942394 (Thread-12): 17:17:15  Parsing macros/utils/date_trunc.sql
2022-12-25 17:17:15.943479 (Thread-12): 17:17:15  Parsing macros/utils/literal.sql
2022-12-25 17:17:15.944396 (Thread-12): 17:17:15  Parsing macros/utils/hash.sql
2022-12-25 17:17:15.945890 (Thread-12): 17:17:15  Parsing macros/utils/except.sql
2022-12-25 17:17:15.946737 (Thread-12): 17:17:15  Parsing macros/utils/bool_or.sql
2022-12-25 17:17:15.947641 (Thread-12): 17:17:15  Parsing macros/utils/replace.sql
2022-12-25 17:17:15.948834 (Thread-12): 17:17:15  Parsing macros/utils/dateadd.sql
2022-12-25 17:17:15.950050 (Thread-12): 17:17:15  Parsing macros/utils/listagg.sql
2022-12-25 17:17:15.952192 (Thread-12): 17:17:15  Parsing tests/generic/builtin.sql
2022-12-25 17:17:16.160036 (Thread-13): handling status request
2022-12-25 17:17:16.171309 (Thread-14): handling ps request
2022-12-25 17:17:16.188310 (Thread-13): 17:17:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf943e7490>]}
2022-12-25 17:17:16.203669 (Thread-14): 17:17:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf943f6310>]}
2022-12-25 17:17:16.209414 (Thread-13): sending response (<Response 180 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:17:16.221374 (Thread-12): 17:17:16  1699: static parser successfully parsed mart/fct_top_tracks.sql
2022-12-25 17:17:16.221945 (Thread-14): sending response (<Response 100 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:17:16.235973 (Thread-12): 17:17:16  1699: static parser successfully parsed mart/fct_songplays.sql
2022-12-25 17:17:16.239136 (Thread-12): 17:17:16  1699: static parser successfully parsed mart/fct_top_artists.sql
2022-12-25 17:17:16.241798 (Thread-12): 17:17:16  1603: static parser failed on mart/dim_artists.sql
2022-12-25 17:17:16.246832 (Thread-12): 17:17:16  1602: parser fallback to jinja rendering on mart/dim_artists.sql
2022-12-25 17:17:16.248125 (Thread-12): 17:17:16  1603: static parser failed on mart/dim_albums.sql
2022-12-25 17:17:16.252878 (Thread-12): 17:17:16  1602: parser fallback to jinja rendering on mart/dim_albums.sql
2022-12-25 17:17:16.254173 (Thread-12): 17:17:16  1603: static parser failed on mart/dim_tracks.sql
2022-12-25 17:17:16.258768 (Thread-12): 17:17:16  1602: parser fallback to jinja rendering on mart/dim_tracks.sql
2022-12-25 17:17:16.260068 (Thread-12): 17:17:16  1699: static parser successfully parsed staging/stg_top_tracks.sql
2022-12-25 17:17:16.262737 (Thread-12): 17:17:16  1699: static parser successfully parsed staging/stg_songplays.sql
2022-12-25 17:17:16.265633 (Thread-12): 17:17:16  1699: static parser successfully parsed staging/stg_top_artists.sql
2022-12-25 17:17:16.268503 (Thread-12): 17:17:16  1699: static parser successfully parsed view/vw_top_track_genres.sql
2022-12-25 17:17:16.272288 (Thread-12): 17:17:16  1699: static parser successfully parsed view/vw_top_artist_genres.sql
2022-12-25 17:17:16.276201 (Thread-12): 17:17:16  1699: static parser successfully parsed view/vw_songplays_genres.sql
2022-12-25 17:17:16.280276 (Thread-12): 17:17:16  1699: static parser successfully parsed view/vw_songplays_albums.sql
2022-12-25 17:17:16.463179 (Thread-15): handling status request
2022-12-25 17:17:16.483907 (Thread-15): 17:17:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf9437abe0>]}
2022-12-25 17:17:16.489484 (Thread-15): sending response (<Response 180 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:17:16.579613 (Thread-12): 17:17:16  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf941148b0>]}
2022-12-25 17:17:17.253471 (Thread-16): handling status request
2022-12-25 17:17:17.253886 (Thread-16): 17:17:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf941287f0>]}
2022-12-25 17:17:17.255162 (Thread-16): sending response (<Response 33738 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:17:22.658329 (Thread-17): handling status request
2022-12-25 17:17:22.659478 (Thread-17): 17:17:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf94067340>]}
2022-12-25 17:17:22.660774 (Thread-17): sending response (<Response 33738 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:17:22.710348 (Thread-18): handling cli_args request
2022-12-25 17:17:22.713716 (Thread-18): 17:17:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf944487c0>]}
2022-12-25 17:17:25.297909 (Thread-18): sending response (<Response 133 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:17:25.361974 (MainThread): 17:17:25  Unable to do partial parsing because config vars, config profile, or config target have changed
2022-12-25 17:17:25.362361 (MainThread): 17:17:25  Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8563a157-64a0-4722-b697-00eb2b58d4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02597c1ca0>]}
2022-12-25 17:17:25.431574 (MainThread): 17:17:25  Parsing macros/etc.sql
2022-12-25 17:17:25.435265 (MainThread): 17:17:25  Parsing macros/catalog.sql
2022-12-25 17:17:25.443071 (MainThread): 17:17:25  Parsing macros/adapters.sql
2022-12-25 17:17:25.471239 (MainThread): 17:17:25  Parsing macros/adapters/apply_grants.sql
2022-12-25 17:17:25.474805 (MainThread): 17:17:25  Parsing macros/materializations/seed.sql
2022-12-25 17:17:25.478068 (MainThread): 17:17:25  Parsing macros/materializations/incremental.sql
2022-12-25 17:17:25.499632 (MainThread): 17:17:25  Parsing macros/materializations/snapshot.sql
2022-12-25 17:17:25.501256 (MainThread): 17:17:25  Parsing macros/materializations/table.sql
2022-12-25 17:17:25.508012 (MainThread): 17:17:25  Parsing macros/materializations/copy.sql
2022-12-25 17:17:25.510681 (MainThread): 17:17:25  Parsing macros/materializations/view.sql
2022-12-25 17:17:25.513291 (MainThread): 17:17:25  Parsing macros/utils/intersect.sql
2022-12-25 17:17:25.513666 (MainThread): 17:17:25  Parsing macros/utils/position.sql
2022-12-25 17:17:25.514183 (MainThread): 17:17:25  Parsing macros/utils/escape_single_quotes.sql
2022-12-25 17:17:25.514721 (MainThread): 17:17:25  Parsing macros/utils/safe_cast.sql
2022-12-25 17:17:25.515294 (MainThread): 17:17:25  Parsing macros/utils/array_construct.sql
2022-12-25 17:17:25.516087 (MainThread): 17:17:25  Parsing macros/utils/datediff.sql
2022-12-25 17:17:25.517258 (MainThread): 17:17:25  Parsing macros/utils/timestamps.sql
2022-12-25 17:17:25.518327 (MainThread): 17:17:25  Parsing macros/utils/array_concat.sql
2022-12-25 17:17:25.518844 (MainThread): 17:17:25  Parsing macros/utils/right.sql
2022-12-25 17:17:25.519456 (MainThread): 17:17:25  Parsing macros/utils/array_append.sql
2022-12-25 17:17:25.520144 (MainThread): 17:17:25  Parsing macros/utils/split_part.sql
2022-12-25 17:17:25.582856 (Thread-19): handling poll request
2022-12-25 17:17:25.521477 (MainThread): 17:17:25  Parsing macros/utils/date_trunc.sql
2022-12-25 17:17:25.583489 (Thread-19): 17:17:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf700f4700>]}
2022-12-25 17:17:25.584514 (Thread-19): sending response (<Response 7449 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:17:25.522033 (MainThread): 17:17:25  Parsing macros/utils/hash.sql
2022-12-25 17:17:25.522521 (MainThread): 17:17:25  Parsing macros/utils/except.sql
2022-12-25 17:17:25.593870 (Thread-20): handling ps request
2022-12-25 17:17:25.594139 (Thread-20): 17:17:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf700f4e20>]}
2022-12-25 17:17:25.594652 (Thread-20): sending response (<Response 493 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:17:25.522898 (MainThread): 17:17:25  Parsing macros/utils/bool_or.sql
2022-12-25 17:17:25.523311 (MainThread): 17:17:25  Parsing macros/utils/dateadd.sql
2022-12-25 17:17:25.523898 (MainThread): 17:17:25  Parsing macros/utils/listagg.sql
2022-12-25 17:17:25.524898 (MainThread): 17:17:25  Parsing macros/etc/statement.sql
2022-12-25 17:17:25.529841 (MainThread): 17:17:25  Parsing macros/etc/datetime.sql
2022-12-25 17:17:25.538048 (MainThread): 17:17:25  Parsing macros/adapters/apply_grants.sql
2022-12-25 17:17:25.551195 (MainThread): 17:17:25  Parsing macros/adapters/freshness.sql
2022-12-25 17:17:25.553068 (MainThread): 17:17:25  Parsing macros/adapters/columns.sql
2022-12-25 17:17:25.562196 (MainThread): 17:17:25  Parsing macros/adapters/timestamps.sql
2022-12-25 17:17:25.565451 (MainThread): 17:17:25  Parsing macros/adapters/relation.sql
2022-12-25 17:17:25.579446 (MainThread): 17:17:25  Parsing macros/adapters/schema.sql
2022-12-25 17:17:25.581503 (MainThread): 17:17:25  Parsing macros/adapters/persist_docs.sql
2022-12-25 17:17:25.585902 (MainThread): 17:17:25  Parsing macros/adapters/metadata.sql
2022-12-25 17:17:25.592685 (MainThread): 17:17:25  Parsing macros/adapters/indexes.sql
2022-12-25 17:17:25.595235 (MainThread): 17:17:25  Parsing macros/get_custom_name/get_custom_database.sql
2022-12-25 17:17:25.596733 (MainThread): 17:17:25  Parsing macros/get_custom_name/get_custom_schema.sql
2022-12-25 17:17:25.599237 (MainThread): 17:17:25  Parsing macros/get_custom_name/get_custom_alias.sql
2022-12-25 17:17:25.600768 (MainThread): 17:17:25  Parsing macros/python_model/python.sql
2022-12-25 17:17:25.606499 (MainThread): 17:17:25  Parsing macros/materializations/hooks.sql
2022-12-25 17:17:25.610209 (MainThread): 17:17:25  Parsing macros/materializations/configs.sql
2022-12-25 17:17:25.612352 (MainThread): 17:17:25  Parsing macros/materializations/seeds/seed.sql
2022-12-25 17:17:25.618942 (MainThread): 17:17:25  Parsing macros/materializations/seeds/helpers.sql
2022-12-25 17:17:25.635862 (MainThread): 17:17:25  Parsing macros/materializations/tests/test.sql
2022-12-25 17:17:25.640170 (MainThread): 17:17:25  Parsing macros/materializations/tests/helpers.sql
2022-12-25 17:17:25.641832 (MainThread): 17:17:25  Parsing macros/materializations/tests/where_subquery.sql
2022-12-25 17:17:25.643602 (MainThread): 17:17:25  Parsing macros/materializations/models/view/helpers.sql
2022-12-25 17:17:25.644827 (MainThread): 17:17:25  Parsing macros/materializations/models/view/create_or_replace_view.sql
2022-12-25 17:17:25.647884 (MainThread): 17:17:25  Parsing macros/materializations/models/view/create_view_as.sql
2022-12-25 17:17:25.650172 (MainThread): 17:17:25  Parsing macros/materializations/models/view/view.sql
2022-12-25 17:17:25.655354 (MainThread): 17:17:25  Parsing macros/materializations/models/incremental/strategies.sql
2022-12-25 17:17:25.661912 (MainThread): 17:17:25  Parsing macros/materializations/models/incremental/column_helpers.sql
2022-12-25 17:17:25.669542 (MainThread): 17:17:25  Parsing macros/materializations/models/incremental/incremental.sql
2022-12-25 17:17:25.679193 (MainThread): 17:17:25  Parsing macros/materializations/models/incremental/on_schema_change.sql
2022-12-25 17:17:25.694343 (MainThread): 17:17:25  Parsing macros/materializations/models/incremental/is_incremental.sql
2022-12-25 17:17:25.695830 (MainThread): 17:17:25  Parsing macros/materializations/models/incremental/merge.sql
2022-12-25 17:17:25.709831 (MainThread): 17:17:25  Parsing macros/materializations/models/table/create_table_as.sql
2022-12-25 17:17:25.713191 (MainThread): 17:17:25  Parsing macros/materializations/models/table/table.sql
2022-12-25 17:17:25.718381 (MainThread): 17:17:25  Parsing macros/materializations/snapshots/strategies.sql
2022-12-25 17:17:25.793481 (Thread-21): handling status request
2022-12-25 17:17:25.733345 (MainThread): 17:17:25  Parsing macros/materializations/snapshots/snapshot_merge.sql
2022-12-25 17:17:25.794042 (Thread-21): 17:17:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf94114460>]}
2022-12-25 17:17:25.795554 (Thread-21): sending response (<Response 33738 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:17:25.734893 (MainThread): 17:17:25  Parsing macros/materializations/snapshots/snapshot.sql
2022-12-25 17:17:25.745596 (MainThread): 17:17:25  Parsing macros/materializations/snapshots/helpers.sql
2022-12-25 17:17:25.757620 (MainThread): 17:17:25  Parsing macros/generic_test_sql/not_null.sql
2022-12-25 17:17:25.758396 (MainThread): 17:17:25  Parsing macros/generic_test_sql/relationships.sql
2022-12-25 17:17:25.759222 (MainThread): 17:17:25  Parsing macros/generic_test_sql/unique.sql
2022-12-25 17:17:25.759846 (MainThread): 17:17:25  Parsing macros/generic_test_sql/accepted_values.sql
2022-12-25 17:17:25.761114 (MainThread): 17:17:25  Parsing macros/utils/intersect.sql
2022-12-25 17:17:25.762035 (MainThread): 17:17:25  Parsing macros/utils/position.sql
2022-12-25 17:17:25.763089 (MainThread): 17:17:25  Parsing macros/utils/escape_single_quotes.sql
2022-12-25 17:17:25.764408 (MainThread): 17:17:25  Parsing macros/utils/safe_cast.sql
2022-12-25 17:17:25.765489 (MainThread): 17:17:25  Parsing macros/utils/array_construct.sql
2022-12-25 17:17:25.767014 (MainThread): 17:17:25  Parsing macros/utils/cast_bool_to_text.sql
2022-12-25 17:17:25.768012 (MainThread): 17:17:25  Parsing macros/utils/datediff.sql
2022-12-25 17:17:25.769202 (MainThread): 17:17:25  Parsing macros/utils/concat.sql
2022-12-25 17:17:25.770142 (MainThread): 17:17:25  Parsing macros/utils/length.sql
2022-12-25 17:17:25.771070 (MainThread): 17:17:25  Parsing macros/utils/any_value.sql
2022-12-25 17:17:25.772027 (MainThread): 17:17:25  Parsing macros/utils/data_types.sql
2022-12-25 17:17:25.778701 (MainThread): 17:17:25  Parsing macros/utils/array_concat.sql
2022-12-25 17:17:25.779698 (MainThread): 17:17:25  Parsing macros/utils/right.sql
2022-12-25 17:17:25.780747 (MainThread): 17:17:25  Parsing macros/utils/array_append.sql
2022-12-25 17:17:25.781769 (MainThread): 17:17:25  Parsing macros/utils/last_day.sql
2022-12-25 17:17:25.783590 (MainThread): 17:17:25  Parsing macros/utils/split_part.sql
2022-12-25 17:17:25.785513 (MainThread): 17:17:25  Parsing macros/utils/date_trunc.sql
2022-12-25 17:17:25.786510 (MainThread): 17:17:25  Parsing macros/utils/literal.sql
2022-12-25 17:17:25.787645 (MainThread): 17:17:25  Parsing macros/utils/hash.sql
2022-12-25 17:17:25.788656 (MainThread): 17:17:25  Parsing macros/utils/except.sql
2022-12-25 17:17:25.789470 (MainThread): 17:17:25  Parsing macros/utils/bool_or.sql
2022-12-25 17:17:25.790362 (MainThread): 17:17:25  Parsing macros/utils/replace.sql
2022-12-25 17:17:25.791537 (MainThread): 17:17:25  Parsing macros/utils/dateadd.sql
2022-12-25 17:17:25.792803 (MainThread): 17:17:25  Parsing macros/utils/listagg.sql
2022-12-25 17:17:25.794969 (MainThread): 17:17:25  Parsing tests/generic/builtin.sql
2022-12-25 17:17:26.058472 (MainThread): 17:17:26  1699: static parser successfully parsed mart/fct_top_tracks.sql
2022-12-25 17:17:26.070171 (MainThread): 17:17:26  1699: static parser successfully parsed mart/fct_songplays.sql
2022-12-25 17:17:26.072914 (MainThread): 17:17:26  1699: static parser successfully parsed mart/fct_top_artists.sql
2022-12-25 17:17:26.075504 (MainThread): 17:17:26  1603: static parser failed on mart/dim_artists.sql
2022-12-25 17:17:26.079827 (MainThread): 17:17:26  1602: parser fallback to jinja rendering on mart/dim_artists.sql
2022-12-25 17:17:26.081185 (MainThread): 17:17:26  1603: static parser failed on mart/dim_albums.sql
2022-12-25 17:17:26.085431 (MainThread): 17:17:26  1602: parser fallback to jinja rendering on mart/dim_albums.sql
2022-12-25 17:17:26.086933 (MainThread): 17:17:26  1603: static parser failed on mart/dim_tracks.sql
2022-12-25 17:17:26.091210 (MainThread): 17:17:26  1602: parser fallback to jinja rendering on mart/dim_tracks.sql
2022-12-25 17:17:26.092469 (MainThread): 17:17:26  1699: static parser successfully parsed staging/stg_top_tracks.sql
2022-12-25 17:17:26.095140 (MainThread): 17:17:26  1699: static parser successfully parsed staging/stg_songplays.sql
2022-12-25 17:17:26.097840 (MainThread): 17:17:26  1699: static parser successfully parsed staging/stg_top_artists.sql
2022-12-25 17:17:26.100922 (MainThread): 17:17:26  1699: static parser successfully parsed view/vw_top_track_genres.sql
2022-12-25 17:17:26.103910 (MainThread): 17:17:26  1699: static parser successfully parsed view/vw_top_artist_genres.sql
2022-12-25 17:17:26.106926 (MainThread): 17:17:26  1699: static parser successfully parsed view/vw_songplays_genres.sql
2022-12-25 17:17:26.109891 (MainThread): 17:17:26  1699: static parser successfully parsed view/vw_songplays_albums.sql
2022-12-25 17:17:26.427659 (MainThread): 17:17:26  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8563a157-64a0-4722-b697-00eb2b58d4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0259690df0>]}
2022-12-25 17:17:26.456170 (MainThread): 17:17:26  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8563a157-64a0-4722-b697-00eb2b58d4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02595dd2b0>]}
2022-12-25 17:17:26.456430 (MainThread): 17:17:26  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 5 seed files, 5 sources, 0 exposures, 0 metrics
2022-12-25 17:17:26.456525 (MainThread): 17:17:26  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8563a157-64a0-4722-b697-00eb2b58d4c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f02598fd2e0>]}
2022-12-25 17:17:26.458475 (MainThread): 17:17:26  
2022-12-25 17:17:26.458881 (MainThread): 17:17:26  Acquiring new bigquery connection "master"
2022-12-25 17:17:26.459949 (ThreadPoolExecutor-0_0): 17:17:26  Acquiring new bigquery connection "list_dbt-demo-data"
2022-12-25 17:17:26.460091 (ThreadPoolExecutor-0_0): 17:17:26  Opening a new connection, currently in state init
2022-12-25 17:17:26.678896 (ThreadPoolExecutor-0_0): 17:17:26  Acquiring new bigquery connection "create_dbt-demo-data_dbt_jleder"
2022-12-25 17:17:26.679311 (ThreadPoolExecutor-0_0): 17:17:26  Acquiring new bigquery connection "create_dbt-demo-data_dbt_jleder"
2022-12-25 17:17:26.679471 (ThreadPoolExecutor-0_0): 17:17:26  Creating schema "_ReferenceKey(database='dbt-demo-data', schema='dbt_jleder', identifier=None)"
2022-12-25 17:17:26.689182 (ThreadPoolExecutor-0_0): 17:17:26  Opening a new connection, currently in state closed
2022-12-25 17:17:26.693370 (ThreadPoolExecutor-0_0): 17:17:26  On create_dbt-demo-data_dbt_jleder: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "user", "target_name": "default", "connection_name": "create_dbt-demo-data_dbt_jleder"} */
create schema if not exists `dbt-demo-data`.`dbt_jleder`
  
2022-12-25 17:17:26.742203 (ThreadPoolExecutor-0_0): 17:17:26  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('POST https://bigquery.googleapis.com/bigquery/v2/projects/dbt-demo-data/jobs?prettyPrint=false: Location dbt_spotify does not support this operation.')
2022-12-25 17:17:26.820838 (Thread-22): handling poll request
2022-12-25 17:17:26.821225 (Thread-22): 17:17:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf94128e20>]}
2022-12-25 17:17:26.822422 (Thread-22): sending response (<Response 31892 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:17:27.704715 (ThreadPoolExecutor-0_0): 17:17:27  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data&j=bq:dbt_spotify:1371a007-61fe-4c94-b6de-3e86a0d75865&page=queryresults
2022-12-25 17:17:27.704950 (ThreadPoolExecutor-0_0): 17:17:27  BigQuery adapter: Unhandled error while running:
macro create_schema
2022-12-25 17:17:27.705041 (ThreadPoolExecutor-0_0): 17:17:27  BigQuery adapter: Database Error
  Location dbt_spotify does not support this operation.
2022-12-25 17:17:27.706425 (MainThread): 17:17:27  Connection 'master' was properly closed.
2022-12-25 17:17:27.706531 (MainThread): 17:17:27  Connection 'create_dbt-demo-data_dbt_jleder' was properly closed.
2022-12-25 17:17:27.706609 (MainThread): dbt runtime exception
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 207, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 646, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 429, in fn
    return self._query_and_results(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 630, in _query_and_results
    query_job = client.query(query=sql, job_config=job_config, timeout=job_creation_timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/client.py", line 3242, in query
    query_job._begin(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1175, in _begin
    super(QueryJob, self)._begin(client=client, retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 461, in _begin
    api_response = client._call_api(
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/client.py", line 747, in _call_api
    return call()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 349, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/_http/__init__.py", line 494, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/bigquery/v2/projects/dbt-demo-data/jobs?prettyPrint=false: Location dbt_spotify does not support this operation.

(job ID: 1371a007-61fe-4c94-b6de-3e86a0d75865)

                                                             -----Query Job SQL Follows-----                                                             

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "user", "target_name": "default", "connection_name": "create_dbt-demo-data_dbt_jleder"} */
   2:create schema if not exists `dbt-demo-data`.`dbt_jleder`
   3:  
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/task_handler.py", line 102, in task_exec
    result = self.task.handle_request()
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/cli.py", line 114, in handle_request
    return self.real_task.handle_request()
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/project_commands.py", line 64, in handle_request
    return self.run()
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/runnable.py", line 472, in run
    result = self.execute_with_hooks(selected_uids)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/runnable.py", line 434, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/run.py", line 425, in before_run
    self.create_schemas(adapter, required_schemas)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/runnable.py", line 578, in create_schemas
    create_future.result()
  File "/usr/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/utils.py", line 480, in connected
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/runnable.py", line 542, in create_schema
    adapter.create_schema(relation)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/impl.py", line 308, in create_schema
    self.execute_macro(CREATE_SCHEMA_MACRO_NAME, kwargs=kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 1026, in execute_macro
    result = macro_function(**kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 326, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 253, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 19, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 326, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 253, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 28, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 326, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 253, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 278, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 446, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 437, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 646, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 211, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 199, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  Location dbt_spotify does not support this operation.
2022-12-25 17:17:27.811121 (Thread-23): handling ps request
2022-12-25 17:17:27.811522 (Thread-23): 17:17:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf700d9be0>]}
2022-12-25 17:17:27.812006 (Thread-23): sending response (<Response 493 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:17:28.026318 (Thread-24): handling status request
2022-12-25 17:17:28.026770 (Thread-24): 17:17:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf94128520>]}
2022-12-25 17:17:28.028174 (Thread-24): sending response (<Response 33738 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:17:28.038632 (Thread-25): handling poll request
2022-12-25 17:17:28.038883 (Thread-25): 17:17:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf700d9b80>]}
2022-12-25 17:17:28.039679 (Thread-25): sending response (<Response 47269 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:17:30.046687 (Thread-26): handling ps request
2022-12-25 17:17:30.047081 (Thread-26): 17:17:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf700d9fa0>]}
2022-12-25 17:17:30.047568 (Thread-26): sending response (<Response 513 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:17:30.247849 (Thread-27): handling status request
2022-12-25 17:17:30.248248 (Thread-27): 17:17:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf7008b100>]}
2022-12-25 17:17:30.249500 (Thread-27): sending response (<Response 33738 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:17:35.044868 (Thread-28): handling status request
2022-12-25 17:17:35.046017 (Thread-28): 17:17:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf700f4e80>]}
2022-12-25 17:17:35.047285 (Thread-28): sending response (<Response 33738 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:17:35.095457 (Thread-29): handling cli_args request
2022-12-25 17:17:35.096934 (Thread-29): 17:17:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf7008b3d0>]}
2022-12-25 17:17:37.664496 (Thread-29): sending response (<Response 133 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:17:37.786852 (MainThread): 17:17:37  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-12-25 17:17:37.787240 (MainThread): 17:17:37  Partial parsing enabled, no changes found, skipping parsing
2022-12-25 17:17:37.794833 (MainThread): 17:17:37  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23948a55-3e7b-4892-8c56-c741cc776592', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba40f7d910>]}
2022-12-25 17:17:37.829725 (MainThread): 17:17:37  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23948a55-3e7b-4892-8c56-c741cc776592', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba41053160>]}
2022-12-25 17:17:37.830009 (MainThread): 17:17:37  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 5 seed files, 5 sources, 0 exposures, 0 metrics
2022-12-25 17:17:37.830109 (MainThread): 17:17:37  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23948a55-3e7b-4892-8c56-c741cc776592', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba41140b50>]}
2022-12-25 17:17:37.832114 (MainThread): 17:17:37  
2022-12-25 17:17:37.832539 (MainThread): 17:17:37  Acquiring new bigquery connection "master"
2022-12-25 17:17:37.834035 (ThreadPoolExecutor-0_0): 17:17:37  Acquiring new bigquery connection "list_dbt-demo-data"
2022-12-25 17:17:37.834182 (ThreadPoolExecutor-0_0): 17:17:37  Opening a new connection, currently in state init
2022-12-25 17:17:37.924201 (Thread-30): handling ps request
2022-12-25 17:17:37.924609 (Thread-30): 17:17:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf70091130>]}
2022-12-25 17:17:37.925422 (Thread-30): sending response (<Response 906 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:17:37.930958 (Thread-31): handling poll request
2022-12-25 17:17:37.931204 (Thread-31): 17:17:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf70091ac0>]}
2022-12-25 17:17:37.931665 (Thread-31): sending response (<Response 3902 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:17:38.047074 (ThreadPoolExecutor-0_0): 17:17:38  Acquiring new bigquery connection "create_dbt-demo-data_dbt_jleder"
2022-12-25 17:17:38.047504 (ThreadPoolExecutor-0_0): 17:17:38  Acquiring new bigquery connection "create_dbt-demo-data_dbt_jleder"
2022-12-25 17:17:38.047681 (ThreadPoolExecutor-0_0): 17:17:38  Creating schema "_ReferenceKey(database='dbt-demo-data', schema='dbt_jleder', identifier=None)"
2022-12-25 17:17:38.057521 (ThreadPoolExecutor-0_0): 17:17:38  Opening a new connection, currently in state closed
2022-12-25 17:17:38.061748 (ThreadPoolExecutor-0_0): 17:17:38  On create_dbt-demo-data_dbt_jleder: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "user", "target_name": "default", "connection_name": "create_dbt-demo-data_dbt_jleder"} */
create schema if not exists `dbt-demo-data`.`dbt_jleder`
  
2022-12-25 17:17:38.112702 (ThreadPoolExecutor-0_0): 17:17:38  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('POST https://bigquery.googleapis.com/bigquery/v2/projects/dbt-demo-data/jobs?prettyPrint=false: Location dbt_spotify does not support this operation.')
2022-12-25 17:17:38.120270 (Thread-32): handling status request
2022-12-25 17:17:38.120599 (Thread-32): 17:17:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf7003d8b0>]}
2022-12-25 17:17:38.122178 (Thread-32): sending response (<Response 33738 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:17:39.058669 (ThreadPoolExecutor-0_0): 17:17:39  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data&j=bq:dbt_spotify:5a9edbaf-353f-44e4-9839-2d350db03ead&page=queryresults
2022-12-25 17:17:39.058886 (ThreadPoolExecutor-0_0): 17:17:39  BigQuery adapter: Unhandled error while running:
macro create_schema
2022-12-25 17:17:39.058974 (ThreadPoolExecutor-0_0): 17:17:39  BigQuery adapter: Database Error
  Location dbt_spotify does not support this operation.
2022-12-25 17:17:39.060379 (MainThread): 17:17:39  Connection 'master' was properly closed.
2022-12-25 17:17:39.060497 (MainThread): 17:17:39  Connection 'create_dbt-demo-data_dbt_jleder' was properly closed.
2022-12-25 17:17:39.060552 (MainThread): dbt runtime exception
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 207, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 646, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 429, in fn
    return self._query_and_results(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 630, in _query_and_results
    query_job = client.query(query=sql, job_config=job_config, timeout=job_creation_timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/client.py", line 3242, in query
    query_job._begin(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1175, in _begin
    super(QueryJob, self)._begin(client=client, retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 461, in _begin
    api_response = client._call_api(
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/client.py", line 747, in _call_api
    return call()
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 349, in retry_wrapped_func
    return retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/_http/__init__.py", line 494, in api_request
    raise exceptions.from_http_response(response)
google.api_core.exceptions.BadRequest: 400 POST https://bigquery.googleapis.com/bigquery/v2/projects/dbt-demo-data/jobs?prettyPrint=false: Location dbt_spotify does not support this operation.

(job ID: 5a9edbaf-353f-44e4-9839-2d350db03ead)

                                                             -----Query Job SQL Follows-----                                                             

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "user", "target_name": "default", "connection_name": "create_dbt-demo-data_dbt_jleder"} */
   2:create schema if not exists `dbt-demo-data`.`dbt_jleder`
   3:  
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/task_handler.py", line 102, in task_exec
    result = self.task.handle_request()
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/cli.py", line 114, in handle_request
    return self.real_task.handle_request()
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/project_commands.py", line 64, in handle_request
    return self.run()
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/runnable.py", line 472, in run
    result = self.execute_with_hooks(selected_uids)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/runnable.py", line 434, in execute_with_hooks
    self.before_run(adapter, selected_uids)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/run.py", line 425, in before_run
    self.create_schemas(adapter, required_schemas)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/runnable.py", line 578, in create_schemas
    create_future.result()
  File "/usr/lib/python3.8/concurrent/futures/_base.py", line 437, in result
    return self.__get_result()
  File "/usr/lib/python3.8/concurrent/futures/_base.py", line 389, in __get_result
    raise self._exception
  File "/usr/lib/python3.8/concurrent/futures/thread.py", line 57, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/utils.py", line 480, in connected
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/runnable.py", line 542, in create_schema
    adapter.create_schema(relation)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/impl.py", line 308, in create_schema
    self.execute_macro(CREATE_SCHEMA_MACRO_NAME, kwargs=kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 1026, in execute_macro
    result = macro_function(**kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 326, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 253, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 19, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 326, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 253, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 28, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 326, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 253, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 763, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 777, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 52, in macro
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 393, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/runtime.py", line 298, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 278, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 446, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 437, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 646, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 211, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 199, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  Location dbt_spotify does not support this operation.
2022-12-25 17:17:39.164023 (Thread-33): handling poll request
2022-12-25 17:17:39.164417 (Thread-33): 17:17:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf7003d3a0>]}
2022-12-25 17:17:39.165059 (Thread-33): sending response (<Response 13173 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:17:40.147286 (Thread-34): handling ps request
2022-12-25 17:17:40.147750 (Thread-34): 17:17:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf70091040>]}
2022-12-25 17:17:40.148291 (Thread-34): sending response (<Response 929 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:17:40.368957 (Thread-35): handling status request
2022-12-25 17:17:40.369345 (Thread-35): 17:17:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf7003d0d0>]}
2022-12-25 17:17:40.370922 (Thread-35): sending response (<Response 33738 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:17:40.392896 (Thread-36): handling poll request
2022-12-25 17:17:40.393198 (Thread-36): 17:17:40  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf70080280>]}
2022-12-25 17:17:40.393733 (Thread-36): sending response (<Response 16470 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:17:59.149023 (Thread-37): handling status request
2022-12-25 17:17:59.150163 (Thread-37): 17:17:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf70080c10>]}
2022-12-25 17:17:59.151490 (Thread-37): sending response (<Response 33738 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:18:07.756490 (Thread-38): handling status request
2022-12-25 17:18:07.756940 (Thread-38): 17:18:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf70080fd0>]}
2022-12-25 17:18:07.758261 (Thread-38): sending response (<Response 33738 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:18:15.496752 (Thread-39): handling ps request
2022-12-25 17:18:15.497346 (Thread-39): 17:18:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf70045220>]}
2022-12-25 17:18:15.497960 (Thread-40): handling status request
2022-12-25 17:18:15.500653 (Thread-40): 17:18:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf7003d0a0>]}
2022-12-25 17:18:15.505219 (Thread-41): handling status request
2022-12-25 17:18:15.505506 (Thread-41): 17:18:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf70058d60>]}
2022-12-25 17:18:15.513551 (Thread-42): handling ps request
2022-12-25 17:18:15.514078 (Thread-42): 17:18:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf70063460>]}
2022-12-25 17:18:15.519500 (Thread-39): sending response (<Response 929 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:18:15.520702 (Thread-40): sending response (<Response 33721 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:18:15.521470 (Thread-42): sending response (<Response 929 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:18:15.522531 (Thread-41): sending response (<Response 33738 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:18:15.530992 (Thread-43): handling list request
2022-12-25 17:18:15.531266 (Thread-43): 17:18:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf7003d760>]}
2022-12-25 17:18:15.568715 (Thread-43): 17:18:15  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf70091070>]}
2022-12-25 17:18:15.569199 (Thread-43): 17:18:15  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 5 seed files, 5 sources, 0 exposures, 0 metrics
2022-12-25 17:18:15.569498 (Thread-43): 17:18:15  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfcd3ec730>]}
2022-12-25 17:18:15.576877 (Thread-43): sending response (<Response 34519 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:18:21.770362 (Thread-44): handling status request
2022-12-25 17:18:21.770778 (Thread-44): 17:18:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf7003dc40>]}
2022-12-25 17:18:21.772128 (Thread-44): sending response (<Response 33721 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:18:21.776812 (Thread-45): handling list request
2022-12-25 17:18:21.777079 (Thread-45): 17:18:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf700583d0>]}
2022-12-25 17:18:21.810403 (Thread-45): 17:18:21  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf70063520>]}
2022-12-25 17:18:21.810854 (Thread-45): 17:18:21  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 5 seed files, 5 sources, 0 exposures, 0 metrics
2022-12-25 17:18:21.811174 (Thread-45): 17:18:21  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf700916d0>]}
2022-12-25 17:18:21.819079 (Thread-45): sending response (<Response 25722 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:18:58.997375 (Thread-46): handling status request
2022-12-25 17:18:58.999234 (Thread-46): 17:18:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf70063b80>]}
2022-12-25 17:18:59.000526 (Thread-46): sending response (<Response 33738 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:19:14.750281 (Thread-47): handling ps request
2022-12-25 17:19:14.750730 (Thread-47): 17:19:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf70063f70>]}
2022-12-25 17:19:14.751320 (Thread-47): sending response (<Response 1515 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:19:14.774783 (Thread-48): handling status request
2022-12-25 17:19:14.775156 (Thread-48): 17:19:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf70068970>]}
2022-12-25 17:19:14.776406 (Thread-48): sending response (<Response 33745 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:19:14.807954 (Thread-49): handling status request
2022-12-25 17:19:14.808329 (Thread-49): 17:19:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf700680d0>]}
2022-12-25 17:19:14.809590 (Thread-49): sending response (<Response 33745 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:19:14.937124 (Thread-50): handling status request
2022-12-25 17:19:14.937541 (Thread-50): 17:19:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf70068c10>]}
2022-12-25 17:19:14.938772 (Thread-50): sending response (<Response 33745 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:19:15.830472 (Thread-51): handling status request
2022-12-25 17:19:15.830907 (Thread-51): 17:19:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf70068ac0>]}
2022-12-25 17:19:15.832090 (Thread-51): sending response (<Response 33745 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:19:21.750333 (Thread-52): handling status request
2022-12-25 17:19:21.750769 (Thread-52): 17:19:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf70068f10>]}
2022-12-25 17:19:21.751957 (Thread-52): sending response (<Response 33721 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:19:21.757623 (Thread-53): handling list request
2022-12-25 17:19:21.757908 (Thread-53): 17:19:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf70068580>]}
2022-12-25 17:19:21.791367 (Thread-53): 17:19:21  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf70091f40>]}
2022-12-25 17:19:21.791791 (Thread-53): 17:19:21  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 5 seed files, 5 sources, 0 exposures, 0 metrics
2022-12-25 17:19:21.792055 (Thread-53): 17:19:21  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf70091b50>]}
2022-12-25 17:19:21.797569 (Thread-53): sending response (<Response 25722 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:19:35.723679 (Thread-54): handling status request
2022-12-25 17:19:35.724077 (Thread-54): 17:19:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf70090dc0>]}
2022-12-25 17:19:35.725419 (Thread-54): sending response (<Response 33721 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:19:35.730154 (Thread-55): handling list request
2022-12-25 17:19:35.730435 (Thread-55): 17:19:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf700909d0>]}
2022-12-25 17:19:35.761965 (Thread-55): 17:19:35  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf70080a00>]}
2022-12-25 17:19:35.762439 (Thread-55): 17:19:35  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 5 seed files, 5 sources, 0 exposures, 0 metrics
2022-12-25 17:19:35.762727 (Thread-55): 17:19:35  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf70080460>]}
2022-12-25 17:19:35.767077 (Thread-55): sending response (<Response 15262 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:19:43.078112 (Thread-56): handling status request
2022-12-25 17:19:43.078505 (Thread-56): 17:19:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf7008be80>]}
2022-12-25 17:19:43.079797 (Thread-56): sending response (<Response 33721 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:19:43.084590 (Thread-57): handling list request
2022-12-25 17:19:43.084893 (Thread-57): 17:19:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf70080c40>]}
2022-12-25 17:19:43.117083 (Thread-57): 17:19:43  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf7003da30>]}
2022-12-25 17:19:43.117546 (Thread-57): 17:19:43  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 5 seed files, 5 sources, 0 exposures, 0 metrics
2022-12-25 17:19:43.117810 (Thread-57): 17:19:43  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf700801f0>]}
2022-12-25 17:19:43.123375 (Thread-57): sending response (<Response 25886 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:19:51.910162 (Thread-58): 17:19:51  Unable to do partial parsing because config vars, config profile, or config target have changed
2022-12-25 17:19:51.910513 (Thread-58): 17:19:51  Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf9412f1f0>]}
2022-12-25 17:19:51.973540 (Thread-58): 17:19:51  Parsing macros/etc.sql
2022-12-25 17:19:51.975627 (Thread-58): 17:19:51  Parsing macros/catalog.sql
2022-12-25 17:19:51.981071 (Thread-58): 17:19:51  Parsing macros/adapters.sql
2022-12-25 17:19:52.000598 (Thread-58): 17:19:52  Parsing macros/adapters/apply_grants.sql
2022-12-25 17:19:52.003084 (Thread-58): 17:19:52  Parsing macros/materializations/seed.sql
2022-12-25 17:19:52.005551 (Thread-58): 17:19:52  Parsing macros/materializations/incremental.sql
2022-12-25 17:19:52.022382 (Thread-58): 17:19:52  Parsing macros/materializations/snapshot.sql
2022-12-25 17:19:52.023982 (Thread-58): 17:19:52  Parsing macros/materializations/table.sql
2022-12-25 17:19:52.030525 (Thread-58): 17:19:52  Parsing macros/materializations/copy.sql
2022-12-25 17:19:52.033068 (Thread-58): 17:19:52  Parsing macros/materializations/view.sql
2022-12-25 17:19:52.035720 (Thread-58): 17:19:52  Parsing macros/utils/intersect.sql
2022-12-25 17:19:52.036127 (Thread-58): 17:19:52  Parsing macros/utils/position.sql
2022-12-25 17:19:52.036685 (Thread-58): 17:19:52  Parsing macros/utils/escape_single_quotes.sql
2022-12-25 17:19:52.037281 (Thread-58): 17:19:52  Parsing macros/utils/safe_cast.sql
2022-12-25 17:19:52.037830 (Thread-58): 17:19:52  Parsing macros/utils/array_construct.sql
2022-12-25 17:19:52.038673 (Thread-58): 17:19:52  Parsing macros/utils/datediff.sql
2022-12-25 17:19:52.039825 (Thread-58): 17:19:52  Parsing macros/utils/timestamps.sql
2022-12-25 17:19:52.040929 (Thread-58): 17:19:52  Parsing macros/utils/array_concat.sql
2022-12-25 17:19:52.041475 (Thread-58): 17:19:52  Parsing macros/utils/right.sql
2022-12-25 17:19:52.042128 (Thread-58): 17:19:52  Parsing macros/utils/array_append.sql
2022-12-25 17:19:52.042763 (Thread-58): 17:19:52  Parsing macros/utils/split_part.sql
2022-12-25 17:19:52.044136 (Thread-58): 17:19:52  Parsing macros/utils/date_trunc.sql
2022-12-25 17:19:52.044717 (Thread-58): 17:19:52  Parsing macros/utils/hash.sql
2022-12-25 17:19:52.045255 (Thread-58): 17:19:52  Parsing macros/utils/except.sql
2022-12-25 17:19:52.045650 (Thread-58): 17:19:52  Parsing macros/utils/bool_or.sql
2022-12-25 17:19:52.046121 (Thread-58): 17:19:52  Parsing macros/utils/dateadd.sql
2022-12-25 17:19:52.046776 (Thread-58): 17:19:52  Parsing macros/utils/listagg.sql
2022-12-25 17:19:52.047742 (Thread-58): 17:19:52  Parsing macros/etc/statement.sql
2022-12-25 17:19:52.052537 (Thread-58): 17:19:52  Parsing macros/etc/datetime.sql
2022-12-25 17:19:52.060210 (Thread-58): 17:19:52  Parsing macros/adapters/apply_grants.sql
2022-12-25 17:19:52.072854 (Thread-58): 17:19:52  Parsing macros/adapters/freshness.sql
2022-12-25 17:19:52.074748 (Thread-58): 17:19:52  Parsing macros/adapters/columns.sql
2022-12-25 17:19:52.083534 (Thread-58): 17:19:52  Parsing macros/adapters/timestamps.sql
2022-12-25 17:19:52.086751 (Thread-58): 17:19:52  Parsing macros/adapters/relation.sql
2022-12-25 17:19:52.100144 (Thread-58): 17:19:52  Parsing macros/adapters/schema.sql
2022-12-25 17:19:52.102227 (Thread-58): 17:19:52  Parsing macros/adapters/persist_docs.sql
2022-12-25 17:19:52.106511 (Thread-58): 17:19:52  Parsing macros/adapters/metadata.sql
2022-12-25 17:19:52.113064 (Thread-58): 17:19:52  Parsing macros/adapters/indexes.sql
2022-12-25 17:19:52.115597 (Thread-58): 17:19:52  Parsing macros/get_custom_name/get_custom_database.sql
2022-12-25 17:19:52.117091 (Thread-58): 17:19:52  Parsing macros/get_custom_name/get_custom_schema.sql
2022-12-25 17:19:52.119420 (Thread-58): 17:19:52  Parsing macros/get_custom_name/get_custom_alias.sql
2022-12-25 17:19:52.120968 (Thread-58): 17:19:52  Parsing macros/python_model/python.sql
2022-12-25 17:19:52.126526 (Thread-58): 17:19:52  Parsing macros/materializations/hooks.sql
2022-12-25 17:19:52.130097 (Thread-58): 17:19:52  Parsing macros/materializations/configs.sql
2022-12-25 17:19:52.132241 (Thread-58): 17:19:52  Parsing macros/materializations/seeds/seed.sql
2022-12-25 17:19:52.138583 (Thread-58): 17:19:52  Parsing macros/materializations/seeds/helpers.sql
2022-12-25 17:19:52.155301 (Thread-58): 17:19:52  Parsing macros/materializations/tests/test.sql
2022-12-25 17:19:52.159323 (Thread-58): 17:19:52  Parsing macros/materializations/tests/helpers.sql
2022-12-25 17:19:52.160963 (Thread-58): 17:19:52  Parsing macros/materializations/tests/where_subquery.sql
2022-12-25 17:19:52.162668 (Thread-58): 17:19:52  Parsing macros/materializations/models/view/helpers.sql
2022-12-25 17:19:52.163884 (Thread-58): 17:19:52  Parsing macros/materializations/models/view/create_or_replace_view.sql
2022-12-25 17:19:52.167014 (Thread-58): 17:19:52  Parsing macros/materializations/models/view/create_view_as.sql
2022-12-25 17:19:52.169165 (Thread-58): 17:19:52  Parsing macros/materializations/models/view/view.sql
2022-12-25 17:19:52.174170 (Thread-58): 17:19:52  Parsing macros/materializations/models/incremental/strategies.sql
2022-12-25 17:19:52.186069 (Thread-58): 17:19:52  Parsing macros/materializations/models/incremental/column_helpers.sql
2022-12-25 17:19:52.193473 (Thread-58): 17:19:52  Parsing macros/materializations/models/incremental/incremental.sql
2022-12-25 17:19:52.203129 (Thread-58): 17:19:52  Parsing macros/materializations/models/incremental/on_schema_change.sql
2022-12-25 17:19:52.218029 (Thread-58): 17:19:52  Parsing macros/materializations/models/incremental/is_incremental.sql
2022-12-25 17:19:52.219437 (Thread-58): 17:19:52  Parsing macros/materializations/models/incremental/merge.sql
2022-12-25 17:19:52.233065 (Thread-58): 17:19:52  Parsing macros/materializations/models/table/create_table_as.sql
2022-12-25 17:19:52.236321 (Thread-58): 17:19:52  Parsing macros/materializations/models/table/table.sql
2022-12-25 17:19:52.241396 (Thread-58): 17:19:52  Parsing macros/materializations/snapshots/strategies.sql
2022-12-25 17:19:52.255836 (Thread-58): 17:19:52  Parsing macros/materializations/snapshots/snapshot_merge.sql
2022-12-25 17:19:52.257401 (Thread-58): 17:19:52  Parsing macros/materializations/snapshots/snapshot.sql
2022-12-25 17:19:52.267789 (Thread-58): 17:19:52  Parsing macros/materializations/snapshots/helpers.sql
2022-12-25 17:19:52.279375 (Thread-58): 17:19:52  Parsing macros/generic_test_sql/not_null.sql
2022-12-25 17:19:52.280166 (Thread-58): 17:19:52  Parsing macros/generic_test_sql/relationships.sql
2022-12-25 17:19:52.281072 (Thread-58): 17:19:52  Parsing macros/generic_test_sql/unique.sql
2022-12-25 17:19:52.281761 (Thread-58): 17:19:52  Parsing macros/generic_test_sql/accepted_values.sql
2022-12-25 17:19:52.283665 (Thread-58): 17:19:52  Parsing macros/utils/intersect.sql
2022-12-25 17:19:52.284842 (Thread-58): 17:19:52  Parsing macros/utils/position.sql
2022-12-25 17:19:52.286322 (Thread-58): 17:19:52  Parsing macros/utils/escape_single_quotes.sql
2022-12-25 17:19:52.287750 (Thread-58): 17:19:52  Parsing macros/utils/safe_cast.sql
2022-12-25 17:19:52.289482 (Thread-58): 17:19:52  Parsing macros/utils/array_construct.sql
2022-12-25 17:19:52.290951 (Thread-58): 17:19:52  Parsing macros/utils/cast_bool_to_text.sql
2022-12-25 17:19:52.291958 (Thread-58): 17:19:52  Parsing macros/utils/datediff.sql
2022-12-25 17:19:52.293159 (Thread-58): 17:19:52  Parsing macros/utils/concat.sql
2022-12-25 17:19:52.294182 (Thread-58): 17:19:52  Parsing macros/utils/length.sql
2022-12-25 17:19:52.295141 (Thread-58): 17:19:52  Parsing macros/utils/any_value.sql
2022-12-25 17:19:52.296052 (Thread-58): 17:19:52  Parsing macros/utils/data_types.sql
2022-12-25 17:19:52.302472 (Thread-58): 17:19:52  Parsing macros/utils/array_concat.sql
2022-12-25 17:19:52.303517 (Thread-58): 17:19:52  Parsing macros/utils/right.sql
2022-12-25 17:19:52.305229 (Thread-58): 17:19:52  Parsing macros/utils/array_append.sql
2022-12-25 17:19:52.306766 (Thread-58): 17:19:52  Parsing macros/utils/last_day.sql
2022-12-25 17:19:52.309249 (Thread-58): 17:19:52  Parsing macros/utils/split_part.sql
2022-12-25 17:19:52.311567 (Thread-58): 17:19:52  Parsing macros/utils/date_trunc.sql
2022-12-25 17:19:52.312581 (Thread-58): 17:19:52  Parsing macros/utils/literal.sql
2022-12-25 17:19:52.313584 (Thread-58): 17:19:52  Parsing macros/utils/hash.sql
2022-12-25 17:19:52.314823 (Thread-58): 17:19:52  Parsing macros/utils/except.sql
2022-12-25 17:19:52.315628 (Thread-58): 17:19:52  Parsing macros/utils/bool_or.sql
2022-12-25 17:19:52.316518 (Thread-58): 17:19:52  Parsing macros/utils/replace.sql
2022-12-25 17:19:52.317729 (Thread-58): 17:19:52  Parsing macros/utils/dateadd.sql
2022-12-25 17:19:52.318983 (Thread-58): 17:19:52  Parsing macros/utils/listagg.sql
2022-12-25 17:19:52.322071 (Thread-58): 17:19:52  Parsing tests/generic/builtin.sql
2022-12-25 17:19:52.400851 (Thread-59): handling status request
2022-12-25 17:19:52.421599 (Thread-59): 17:19:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf484406a0>]}
2022-12-25 17:19:52.469697 (Thread-60): handling status request
2022-12-25 17:19:52.480407 (Thread-60): 17:19:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf48440be0>]}
2022-12-25 17:19:52.506637 (Thread-61): handling status request
2022-12-25 17:19:52.512121 (Thread-61): 17:19:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf484a9100>]}
2022-12-25 17:19:52.587706 (Thread-58): 17:19:52  1699: static parser successfully parsed mart/fct_top_tracks.sql
2022-12-25 17:19:52.590750 (Thread-58): 17:19:52  1699: static parser successfully parsed mart/fct_songplays.sql
2022-12-25 17:19:52.593370 (Thread-58): 17:19:52  1699: static parser successfully parsed mart/fct_top_artists.sql
2022-12-25 17:19:52.596043 (Thread-58): 17:19:52  1603: static parser failed on mart/dim_artists.sql
2022-12-25 17:19:52.601127 (Thread-58): 17:19:52  1602: parser fallback to jinja rendering on mart/dim_artists.sql
2022-12-25 17:19:52.602736 (Thread-58): 17:19:52  1603: static parser failed on mart/dim_albums.sql
2022-12-25 17:19:52.607605 (Thread-58): 17:19:52  1602: parser fallback to jinja rendering on mart/dim_albums.sql
2022-12-25 17:19:52.608916 (Thread-58): 17:19:52  1603: static parser failed on mart/dim_tracks.sql
2022-12-25 17:19:52.613381 (Thread-58): 17:19:52  1602: parser fallback to jinja rendering on mart/dim_tracks.sql
2022-12-25 17:19:52.614757 (Thread-58): 17:19:52  1699: static parser successfully parsed staging/stg_top_tracks.sql
2022-12-25 17:19:52.617340 (Thread-58): 17:19:52  1699: static parser successfully parsed staging/stg_songplays.sql
2022-12-25 17:19:52.620125 (Thread-58): 17:19:52  1699: static parser successfully parsed staging/stg_top_artists.sql
2022-12-25 17:19:52.623087 (Thread-58): 17:19:52  1699: static parser successfully parsed view/vw_top_track_genres.sql
2022-12-25 17:19:52.626180 (Thread-58): 17:19:52  1699: static parser successfully parsed view/vw_top_artist_genres.sql
2022-12-25 17:19:52.629136 (Thread-58): 17:19:52  1699: static parser successfully parsed view/vw_songplays_genres.sql
2022-12-25 17:19:52.632970 (Thread-58): 17:19:52  1699: static parser successfully parsed view/vw_songplays_albums.sql
2022-12-25 17:19:52.679520 (Thread-59): sending response (<Response 163 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:19:52.690408 (Thread-60): sending response (<Response 187 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:19:52.701243 (Thread-61): sending response (<Response 187 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:19:52.776247 (Thread-62): handling status request
2022-12-25 17:19:52.796978 (Thread-62): 17:19:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf483aa430>]}
2022-12-25 17:19:52.802618 (Thread-62): sending response (<Response 163 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:19:52.872653 (Thread-63): handling status request
2022-12-25 17:19:52.873059 (Thread-63): 17:19:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf48497760>]}
2022-12-25 17:19:52.873470 (Thread-63): sending response (<Response 163 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:19:52.883850 (Thread-58): 17:19:52  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf48389cd0>]}
2022-12-25 17:19:52.928049 (Thread-64): handling status request
2022-12-25 17:19:52.928319 (Thread-64): 17:19:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf48389c40>]}
2022-12-25 17:19:52.929438 (Thread-64): sending response (<Response 33803 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:19:52.934033 (Thread-65): handling list request
2022-12-25 17:19:52.934286 (Thread-65): 17:19:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf4838dbe0>]}
2022-12-25 17:19:52.978354 (Thread-65): 17:19:52  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf48389700>]}
2022-12-25 17:19:52.978790 (Thread-65): 17:19:52  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 5 seed files, 5 sources, 0 exposures, 0 metrics
2022-12-25 17:19:52.979059 (Thread-65): 17:19:52  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf70080370>]}
2022-12-25 17:19:52.984609 (Thread-65): sending response (<Response 26155 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:19:54.002016 (Thread-66): handling status request
2022-12-25 17:19:54.002408 (Thread-66): 17:19:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf484d54c0>]}
2022-12-25 17:19:54.003714 (Thread-66): sending response (<Response 33827 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:19:54.011922 (Thread-67): handling status request
2022-12-25 17:19:54.012205 (Thread-67): 17:19:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf484d5250>]}
2022-12-25 17:19:54.013351 (Thread-67): sending response (<Response 33827 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:19:54.288568 (Thread-68): handling status request
2022-12-25 17:19:54.288972 (Thread-68): 17:19:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf48463be0>]}
2022-12-25 17:19:54.290274 (Thread-68): sending response (<Response 33803 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:19:54.294940 (Thread-69): handling list request
2022-12-25 17:19:54.295211 (Thread-69): 17:19:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf4838e700>]}
2022-12-25 17:19:54.328392 (Thread-69): 17:19:54  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf48359940>]}
2022-12-25 17:19:54.328841 (Thread-69): 17:19:54  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 5 seed files, 5 sources, 0 exposures, 0 metrics
2022-12-25 17:19:54.329114 (Thread-69): 17:19:54  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf700685b0>]}
2022-12-25 17:19:54.333477 (Thread-69): sending response (<Response 15262 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:19:55.154338 (Thread-70): 17:19:55  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-12-25 17:19:55.154855 (Thread-70): 17:19:55  Partial parsing: updated file: spotify://models/staging/stg_top_artists.sql
2022-12-25 17:19:55.328952 (Thread-70): 17:19:55  1699: static parser successfully parsed staging/stg_top_artists.sql
2022-12-25 17:19:55.384714 (Thread-70): 17:19:55  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf4844dd00>]}
2022-12-25 17:19:55.540230 (Thread-71): handling status request
2022-12-25 17:19:55.540652 (Thread-71): 17:19:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf4828ae80>]}
2022-12-25 17:19:55.541166 (Thread-71): sending response (<Response 1579 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:19:55.548488 (Thread-72): handling list request
2022-12-25 17:19:55.548811 (Thread-72): 17:19:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf4828aa60>]}
2022-12-25 17:19:55.585021 (Thread-72): 17:19:55  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf484636d0>]}
2022-12-25 17:19:55.585516 (Thread-72): 17:19:55  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 5 seed files, 5 sources, 0 exposures, 0 metrics
2022-12-25 17:19:55.585803 (Thread-72): 17:19:55  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf4828a2e0>]}
2022-12-25 17:19:55.590482 (Thread-72): sending response (<Response 15687 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:19:55.609236 (Thread-73): handling status request
2022-12-25 17:19:55.609500 (Thread-73): 17:19:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf4828a490>]}
2022-12-25 17:19:55.609902 (Thread-73): sending response (<Response 1603 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:19:55.688904 (Thread-74): handling status request
2022-12-25 17:19:55.689290 (Thread-74): 17:19:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf4828ab80>]}
2022-12-25 17:19:55.689782 (Thread-74): sending response (<Response 1603 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:19:56.768407 (Thread-75): handling status request
2022-12-25 17:19:56.768829 (Thread-75): 17:19:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf70058670>]}
2022-12-25 17:19:56.769293 (Thread-75): sending response (<Response 1579 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:19:56.773435 (Thread-76): handling list request
2022-12-25 17:19:56.773720 (Thread-76): 17:19:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf48168d90>]}
2022-12-25 17:19:56.808919 (Thread-76): 17:19:56  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf4816a5b0>]}
2022-12-25 17:19:56.809392 (Thread-76): 17:19:56  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 5 seed files, 5 sources, 0 exposures, 0 metrics
2022-12-25 17:19:56.809667 (Thread-76): 17:19:56  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf4828a310>]}
2022-12-25 17:19:56.815313 (Thread-76): sending response (<Response 25886 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:19:58.069058 (Thread-77): 17:19:58  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-12-25 17:19:58.069555 (Thread-77): 17:19:58  Partial parsing: updated file: spotify://models/staging/stg_top_tracks.sql
2022-12-25 17:19:58.074838 (Thread-77): 17:19:58  1699: static parser successfully parsed staging/stg_top_tracks.sql
2022-12-25 17:19:58.137030 (Thread-77): 17:19:58  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf9406dca0>]}
2022-12-25 17:19:58.511060 (Thread-78): handling status request
2022-12-25 17:19:58.511459 (Thread-78): 17:19:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf483a5f40>]}
2022-12-25 17:19:58.511943 (Thread-78): sending response (<Response 1577 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:19:58.518232 (Thread-79): handling list request
2022-12-25 17:19:58.518492 (Thread-79): 17:19:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf940a29a0>]}
2022-12-25 17:19:58.548613 (Thread-80): handling status request
2022-12-25 17:19:58.549018 (Thread-80): 17:19:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf940c4df0>]}
2022-12-25 17:19:58.552000 (Thread-79): 17:19:58  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf940d4070>]}
2022-12-25 17:19:58.572347 (Thread-80): sending response (<Response 1601 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:19:58.572860 (Thread-79): 17:19:58  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 5 seed files, 5 sources, 0 exposures, 0 metrics
2022-12-25 17:19:58.573071 (Thread-79): 17:19:58  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf940a2130>]}
2022-12-25 17:19:58.581026 (Thread-79): sending response (<Response 27639 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:19:58.591109 (Thread-81): handling status request
2022-12-25 17:19:58.591359 (Thread-81): 17:19:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf94133280>]}
2022-12-25 17:19:58.591696 (Thread-81): sending response (<Response 1601 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:20:15.197194 (Thread-82): 17:20:15  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-12-25 17:20:15.197678 (Thread-82): 17:20:15  Partial parsing: deleted source source.spotify.spotify.current_user_playlists
2022-12-25 17:20:15.197812 (Thread-82): 17:20:15  Partial parsing: deleted source source.spotify.spotify.current_user_recently_played
2022-12-25 17:20:15.197920 (Thread-82): 17:20:15  Partial parsing: deleted source source.spotify.spotify.current_user_top_artists
2022-12-25 17:20:15.198008 (Thread-82): 17:20:15  Partial parsing: deleted source source.spotify.spotify.current_user_top_tracks
2022-12-25 17:20:15.198094 (Thread-82): 17:20:15  Partial parsing: deleted source source.spotify.spotify.playlist_items
2022-12-25 17:20:15.198199 (Thread-82): 17:20:15  Partial parsing: update schema file: spotify://models/staging/schema.yml
2022-12-25 17:20:15.252526 (Thread-82): 17:20:15  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbef877b160>]}
2022-12-25 17:20:15.747442 (Thread-83): handling status request
2022-12-25 17:20:15.747843 (Thread-83): 17:20:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf9438adf0>]}
2022-12-25 17:20:15.748346 (Thread-83): sending response (<Response 2919 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:20:15.777586 (Thread-84): handling status request
2022-12-25 17:20:15.777939 (Thread-84): 17:20:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf483f2610>]}
2022-12-25 17:20:15.778385 (Thread-84): sending response (<Response 2919 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:20:27.159190 (Thread-85): handling status request
2022-12-25 17:20:27.159586 (Thread-85): 17:20:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'ef74bd85-2ebe-4b56-b048-c091aa7e4897', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbf9438ae20>]}
2022-12-25 17:20:27.160066 (Thread-85): sending response (<Response 2919 bytes [200 OK]>) to 10.0.40.27
2022-12-25 17:33:02.987919 (MainThread): Running with dbt=1.3.1
2022-12-25 17:33:03.617864 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt_rpc.task.server.RPCServerTask'>, debug=None, defer=None, exclude=None, fail_fast=None, host='0.0.0.0', log_cache_events=False, log_format=None, models=None, partial_parse=True, port=8580, printer_width=None, profile='user', profiles_dir='/usr/src/develop/.dbt', project_dir=None, record_timing_info=None, rpc_method=None, send_anonymous_usage_stats=None, single_threaded=False, state=None, static_parser=None, target=None, threads=None, use_colors=None, use_experimental_parser=None, vars='{}', version_check=None, warn_error=None, which='rpc', write_json=None)
2022-12-25 17:33:03.627042 (MainThread): Tracking: tracking
2022-12-25 17:33:03.663766 (Thread-12): 17:33:03  Unable to do partial parsing because profile has changed
2022-12-25 17:33:03.664575 (Thread-12): 17:33:03  Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec676777f0>]}
2022-12-25 17:33:03.670801 (MainThread): 17:33:03  Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec67677a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34efafa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34efadf0>]}
2022-12-25 17:33:03.671037 (MainThread): Serving RPC server at 0.0.0.0:8580, pid=29
2022-12-25 17:33:03.671283 (MainThread): Supported methods: ['build', 'cli_args', 'compile', 'compile_sql', 'deps', 'docs.generate', 'gc', 'get-manifest', 'kill', 'list', 'poll', 'ps', 'run', 'run-operation', 'run_sql', 'seed', 'snapshot', 'snapshot-freshness', 'source-freshness', 'status', 'test']
2022-12-25 17:33:03.671458 (MainThread): Send requests to http://localhost:8580/jsonrpc
2022-12-25 17:33:03.737943 (Thread-12): 17:33:03  Parsing macros/etc.sql
2022-12-25 17:33:03.740709 (Thread-12): 17:33:03  Parsing macros/catalog.sql
2022-12-25 17:33:03.746356 (Thread-12): 17:33:03  Parsing macros/adapters.sql
2022-12-25 17:33:03.766259 (Thread-12): 17:33:03  Parsing macros/adapters/apply_grants.sql
2022-12-25 17:33:03.768702 (Thread-12): 17:33:03  Parsing macros/materializations/seed.sql
2022-12-25 17:33:03.771214 (Thread-12): 17:33:03  Parsing macros/materializations/incremental.sql
2022-12-25 17:33:03.787818 (Thread-12): 17:33:03  Parsing macros/materializations/snapshot.sql
2022-12-25 17:33:03.789487 (Thread-12): 17:33:03  Parsing macros/materializations/table.sql
2022-12-25 17:33:03.796094 (Thread-12): 17:33:03  Parsing macros/materializations/copy.sql
2022-12-25 17:33:03.798671 (Thread-12): 17:33:03  Parsing macros/materializations/view.sql
2022-12-25 17:33:03.801283 (Thread-12): 17:33:03  Parsing macros/utils/intersect.sql
2022-12-25 17:33:03.801719 (Thread-12): 17:33:03  Parsing macros/utils/position.sql
2022-12-25 17:33:03.802292 (Thread-12): 17:33:03  Parsing macros/utils/escape_single_quotes.sql
2022-12-25 17:33:03.802865 (Thread-12): 17:33:03  Parsing macros/utils/safe_cast.sql
2022-12-25 17:33:03.803396 (Thread-12): 17:33:03  Parsing macros/utils/array_construct.sql
2022-12-25 17:33:03.804230 (Thread-12): 17:33:03  Parsing macros/utils/datediff.sql
2022-12-25 17:33:03.805400 (Thread-12): 17:33:03  Parsing macros/utils/timestamps.sql
2022-12-25 17:33:03.806510 (Thread-12): 17:33:03  Parsing macros/utils/array_concat.sql
2022-12-25 17:33:03.807087 (Thread-12): 17:33:03  Parsing macros/utils/right.sql
2022-12-25 17:33:03.807751 (Thread-12): 17:33:03  Parsing macros/utils/array_append.sql
2022-12-25 17:33:03.808489 (Thread-12): 17:33:03  Parsing macros/utils/split_part.sql
2022-12-25 17:33:03.810199 (Thread-12): 17:33:03  Parsing macros/utils/date_trunc.sql
2022-12-25 17:33:03.810765 (Thread-12): 17:33:03  Parsing macros/utils/hash.sql
2022-12-25 17:33:03.811321 (Thread-12): 17:33:03  Parsing macros/utils/except.sql
2022-12-25 17:33:03.811734 (Thread-12): 17:33:03  Parsing macros/utils/bool_or.sql
2022-12-25 17:33:03.812200 (Thread-12): 17:33:03  Parsing macros/utils/dateadd.sql
2022-12-25 17:33:03.812837 (Thread-12): 17:33:03  Parsing macros/utils/listagg.sql
2022-12-25 17:33:03.813842 (Thread-12): 17:33:03  Parsing macros/etc/statement.sql
2022-12-25 17:33:03.818761 (Thread-12): 17:33:03  Parsing macros/etc/datetime.sql
2022-12-25 17:33:03.826754 (Thread-12): 17:33:03  Parsing macros/adapters/apply_grants.sql
2022-12-25 17:33:03.840260 (Thread-12): 17:33:03  Parsing macros/adapters/freshness.sql
2022-12-25 17:33:03.842152 (Thread-12): 17:33:03  Parsing macros/adapters/columns.sql
2022-12-25 17:33:03.850997 (Thread-12): 17:33:03  Parsing macros/adapters/timestamps.sql
2022-12-25 17:33:03.854223 (Thread-12): 17:33:03  Parsing macros/adapters/relation.sql
2022-12-25 17:33:03.867687 (Thread-12): 17:33:03  Parsing macros/adapters/schema.sql
2022-12-25 17:33:03.869776 (Thread-12): 17:33:03  Parsing macros/adapters/persist_docs.sql
2022-12-25 17:33:03.874031 (Thread-12): 17:33:03  Parsing macros/adapters/metadata.sql
2022-12-25 17:33:03.880666 (Thread-12): 17:33:03  Parsing macros/adapters/indexes.sql
2022-12-25 17:33:03.883214 (Thread-12): 17:33:03  Parsing macros/get_custom_name/get_custom_database.sql
2022-12-25 17:33:03.884706 (Thread-12): 17:33:03  Parsing macros/get_custom_name/get_custom_schema.sql
2022-12-25 17:33:03.887023 (Thread-12): 17:33:03  Parsing macros/get_custom_name/get_custom_alias.sql
2022-12-25 17:33:03.888581 (Thread-12): 17:33:03  Parsing macros/python_model/python.sql
2022-12-25 17:33:03.894217 (Thread-12): 17:33:03  Parsing macros/materializations/hooks.sql
2022-12-25 17:33:03.898456 (Thread-12): 17:33:03  Parsing macros/materializations/configs.sql
2022-12-25 17:33:03.900763 (Thread-12): 17:33:03  Parsing macros/materializations/seeds/seed.sql
2022-12-25 17:33:03.907129 (Thread-12): 17:33:03  Parsing macros/materializations/seeds/helpers.sql
2022-12-25 17:33:03.923742 (Thread-12): 17:33:03  Parsing macros/materializations/tests/test.sql
2022-12-25 17:33:03.927807 (Thread-12): 17:33:03  Parsing macros/materializations/tests/helpers.sql
2022-12-25 17:33:03.929452 (Thread-12): 17:33:03  Parsing macros/materializations/tests/where_subquery.sql
2022-12-25 17:33:03.931185 (Thread-12): 17:33:03  Parsing macros/materializations/models/view/helpers.sql
2022-12-25 17:33:03.932441 (Thread-12): 17:33:03  Parsing macros/materializations/models/view/create_or_replace_view.sql
2022-12-25 17:33:03.935577 (Thread-12): 17:33:03  Parsing macros/materializations/models/view/create_view_as.sql
2022-12-25 17:33:03.937847 (Thread-12): 17:33:03  Parsing macros/materializations/models/view/view.sql
2022-12-25 17:33:03.942892 (Thread-12): 17:33:03  Parsing macros/materializations/models/incremental/strategies.sql
2022-12-25 17:33:03.949261 (Thread-12): 17:33:03  Parsing macros/materializations/models/incremental/column_helpers.sql
2022-12-25 17:33:03.956632 (Thread-12): 17:33:03  Parsing macros/materializations/models/incremental/incremental.sql
2022-12-25 17:33:03.966059 (Thread-12): 17:33:03  Parsing macros/materializations/models/incremental/on_schema_change.sql
2022-12-25 17:33:03.981011 (Thread-12): 17:33:03  Parsing macros/materializations/models/incremental/is_incremental.sql
2022-12-25 17:33:03.982438 (Thread-12): 17:33:03  Parsing macros/materializations/models/incremental/merge.sql
2022-12-25 17:33:03.996175 (Thread-12): 17:33:03  Parsing macros/materializations/models/table/create_table_as.sql
2022-12-25 17:33:03.999463 (Thread-12): 17:33:03  Parsing macros/materializations/models/table/table.sql
2022-12-25 17:33:04.004467 (Thread-12): 17:33:04  Parsing macros/materializations/snapshots/strategies.sql
2022-12-25 17:33:04.019942 (Thread-12): 17:33:04  Parsing macros/materializations/snapshots/snapshot_merge.sql
2022-12-25 17:33:04.021468 (Thread-12): 17:33:04  Parsing macros/materializations/snapshots/snapshot.sql
2022-12-25 17:33:04.032152 (Thread-12): 17:33:04  Parsing macros/materializations/snapshots/helpers.sql
2022-12-25 17:33:04.043767 (Thread-12): 17:33:04  Parsing macros/generic_test_sql/not_null.sql
2022-12-25 17:33:04.044570 (Thread-12): 17:33:04  Parsing macros/generic_test_sql/relationships.sql
2022-12-25 17:33:04.045400 (Thread-12): 17:33:04  Parsing macros/generic_test_sql/unique.sql
2022-12-25 17:33:04.046099 (Thread-12): 17:33:04  Parsing macros/generic_test_sql/accepted_values.sql
2022-12-25 17:33:04.047375 (Thread-12): 17:33:04  Parsing macros/utils/intersect.sql
2022-12-25 17:33:04.048216 (Thread-12): 17:33:04  Parsing macros/utils/position.sql
2022-12-25 17:33:04.049281 (Thread-12): 17:33:04  Parsing macros/utils/escape_single_quotes.sql
2022-12-25 17:33:04.050342 (Thread-12): 17:33:04  Parsing macros/utils/safe_cast.sql
2022-12-25 17:33:04.051568 (Thread-12): 17:33:04  Parsing macros/utils/array_construct.sql
2022-12-25 17:33:04.053100 (Thread-12): 17:33:04  Parsing macros/utils/cast_bool_to_text.sql
2022-12-25 17:33:04.054214 (Thread-12): 17:33:04  Parsing macros/utils/datediff.sql
2022-12-25 17:33:04.055425 (Thread-12): 17:33:04  Parsing macros/utils/concat.sql
2022-12-25 17:33:04.056408 (Thread-12): 17:33:04  Parsing macros/utils/length.sql
2022-12-25 17:33:04.057348 (Thread-12): 17:33:04  Parsing macros/utils/any_value.sql
2022-12-25 17:33:04.058313 (Thread-12): 17:33:04  Parsing macros/utils/data_types.sql
2022-12-25 17:33:04.064938 (Thread-12): 17:33:04  Parsing macros/utils/array_concat.sql
2022-12-25 17:33:04.066560 (Thread-12): 17:33:04  Parsing macros/utils/right.sql
2022-12-25 17:33:04.067736 (Thread-12): 17:33:04  Parsing macros/utils/array_append.sql
2022-12-25 17:33:04.068794 (Thread-12): 17:33:04  Parsing macros/utils/last_day.sql
2022-12-25 17:33:04.070573 (Thread-12): 17:33:04  Parsing macros/utils/split_part.sql
2022-12-25 17:33:04.072523 (Thread-12): 17:33:04  Parsing macros/utils/date_trunc.sql
2022-12-25 17:33:04.073596 (Thread-12): 17:33:04  Parsing macros/utils/literal.sql
2022-12-25 17:33:04.074565 (Thread-12): 17:33:04  Parsing macros/utils/hash.sql
2022-12-25 17:33:04.075786 (Thread-12): 17:33:04  Parsing macros/utils/except.sql
2022-12-25 17:33:04.076608 (Thread-12): 17:33:04  Parsing macros/utils/bool_or.sql
2022-12-25 17:33:04.077523 (Thread-12): 17:33:04  Parsing macros/utils/replace.sql
2022-12-25 17:33:04.078747 (Thread-12): 17:33:04  Parsing macros/utils/dateadd.sql
2022-12-25 17:33:04.079979 (Thread-12): 17:33:04  Parsing macros/utils/listagg.sql
2022-12-25 17:33:04.082185 (Thread-12): 17:33:04  Parsing tests/generic/builtin.sql
2022-12-25 17:33:04.344987 (Thread-12): 17:33:04  1699: static parser successfully parsed mart/fct_top_tracks.sql
2022-12-25 17:33:04.357814 (Thread-12): 17:33:04  1699: static parser successfully parsed mart/fct_songplays.sql
2022-12-25 17:33:04.360475 (Thread-12): 17:33:04  1699: static parser successfully parsed mart/fct_top_artists.sql
2022-12-25 17:33:04.363198 (Thread-12): 17:33:04  1603: static parser failed on mart/dim_artists.sql
2022-12-25 17:33:04.368096 (Thread-12): 17:33:04  1602: parser fallback to jinja rendering on mart/dim_artists.sql
2022-12-25 17:33:04.369367 (Thread-12): 17:33:04  1603: static parser failed on mart/dim_albums.sql
2022-12-25 17:33:04.374045 (Thread-12): 17:33:04  1602: parser fallback to jinja rendering on mart/dim_albums.sql
2022-12-25 17:33:04.375492 (Thread-12): 17:33:04  1603: static parser failed on mart/dim_tracks.sql
2022-12-25 17:33:04.380197 (Thread-12): 17:33:04  1602: parser fallback to jinja rendering on mart/dim_tracks.sql
2022-12-25 17:33:04.381535 (Thread-12): 17:33:04  1699: static parser successfully parsed staging/stg_top_tracks.sql
2022-12-25 17:33:04.384183 (Thread-12): 17:33:04  1699: static parser successfully parsed staging/stg_songplays.sql
2022-12-25 17:33:04.386762 (Thread-12): 17:33:04  1699: static parser successfully parsed staging/stg_top_artists.sql
2022-12-25 17:33:04.389924 (Thread-12): 17:33:04  1699: static parser successfully parsed view/vw_top_track_genres.sql
2022-12-25 17:33:04.393004 (Thread-12): 17:33:04  1699: static parser successfully parsed view/vw_top_artist_genres.sql
2022-12-25 17:33:04.395990 (Thread-12): 17:33:04  1699: static parser successfully parsed view/vw_songplays_genres.sql
2022-12-25 17:33:04.398815 (Thread-12): 17:33:04  1699: static parser successfully parsed view/vw_songplays_albums.sql
2022-12-25 17:33:04.657535 (Thread-12): 17:33:04  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34c7bc10>]}
2022-12-25 17:33:04.794231 (Thread-13): handling ps request
2022-12-25 17:33:04.795154 (Thread-14): handling status request
2022-12-25 17:33:04.795414 (Thread-13): 17:33:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34c39160>]}
2022-12-25 17:33:04.796148 (Thread-13): sending response (<Response 100 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:33:04.796336 (Thread-14): 17:33:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34c39430>]}
2022-12-25 17:33:04.798171 (Thread-14): sending response (<Response 33739 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:33:12.373203 (Thread-15): handling status request
2022-12-25 17:33:12.374228 (Thread-15): 17:33:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34c39910>]}
2022-12-25 17:33:12.375493 (Thread-15): sending response (<Response 33739 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:33:12.429455 (Thread-16): handling cli_args request
2022-12-25 17:33:12.433682 (Thread-16): 17:33:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34c39c40>]}
2022-12-25 17:33:15.056949 (Thread-16): sending response (<Response 133 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:33:15.119153 (MainThread): 17:33:15  Unable to do partial parsing because config vars, config profile, or config target have changed
2022-12-25 17:33:15.119574 (MainThread): 17:33:15  Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ada18b0e-e46d-4e11-b28f-f9924f8d37c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66204a2e80>]}
2022-12-25 17:33:15.169350 (MainThread): 17:33:15  Parsing macros/etc.sql
2022-12-25 17:33:15.171865 (MainThread): 17:33:15  Parsing macros/catalog.sql
2022-12-25 17:33:15.177495 (MainThread): 17:33:15  Parsing macros/adapters.sql
2022-12-25 17:33:15.200757 (MainThread): 17:33:15  Parsing macros/adapters/apply_grants.sql
2022-12-25 17:33:15.204316 (MainThread): 17:33:15  Parsing macros/materializations/seed.sql
2022-12-25 17:33:15.207565 (MainThread): 17:33:15  Parsing macros/materializations/incremental.sql
2022-12-25 17:33:15.231442 (MainThread): 17:33:15  Parsing macros/materializations/snapshot.sql
2022-12-25 17:33:15.233270 (MainThread): 17:33:15  Parsing macros/materializations/table.sql
2022-12-25 17:33:15.243039 (MainThread): 17:33:15  Parsing macros/materializations/copy.sql
2022-12-25 17:33:15.246603 (MainThread): 17:33:15  Parsing macros/materializations/view.sql
2022-12-25 17:33:15.250573 (MainThread): 17:33:15  Parsing macros/utils/intersect.sql
2022-12-25 17:33:15.251160 (MainThread): 17:33:15  Parsing macros/utils/position.sql
2022-12-25 17:33:15.252050 (MainThread): 17:33:15  Parsing macros/utils/escape_single_quotes.sql
2022-12-25 17:33:15.252722 (MainThread): 17:33:15  Parsing macros/utils/safe_cast.sql
2022-12-25 17:33:15.253242 (MainThread): 17:33:15  Parsing macros/utils/array_construct.sql
2022-12-25 17:33:15.254548 (MainThread): 17:33:15  Parsing macros/utils/datediff.sql
2022-12-25 17:33:15.255912 (MainThread): 17:33:15  Parsing macros/utils/timestamps.sql
2022-12-25 17:33:15.256992 (MainThread): 17:33:15  Parsing macros/utils/array_concat.sql
2022-12-25 17:33:15.257580 (MainThread): 17:33:15  Parsing macros/utils/right.sql
2022-12-25 17:33:15.258568 (MainThread): 17:33:15  Parsing macros/utils/array_append.sql
2022-12-25 17:33:15.259364 (MainThread): 17:33:15  Parsing macros/utils/split_part.sql
2022-12-25 17:33:15.261173 (MainThread): 17:33:15  Parsing macros/utils/date_trunc.sql
2022-12-25 17:33:15.261767 (MainThread): 17:33:15  Parsing macros/utils/hash.sql
2022-12-25 17:33:15.262266 (MainThread): 17:33:15  Parsing macros/utils/except.sql
2022-12-25 17:33:15.262904 (MainThread): 17:33:15  Parsing macros/utils/bool_or.sql
2022-12-25 17:33:15.263628 (MainThread): 17:33:15  Parsing macros/utils/dateadd.sql
2022-12-25 17:33:15.264415 (MainThread): 17:33:15  Parsing macros/utils/listagg.sql
2022-12-25 17:33:15.265716 (MainThread): 17:33:15  Parsing macros/etc/statement.sql
2022-12-25 17:33:15.270589 (MainThread): 17:33:15  Parsing macros/etc/datetime.sql
2022-12-25 17:33:15.354207 (Thread-17): handling ps request
2022-12-25 17:33:15.354609 (Thread-17): 17:33:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34ce42e0>]}
2022-12-25 17:33:15.355362 (Thread-17): sending response (<Response 525 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:33:15.278706 (MainThread): 17:33:15  Parsing macros/adapters/apply_grants.sql
2022-12-25 17:33:15.291747 (MainThread): 17:33:15  Parsing macros/adapters/freshness.sql
2022-12-25 17:33:15.363212 (Thread-18): handling poll request
2022-12-25 17:33:15.363501 (Thread-18): 17:33:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34c41d90>]}
2022-12-25 17:33:15.364207 (Thread-18): sending response (<Response 10043 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:33:15.293753 (MainThread): 17:33:15  Parsing macros/adapters/columns.sql
2022-12-25 17:33:15.302765 (MainThread): 17:33:15  Parsing macros/adapters/timestamps.sql
2022-12-25 17:33:15.306108 (MainThread): 17:33:15  Parsing macros/adapters/relation.sql
2022-12-25 17:33:15.319859 (MainThread): 17:33:15  Parsing macros/adapters/schema.sql
2022-12-25 17:33:15.321895 (MainThread): 17:33:15  Parsing macros/adapters/persist_docs.sql
2022-12-25 17:33:15.326208 (MainThread): 17:33:15  Parsing macros/adapters/metadata.sql
2022-12-25 17:33:15.332880 (MainThread): 17:33:15  Parsing macros/adapters/indexes.sql
2022-12-25 17:33:15.335476 (MainThread): 17:33:15  Parsing macros/get_custom_name/get_custom_database.sql
2022-12-25 17:33:15.336913 (MainThread): 17:33:15  Parsing macros/get_custom_name/get_custom_schema.sql
2022-12-25 17:33:15.339174 (MainThread): 17:33:15  Parsing macros/get_custom_name/get_custom_alias.sql
2022-12-25 17:33:15.340781 (MainThread): 17:33:15  Parsing macros/python_model/python.sql
2022-12-25 17:33:15.346455 (MainThread): 17:33:15  Parsing macros/materializations/hooks.sql
2022-12-25 17:33:15.350059 (MainThread): 17:33:15  Parsing macros/materializations/configs.sql
2022-12-25 17:33:15.352199 (MainThread): 17:33:15  Parsing macros/materializations/seeds/seed.sql
2022-12-25 17:33:15.358553 (MainThread): 17:33:15  Parsing macros/materializations/seeds/helpers.sql
2022-12-25 17:33:15.375294 (MainThread): 17:33:15  Parsing macros/materializations/tests/test.sql
2022-12-25 17:33:15.379602 (MainThread): 17:33:15  Parsing macros/materializations/tests/helpers.sql
2022-12-25 17:33:15.381320 (MainThread): 17:33:15  Parsing macros/materializations/tests/where_subquery.sql
2022-12-25 17:33:15.383014 (MainThread): 17:33:15  Parsing macros/materializations/models/view/helpers.sql
2022-12-25 17:33:15.384234 (MainThread): 17:33:15  Parsing macros/materializations/models/view/create_or_replace_view.sql
2022-12-25 17:33:15.387356 (MainThread): 17:33:15  Parsing macros/materializations/models/view/create_view_as.sql
2022-12-25 17:33:15.389485 (MainThread): 17:33:15  Parsing macros/materializations/models/view/view.sql
2022-12-25 17:33:15.394632 (MainThread): 17:33:15  Parsing macros/materializations/models/incremental/strategies.sql
2022-12-25 17:33:15.401054 (MainThread): 17:33:15  Parsing macros/materializations/models/incremental/column_helpers.sql
2022-12-25 17:33:15.488809 (Thread-19): handling status request
2022-12-25 17:33:15.408596 (MainThread): 17:33:15  Parsing macros/materializations/models/incremental/incremental.sql
2022-12-25 17:33:15.489367 (Thread-19): 17:33:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34c2d6a0>]}
2022-12-25 17:33:15.490969 (Thread-19): sending response (<Response 33739 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:33:15.418210 (MainThread): 17:33:15  Parsing macros/materializations/models/incremental/on_schema_change.sql
2022-12-25 17:33:15.433421 (MainThread): 17:33:15  Parsing macros/materializations/models/incremental/is_incremental.sql
2022-12-25 17:33:15.434823 (MainThread): 17:33:15  Parsing macros/materializations/models/incremental/merge.sql
2022-12-25 17:33:15.448870 (MainThread): 17:33:15  Parsing macros/materializations/models/table/create_table_as.sql
2022-12-25 17:33:15.452141 (MainThread): 17:33:15  Parsing macros/materializations/models/table/table.sql
2022-12-25 17:33:15.457243 (MainThread): 17:33:15  Parsing macros/materializations/snapshots/strategies.sql
2022-12-25 17:33:15.472092 (MainThread): 17:33:15  Parsing macros/materializations/snapshots/snapshot_merge.sql
2022-12-25 17:33:15.473704 (MainThread): 17:33:15  Parsing macros/materializations/snapshots/snapshot.sql
2022-12-25 17:33:15.484437 (MainThread): 17:33:15  Parsing macros/materializations/snapshots/helpers.sql
2022-12-25 17:33:15.496381 (MainThread): 17:33:15  Parsing macros/generic_test_sql/not_null.sql
2022-12-25 17:33:15.497152 (MainThread): 17:33:15  Parsing macros/generic_test_sql/relationships.sql
2022-12-25 17:33:15.497998 (MainThread): 17:33:15  Parsing macros/generic_test_sql/unique.sql
2022-12-25 17:33:15.498635 (MainThread): 17:33:15  Parsing macros/generic_test_sql/accepted_values.sql
2022-12-25 17:33:15.500009 (MainThread): 17:33:15  Parsing macros/utils/intersect.sql
2022-12-25 17:33:15.500830 (MainThread): 17:33:15  Parsing macros/utils/position.sql
2022-12-25 17:33:15.501865 (MainThread): 17:33:15  Parsing macros/utils/escape_single_quotes.sql
2022-12-25 17:33:15.503248 (MainThread): 17:33:15  Parsing macros/utils/safe_cast.sql
2022-12-25 17:33:15.504293 (MainThread): 17:33:15  Parsing macros/utils/array_construct.sql
2022-12-25 17:33:15.505822 (MainThread): 17:33:15  Parsing macros/utils/cast_bool_to_text.sql
2022-12-25 17:33:15.506822 (MainThread): 17:33:15  Parsing macros/utils/datediff.sql
2022-12-25 17:33:15.507987 (MainThread): 17:33:15  Parsing macros/utils/concat.sql
2022-12-25 17:33:15.508905 (MainThread): 17:33:15  Parsing macros/utils/length.sql
2022-12-25 17:33:15.509901 (MainThread): 17:33:15  Parsing macros/utils/any_value.sql
2022-12-25 17:33:15.510795 (MainThread): 17:33:15  Parsing macros/utils/data_types.sql
2022-12-25 17:33:15.517383 (MainThread): 17:33:15  Parsing macros/utils/array_concat.sql
2022-12-25 17:33:15.518416 (MainThread): 17:33:15  Parsing macros/utils/right.sql
2022-12-25 17:33:15.519462 (MainThread): 17:33:15  Parsing macros/utils/array_append.sql
2022-12-25 17:33:15.520575 (MainThread): 17:33:15  Parsing macros/utils/last_day.sql
2022-12-25 17:33:15.522309 (MainThread): 17:33:15  Parsing macros/utils/split_part.sql
2022-12-25 17:33:15.524224 (MainThread): 17:33:15  Parsing macros/utils/date_trunc.sql
2022-12-25 17:33:15.525319 (MainThread): 17:33:15  Parsing macros/utils/literal.sql
2022-12-25 17:33:15.526386 (MainThread): 17:33:15  Parsing macros/utils/hash.sql
2022-12-25 17:33:15.527383 (MainThread): 17:33:15  Parsing macros/utils/except.sql
2022-12-25 17:33:15.528171 (MainThread): 17:33:15  Parsing macros/utils/bool_or.sql
2022-12-25 17:33:15.529042 (MainThread): 17:33:15  Parsing macros/utils/replace.sql
2022-12-25 17:33:15.530303 (MainThread): 17:33:15  Parsing macros/utils/dateadd.sql
2022-12-25 17:33:15.531480 (MainThread): 17:33:15  Parsing macros/utils/listagg.sql
2022-12-25 17:33:15.533578 (MainThread): 17:33:15  Parsing tests/generic/builtin.sql
2022-12-25 17:33:15.794430 (MainThread): 17:33:15  1699: static parser successfully parsed mart/fct_top_tracks.sql
2022-12-25 17:33:15.806138 (MainThread): 17:33:15  1699: static parser successfully parsed mart/fct_songplays.sql
2022-12-25 17:33:15.808878 (MainThread): 17:33:15  1699: static parser successfully parsed mart/fct_top_artists.sql
2022-12-25 17:33:15.811474 (MainThread): 17:33:15  1603: static parser failed on mart/dim_artists.sql
2022-12-25 17:33:15.815900 (MainThread): 17:33:15  1602: parser fallback to jinja rendering on mart/dim_artists.sql
2022-12-25 17:33:15.817248 (MainThread): 17:33:15  1603: static parser failed on mart/dim_albums.sql
2022-12-25 17:33:15.821559 (MainThread): 17:33:15  1602: parser fallback to jinja rendering on mart/dim_albums.sql
2022-12-25 17:33:15.823034 (MainThread): 17:33:15  1603: static parser failed on mart/dim_tracks.sql
2022-12-25 17:33:15.827374 (MainThread): 17:33:15  1602: parser fallback to jinja rendering on mart/dim_tracks.sql
2022-12-25 17:33:15.828655 (MainThread): 17:33:15  1699: static parser successfully parsed staging/stg_top_tracks.sql
2022-12-25 17:33:15.831264 (MainThread): 17:33:15  1699: static parser successfully parsed staging/stg_songplays.sql
2022-12-25 17:33:15.833981 (MainThread): 17:33:15  1699: static parser successfully parsed staging/stg_top_artists.sql
2022-12-25 17:33:15.837023 (MainThread): 17:33:15  1699: static parser successfully parsed view/vw_top_track_genres.sql
2022-12-25 17:33:15.840102 (MainThread): 17:33:15  1699: static parser successfully parsed view/vw_top_artist_genres.sql
2022-12-25 17:33:15.843063 (MainThread): 17:33:15  1699: static parser successfully parsed view/vw_songplays_genres.sql
2022-12-25 17:33:15.845887 (MainThread): 17:33:15  1699: static parser successfully parsed view/vw_songplays_albums.sql
2022-12-25 17:33:16.154567 (MainThread): 17:33:16  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ada18b0e-e46d-4e11-b28f-f9924f8d37c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66202f3520>]}
2022-12-25 17:33:16.186975 (MainThread): 17:33:16  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ada18b0e-e46d-4e11-b28f-f9924f8d37c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f662052c2e0>]}
2022-12-25 17:33:16.187285 (MainThread): 17:33:16  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 17:33:16.187390 (MainThread): 17:33:16  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ada18b0e-e46d-4e11-b28f-f9924f8d37c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66205ba2b0>]}
2022-12-25 17:33:16.189494 (MainThread): 17:33:16  
2022-12-25 17:33:16.189978 (MainThread): 17:33:16  Acquiring new bigquery connection "master"
2022-12-25 17:33:16.191173 (ThreadPoolExecutor-0_0): 17:33:16  Acquiring new bigquery connection "list_dbt-demo-data-372717"
2022-12-25 17:33:16.191320 (ThreadPoolExecutor-0_0): 17:33:16  Opening a new connection, currently in state init
2022-12-25 17:33:16.417401 (ThreadPoolExecutor-1_0): 17:33:16  Acquiring new bigquery connection "list_dbt-demo-data-372717_dbt_ddemo"
2022-12-25 17:33:16.417592 (ThreadPoolExecutor-1_0): 17:33:16  Opening a new connection, currently in state closed
2022-12-25 17:33:16.577201 (Thread-20): handling poll request
2022-12-25 17:33:16.577632 (Thread-20): 17:33:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34bbe6d0>]}
2022-12-25 17:33:16.578720 (Thread-20): sending response (<Response 27662 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:33:16.606604 (MainThread): 17:33:16  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ada18b0e-e46d-4e11-b28f-f9924f8d37c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6620458ca0>]}
2022-12-25 17:33:16.607256 (MainThread): 17:33:16  Concurrency: 4 threads (target='default')
2022-12-25 17:33:16.607379 (MainThread): 17:33:16  
2022-12-25 17:33:16.609977 (Thread-1): 17:33:16  Began running node seed.spotify.current_user_playlists
2022-12-25 17:33:16.610260 (Thread-1): 17:33:16  1 of 5 START seed file dbt_ddemo.current_user_playlists ........................ [RUN]
2022-12-25 17:33:16.610827 (Thread-2): 17:33:16  Began running node seed.spotify.current_user_recently_played
2022-12-25 17:33:16.611074 (Thread-2): 17:33:16  2 of 5 START seed file dbt_ddemo.current_user_recently_played .................. [RUN]
2022-12-25 17:33:16.611515 (Thread-2): 17:33:16  Acquiring new bigquery connection "seed.spotify.current_user_recently_played"
2022-12-25 17:33:16.611632 (Thread-2): 17:33:16  Began compiling node seed.spotify.current_user_recently_played
2022-12-25 17:33:16.611731 (Thread-2): 17:33:16  finished collecting timing info
2022-12-25 17:33:16.611841 (Thread-2): 17:33:16  Began executing node seed.spotify.current_user_recently_played
2022-12-25 17:33:16.621153 (Thread-3): 17:33:16  Began running node seed.spotify.current_user_top_artists
2022-12-25 17:33:16.621391 (Thread-3): 17:33:16  3 of 5 START seed file dbt_ddemo.current_user_top_artists ...................... [RUN]
2022-12-25 17:33:16.621865 (Thread-3): 17:33:16  Acquiring new bigquery connection "seed.spotify.current_user_top_artists"
2022-12-25 17:33:16.621971 (Thread-3): 17:33:16  Began compiling node seed.spotify.current_user_top_artists
2022-12-25 17:33:16.622063 (Thread-3): 17:33:16  finished collecting timing info
2022-12-25 17:33:16.622167 (Thread-3): 17:33:16  Began executing node seed.spotify.current_user_top_artists
2022-12-25 17:33:16.626737 (Thread-1): 17:33:16  Acquiring new bigquery connection "seed.spotify.current_user_playlists"
2022-12-25 17:33:16.626851 (Thread-1): 17:33:16  Began compiling node seed.spotify.current_user_playlists
2022-12-25 17:33:16.626939 (Thread-1): 17:33:16  finished collecting timing info
2022-12-25 17:33:16.627042 (Thread-1): 17:33:16  Began executing node seed.spotify.current_user_playlists
2022-12-25 17:33:16.631437 (Thread-4): 17:33:16  Began running node seed.spotify.current_user_top_tracks
2022-12-25 17:33:16.631667 (Thread-4): 17:33:16  4 of 5 START seed file dbt_ddemo.current_user_top_tracks ....................... [RUN]
2022-12-25 17:33:16.632081 (Thread-4): 17:33:16  Acquiring new bigquery connection "seed.spotify.current_user_top_tracks"
2022-12-25 17:33:16.632179 (Thread-4): 17:33:16  Began compiling node seed.spotify.current_user_top_tracks
2022-12-25 17:33:16.632262 (Thread-4): 17:33:16  finished collecting timing info
2022-12-25 17:33:16.632363 (Thread-4): 17:33:16  Began executing node seed.spotify.current_user_top_tracks
2022-12-25 17:33:16.690612 (Thread-3): 17:33:16  Opening a new connection, currently in state init
2022-12-25 17:33:16.691321 (Thread-1): 17:33:16  Opening a new connection, currently in state closed
2022-12-25 17:33:16.709453 (Thread-4): 17:33:16  Opening a new connection, currently in state init
2022-12-25 17:33:16.711026 (Thread-2): 17:33:16  Opening a new connection, currently in state init
2022-12-25 17:33:17.556771 (Thread-21): handling ps request
2022-12-25 17:33:17.557181 (Thread-21): 17:33:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34bc63d0>]}
2022-12-25 17:33:17.557709 (Thread-21): sending response (<Response 525 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:33:17.754650 (Thread-22): handling status request
2022-12-25 17:33:17.755064 (Thread-22): 17:33:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34bc64f0>]}
2022-12-25 17:33:17.756508 (Thread-22): sending response (<Response 33739 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:33:17.775769 (Thread-23): handling poll request
2022-12-25 17:33:17.776089 (Thread-23): 17:33:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34bc6310>]}
2022-12-25 17:33:17.776790 (Thread-23): sending response (<Response 13505 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:33:18.972238 (Thread-24): handling poll request
2022-12-25 17:33:18.972645 (Thread-24): 17:33:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34bc6160>]}
2022-12-25 17:33:18.973117 (Thread-24): sending response (<Response 335 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:33:19.771488 (Thread-25): handling ps request
2022-12-25 17:33:19.771911 (Thread-25): 17:33:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34bc61f0>]}
2022-12-25 17:33:19.772410 (Thread-25): sending response (<Response 524 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:33:19.957337 (Thread-26): handling status request
2022-12-25 17:33:19.957761 (Thread-26): 17:33:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34bc65b0>]}
2022-12-25 17:33:19.959035 (Thread-26): sending response (<Response 33739 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:33:20.121654 (Thread-2): 17:33:20  Writing runtime SQL for node "seed.spotify.current_user_recently_played"
2022-12-25 17:33:20.155074 (Thread-27): handling poll request
2022-12-25 17:33:20.155445 (Thread-27): 17:33:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34bc6520>]}
2022-12-25 17:33:20.155936 (Thread-27): sending response (<Response 715 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:33:20.163641 (Thread-2): 17:33:20  finished collecting timing info
2022-12-25 17:33:20.164214 (Thread-2): 17:33:20  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ada18b0e-e46d-4e11-b28f-f9924f8d37c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6600165fd0>]}
2022-12-25 17:33:20.164501 (Thread-2): 17:33:20  2 of 5 OK loaded seed file dbt_ddemo.current_user_recently_played .............. [CREATE 50 in 3.55s]
2022-12-25 17:33:20.164718 (Thread-2): 17:33:20  Finished running node seed.spotify.current_user_recently_played
2022-12-25 17:33:20.164870 (Thread-2): 17:33:20  Began running node seed.spotify.playlist_items
2022-12-25 17:33:20.165081 (Thread-2): 17:33:20  5 of 5 START seed file dbt_ddemo.playlist_items ................................ [RUN]
2022-12-25 17:33:20.165458 (Thread-2): 17:33:20  Acquiring new bigquery connection "seed.spotify.playlist_items"
2022-12-25 17:33:20.165562 (Thread-2): 17:33:20  Began compiling node seed.spotify.playlist_items
2022-12-25 17:33:20.165685 (Thread-2): 17:33:20  finished collecting timing info
2022-12-25 17:33:20.165791 (Thread-2): 17:33:20  Began executing node seed.spotify.playlist_items
2022-12-25 17:33:20.249955 (Thread-1): 17:33:20  Writing runtime SQL for node "seed.spotify.current_user_playlists"
2022-12-25 17:33:20.295037 (Thread-1): 17:33:20  finished collecting timing info
2022-12-25 17:33:20.295651 (Thread-1): 17:33:20  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ada18b0e-e46d-4e11-b28f-f9924f8d37c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6600128970>]}
2022-12-25 17:33:20.295922 (Thread-1): 17:33:20  1 of 5 OK loaded seed file dbt_ddemo.current_user_playlists .................... [CREATE 50 in 3.69s]
2022-12-25 17:33:20.296131 (Thread-1): 17:33:20  Finished running node seed.spotify.current_user_playlists
2022-12-25 17:33:20.312570 (Thread-4): 17:33:20  Writing runtime SQL for node "seed.spotify.current_user_top_tracks"
2022-12-25 17:33:20.346665 (Thread-4): 17:33:20  finished collecting timing info
2022-12-25 17:33:20.347206 (Thread-4): 17:33:20  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ada18b0e-e46d-4e11-b28f-f9924f8d37c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66000cb160>]}
2022-12-25 17:33:20.347462 (Thread-4): 17:33:20  4 of 5 OK loaded seed file dbt_ddemo.current_user_top_tracks ................... [CREATE 50 in 3.72s]
2022-12-25 17:33:20.347677 (Thread-4): 17:33:20  Finished running node seed.spotify.current_user_top_tracks
2022-12-25 17:33:20.410352 (Thread-3): 17:33:20  Writing runtime SQL for node "seed.spotify.current_user_top_artists"
2022-12-25 17:33:20.443147 (Thread-3): 17:33:20  finished collecting timing info
2022-12-25 17:33:20.443903 (Thread-3): 17:33:20  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ada18b0e-e46d-4e11-b28f-f9924f8d37c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6600112850>]}
2022-12-25 17:33:20.444244 (Thread-3): 17:33:20  3 of 5 OK loaded seed file dbt_ddemo.current_user_top_artists .................. [CREATE 50 in 3.82s]
2022-12-25 17:33:20.444543 (Thread-3): 17:33:20  Finished running node seed.spotify.current_user_top_artists
2022-12-25 17:33:20.610109 (Thread-2): 17:33:20  Opening a new connection, currently in state closed
2022-12-25 17:33:21.341349 (Thread-28): handling poll request
2022-12-25 17:33:21.341822 (Thread-28): 17:33:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34bc6d90>]}
2022-12-25 17:33:21.342535 (Thread-28): sending response (<Response 11728 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:33:21.964793 (Thread-29): handling ps request
2022-12-25 17:33:21.966381 (Thread-29): 17:33:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34bcc430>]}
2022-12-25 17:33:21.966890 (Thread-29): sending response (<Response 525 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:33:22.153036 (Thread-30): handling status request
2022-12-25 17:33:22.153442 (Thread-30): 17:33:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34bcc460>]}
2022-12-25 17:33:22.154807 (Thread-30): sending response (<Response 33739 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:33:22.542586 (Thread-31): handling poll request
2022-12-25 17:33:22.542988 (Thread-31): 17:33:22  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34bcc5b0>]}
2022-12-25 17:33:22.543457 (Thread-31): sending response (<Response 336 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:33:23.746011 (Thread-32): handling poll request
2022-12-25 17:33:23.746408 (Thread-32): 17:33:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34bcc7f0>]}
2022-12-25 17:33:23.746877 (Thread-32): sending response (<Response 336 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:33:23.988686 (Thread-2): 17:33:23  Writing runtime SQL for node "seed.spotify.playlist_items"
2022-12-25 17:33:24.000222 (Thread-2): 17:33:24  finished collecting timing info
2022-12-25 17:33:24.000795 (Thread-2): 17:33:24  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ada18b0e-e46d-4e11-b28f-f9924f8d37c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66000da970>]}
2022-12-25 17:33:24.001197 (Thread-2): 17:33:24  5 of 5 OK loaded seed file dbt_ddemo.playlist_items ............................ [CREATE 3338 in 3.84s]
2022-12-25 17:33:24.001421 (Thread-2): 17:33:24  Finished running node seed.spotify.playlist_items
2022-12-25 17:33:24.003043 (MainThread): 17:33:24  Acquiring new bigquery connection "master"
2022-12-25 17:33:24.003506 (MainThread): 17:33:24  
2022-12-25 17:33:24.003621 (MainThread): 17:33:24  Finished running 5 seeds in 0 hours 0 minutes and 7.81 seconds (7.81s).
2022-12-25 17:33:24.003703 (MainThread): 17:33:24  Connection 'master' was properly closed.
2022-12-25 17:33:24.003787 (MainThread): 17:33:24  Connection 'seed.spotify.current_user_playlists' was properly closed.
2022-12-25 17:33:24.003848 (MainThread): 17:33:24  Connection 'seed.spotify.playlist_items' was properly closed.
2022-12-25 17:33:24.003907 (MainThread): 17:33:24  Connection 'seed.spotify.current_user_top_artists' was properly closed.
2022-12-25 17:33:24.003965 (MainThread): 17:33:24  Connection 'seed.spotify.current_user_top_tracks' was properly closed.
2022-12-25 17:33:24.048998 (MainThread): 17:33:24  
2022-12-25 17:33:24.049192 (MainThread): 17:33:24  Completed successfully
2022-12-25 17:33:24.049293 (MainThread): 17:33:24  
2022-12-25 17:33:24.049380 (MainThread): 17:33:24  Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
2022-12-25 17:33:24.154606 (Thread-33): handling ps request
2022-12-25 17:33:24.155006 (Thread-33): 17:33:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34f6ca60>]}
2022-12-25 17:33:24.155503 (Thread-33): sending response (<Response 526 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:33:24.341286 (Thread-34): handling status request
2022-12-25 17:33:24.341717 (Thread-34): 17:33:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec3505b880>]}
2022-12-25 17:33:24.342987 (Thread-34): sending response (<Response 33739 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:33:24.938575 (Thread-35): handling poll request
2022-12-25 17:33:24.938981 (Thread-35): 17:33:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec35039250>]}
2022-12-25 17:33:24.940210 (Thread-35): sending response (<Response 16227 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:33:26.338966 (Thread-36): handling ps request
2022-12-25 17:33:26.339376 (Thread-36): 17:33:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34f32760>]}
2022-12-25 17:33:26.339895 (Thread-36): sending response (<Response 551 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:33:26.535154 (Thread-37): handling status request
2022-12-25 17:33:26.535566 (Thread-37): 17:33:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34f0e9d0>]}
2022-12-25 17:33:26.536799 (Thread-37): sending response (<Response 33739 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:33:46.511660 (Thread-38): handling status request
2022-12-25 17:33:46.513287 (Thread-38): 17:33:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34f0ee50>]}
2022-12-25 17:33:46.514557 (Thread-38): sending response (<Response 33739 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:33:52.765397 (Thread-39): handling cli_args request
2022-12-25 17:33:52.765832 (Thread-39): 17:33:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34f0ea90>]}
2022-12-25 17:33:52.788643 (Thread-40): handling status request
2022-12-25 17:33:52.789859 (Thread-40): 17:33:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2d531fd0>]}
2022-12-25 17:33:52.793000 (Thread-40): sending response (<Response 33739 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:33:55.414911 (Thread-39): sending response (<Response 133 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:33:55.523225 (MainThread): 17:33:55  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-12-25 17:33:55.523660 (MainThread): 17:33:55  Partial parsing enabled, no changes found, skipping parsing
2022-12-25 17:33:55.531377 (MainThread): 17:33:55  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '896efbf2-36d2-4753-abf4-492b6c6eb053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d6406f4f0>]}
2022-12-25 17:33:55.563040 (MainThread): 17:33:55  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '896efbf2-36d2-4753-abf4-492b6c6eb053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d64188dc0>]}
2022-12-25 17:33:55.563305 (MainThread): 17:33:55  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 17:33:55.563406 (MainThread): 17:33:55  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '896efbf2-36d2-4753-abf4-492b6c6eb053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d64188b80>]}
2022-12-25 17:33:55.565345 (MainThread): 17:33:55  
2022-12-25 17:33:55.565900 (MainThread): 17:33:55  Acquiring new bigquery connection "master"
2022-12-25 17:33:55.567411 (ThreadPoolExecutor-0_0): 17:33:55  Acquiring new bigquery connection "list_dbt-demo-data-372717"
2022-12-25 17:33:55.567577 (ThreadPoolExecutor-0_0): 17:33:55  Opening a new connection, currently in state init
2022-12-25 17:33:55.692272 (Thread-41): handling poll request
2022-12-25 17:33:55.692724 (Thread-41): 17:33:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec6787abe0>]}
2022-12-25 17:33:55.693552 (Thread-41): sending response (<Response 3909 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:33:55.701030 (Thread-42): handling ps request
2022-12-25 17:33:55.701302 (Thread-42): 17:33:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec57c04970>]}
2022-12-25 17:33:55.701804 (Thread-42): sending response (<Response 946 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:33:55.713918 (Thread-43): handling status request
2022-12-25 17:33:55.714206 (Thread-43): 17:33:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec57c04280>]}
2022-12-25 17:33:55.716798 (Thread-43): sending response (<Response 33739 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:33:55.779830 (ThreadPoolExecutor-1_0): 17:33:55  Acquiring new bigquery connection "list_dbt-demo-data-372717_dbt_ddemo"
2022-12-25 17:33:55.780010 (ThreadPoolExecutor-1_0): 17:33:55  Opening a new connection, currently in state closed
2022-12-25 17:33:55.959116 (MainThread): 17:33:55  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '896efbf2-36d2-4753-abf4-492b6c6eb053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ddf119880>]}
2022-12-25 17:33:55.959791 (MainThread): 17:33:55  Concurrency: 4 threads (target='default')
2022-12-25 17:33:55.959918 (MainThread): 17:33:55  
2022-12-25 17:33:55.962433 (Thread-1): 17:33:55  Began running node model.spotify.stg_songplays
2022-12-25 17:33:55.962739 (Thread-1): 17:33:55  1 of 13 START sql view model dbt_ddemo.stg_songplays ........................... [RUN]
2022-12-25 17:33:55.963158 (Thread-1): 17:33:55  Acquiring new bigquery connection "model.spotify.stg_songplays"
2022-12-25 17:33:55.963272 (Thread-1): 17:33:55  Began compiling node model.spotify.stg_songplays
2022-12-25 17:33:55.963377 (Thread-1): 17:33:55  Compiling model.spotify.stg_songplays
2022-12-25 17:33:55.966679 (Thread-1): 17:33:55  Writing injected SQL for node "model.spotify.stg_songplays"
2022-12-25 17:33:55.966933 (Thread-2): 17:33:55  Began running node model.spotify.stg_top_artists
2022-12-25 17:33:55.967172 (Thread-2): 17:33:55  2 of 13 START sql view model dbt_ddemo.stg_top_artists ......................... [RUN]
2022-12-25 17:33:55.967597 (Thread-2): 17:33:55  Acquiring new bigquery connection "model.spotify.stg_top_artists"
2022-12-25 17:33:55.967700 (Thread-2): 17:33:55  Began compiling node model.spotify.stg_top_artists
2022-12-25 17:33:55.967784 (Thread-2): 17:33:55  Compiling model.spotify.stg_top_artists
2022-12-25 17:33:55.970391 (Thread-2): 17:33:55  Writing injected SQL for node "model.spotify.stg_top_artists"
2022-12-25 17:33:55.970635 (Thread-3): 17:33:55  Began running node model.spotify.stg_top_tracks
2022-12-25 17:33:55.970862 (Thread-3): 17:33:55  3 of 13 START sql view model dbt_ddemo.stg_top_tracks .......................... [RUN]
2022-12-25 17:33:55.971271 (Thread-3): 17:33:55  Acquiring new bigquery connection "model.spotify.stg_top_tracks"
2022-12-25 17:33:55.971372 (Thread-3): 17:33:55  Began compiling node model.spotify.stg_top_tracks
2022-12-25 17:33:55.971456 (Thread-3): 17:33:55  Compiling model.spotify.stg_top_tracks
2022-12-25 17:33:55.974236 (Thread-3): 17:33:55  Writing injected SQL for node "model.spotify.stg_top_tracks"
2022-12-25 17:33:55.999890 (Thread-2): 17:33:55  finished collecting timing info
2022-12-25 17:33:56.000087 (Thread-2): 17:33:56  Began executing node model.spotify.stg_top_artists
2022-12-25 17:33:56.005685 (Thread-3): 17:33:56  finished collecting timing info
2022-12-25 17:33:56.005839 (Thread-3): 17:33:56  Began executing node model.spotify.stg_top_tracks
2022-12-25 17:33:56.048874 (Thread-2): 17:33:56  Writing runtime sql for node "model.spotify.stg_top_artists"
2022-12-25 17:33:56.049099 (Thread-1): 17:33:56  finished collecting timing info
2022-12-25 17:33:56.049251 (Thread-1): 17:33:56  Began executing node model.spotify.stg_songplays
2022-12-25 17:33:56.051919 (Thread-3): 17:33:56  Writing runtime sql for node "model.spotify.stg_top_tracks"
2022-12-25 17:33:56.055450 (Thread-1): 17:33:56  Writing runtime sql for node "model.spotify.stg_songplays"
2022-12-25 17:33:56.069652 (Thread-3): 17:33:56  Opening a new connection, currently in state init
2022-12-25 17:33:56.073973 (Thread-3): 17:33:56  On model.spotify.stg_top_tracks: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "user", "target_name": "default", "node_id": "model.spotify.stg_top_tracks"} */


  create or replace view `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`
  OPTIONS()
  as -- stage_top_tracks
with source as (
    select
        *
    from `dbt-demo-data-372717`.`dbt_ddemo`.`current_user_top_tracks`
),

stage_top_tracks as (
    select
        track_rank,
        track_id,
    	track_name,
        track_duration,
        track_is_explicit,
        track_popularity,
        album_id,
        album_name,
        album_release_year,
        album_type,
        artist_name,
        artist_name_others,
        artist_id,
        artist_id_others,
        track_danceability,
        track_energy,
        track_key,
        track_loudness,
        track_mode,
        track_speechiness,
        track_acousticness,
        track_instrumentalness,
        track_liveness,
        track_valence,
        artist_popularity,
        artist_followers,
        artist_genre,
        artist_genre_others
    from source
)
select
    *
from stage_top_tracks;


2022-12-25 17:33:56.074715 (Thread-2): 17:33:56  Opening a new connection, currently in state init
2022-12-25 17:33:56.078302 (Thread-1): 17:33:56  Opening a new connection, currently in state closed
2022-12-25 17:33:56.079154 (Thread-2): 17:33:56  On model.spotify.stg_top_artists: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "user", "target_name": "default", "node_id": "model.spotify.stg_top_artists"} */


  create or replace view `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_artists`
  OPTIONS()
  as -- stage_top_artists
with source as (
    select
        *
    from `dbt-demo-data-372717`.`dbt_ddemo`.`current_user_top_artists`
),

stage_top_artists as (
    select
        artist_rank,
        artist_id,
        artist_name,
        artist_popularity,
        artist_followers,
        artist_genre,
        artist_genre_others
    from source
)
select
    *
from stage_top_artists;


2022-12-25 17:33:56.082589 (Thread-1): 17:33:56  On model.spotify.stg_songplays: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "user", "target_name": "default", "node_id": "model.spotify.stg_songplays"} */


  create or replace view `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`
  OPTIONS()
  as -- stage_songplays
with source as (
    select 
        *
    from `dbt-demo-data-372717`.`dbt_ddemo`.`current_user_recently_played`
),

stage_songplays as (
    select
        songplays_id,
        track_id,
    	track_name,
        track_duration,
        track_is_explicit,
        track_popularity,
        track_played_at,
        album_id,
        album_name,
        album_release_year,
        album_type,
        artist_name,
        artist_name_others,
        artist_id,
        artist_id_others,
        track_danceability,
        track_energy,
        track_key,
        track_loudness,
        track_mode,
        track_speechiness,
        track_acousticness,
        track_instrumentalness,
        track_liveness,
        track_valence,
        artist_popularity,
        artist_followers,
        artist_genre,
        artist_genre_others
    from source
)
select
    *
from stage_songplays;


2022-12-25 17:33:56.784286 (Thread-2): 17:33:56  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:9d8308e9-0b84-4535-9123-3be43b31d353:US&page=queryresults
2022-12-25 17:33:56.799490 (Thread-2): 17:33:56  finished collecting timing info
2022-12-25 17:33:56.800101 (Thread-2): 17:33:56  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '896efbf2-36d2-4753-abf4-492b6c6eb053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d406ca910>]}
2022-12-25 17:33:56.800459 (Thread-2): 17:33:56  2 of 13 OK created sql view model dbt_ddemo.stg_top_artists .................... [CREATE VIEW (0 processed) in 0.83s]
2022-12-25 17:33:56.800693 (Thread-2): 17:33:56  Finished running node model.spotify.stg_top_artists
2022-12-25 17:33:56.802024 (Thread-4): 17:33:56  Began running node model.spotify.fct_top_artists
2022-12-25 17:33:56.802285 (Thread-4): 17:33:56  4 of 13 START sql table model dbt_ddemo.fct_top_artists ........................ [RUN]
2022-12-25 17:33:56.802714 (Thread-4): 17:33:56  Acquiring new bigquery connection "model.spotify.fct_top_artists"
2022-12-25 17:33:56.802822 (Thread-4): 17:33:56  Began compiling node model.spotify.fct_top_artists
2022-12-25 17:33:56.802912 (Thread-4): 17:33:56  Compiling model.spotify.fct_top_artists
2022-12-25 17:33:56.805654 (Thread-4): 17:33:56  Writing injected SQL for node "model.spotify.fct_top_artists"
2022-12-25 17:33:56.823682 (Thread-4): 17:33:56  finished collecting timing info
2022-12-25 17:33:56.823850 (Thread-4): 17:33:56  Began executing node model.spotify.fct_top_artists
2022-12-25 17:33:56.849541 (Thread-4): 17:33:56  Writing runtime sql for node "model.spotify.fct_top_artists"
2022-12-25 17:33:56.866902 (Thread-4): 17:33:56  Opening a new connection, currently in state init
2022-12-25 17:33:56.871278 (Thread-4): 17:33:56  On model.spotify.fct_top_artists: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "user", "target_name": "default", "node_id": "model.spotify.fct_top_artists"} */

  
    

    create or replace table `dbt-demo-data-372717`.`dbt_ddemo`.`fct_top_artists`
    
    
    OPTIONS()
    as (
      -- top_artists table
with source as (
    select
        *
    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_artists`
),
fact_top_artists as (
    select
        artist_rank,
        artist_id
    from source
)
select
    *
from fact_top_artists
    );
  
2022-12-25 17:33:56.907329 (Thread-44): handling poll request
2022-12-25 17:33:56.907696 (Thread-44): 17:33:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec35125a90>]}
2022-12-25 17:33:56.908736 (Thread-44): sending response (<Response 25217 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:33:56.916997 (Thread-1): 17:33:56  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:e07e6f94-8da1-4aa9-8abd-bd1123209382:US&page=queryresults
2022-12-25 17:33:56.918264 (Thread-1): 17:33:56  finished collecting timing info
2022-12-25 17:33:56.918818 (Thread-1): 17:33:56  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '896efbf2-36d2-4753-abf4-492b6c6eb053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d405b9b50>]}
2022-12-25 17:33:56.919164 (Thread-1): 17:33:56  1 of 13 OK created sql view model dbt_ddemo.stg_songplays ...................... [CREATE VIEW (0 processed) in 0.96s]
2022-12-25 17:33:56.919402 (Thread-1): 17:33:56  Finished running node model.spotify.stg_songplays
2022-12-25 17:33:56.920450 (Thread-2): 17:33:56  Began running node model.spotify.fct_songplays
2022-12-25 17:33:56.920700 (Thread-2): 17:33:56  5 of 13 START sql table model dbt_ddemo.fct_songplays .......................... [RUN]
2022-12-25 17:33:56.921084 (Thread-2): 17:33:56  Acquiring new bigquery connection "model.spotify.fct_songplays"
2022-12-25 17:33:56.921189 (Thread-2): 17:33:56  Began compiling node model.spotify.fct_songplays
2022-12-25 17:33:56.921280 (Thread-2): 17:33:56  Compiling model.spotify.fct_songplays
2022-12-25 17:33:56.924190 (Thread-2): 17:33:56  Writing injected SQL for node "model.spotify.fct_songplays"
2022-12-25 17:33:56.927342 (Thread-3): 17:33:56  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:b5f41eea-29ed-4d93-8319-31fb4acc45ff:US&page=queryresults
2022-12-25 17:33:56.928404 (Thread-3): 17:33:56  finished collecting timing info
2022-12-25 17:33:56.928898 (Thread-3): 17:33:56  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '896efbf2-36d2-4753-abf4-492b6c6eb053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d4172e5e0>]}
2022-12-25 17:33:56.929193 (Thread-3): 17:33:56  3 of 13 OK created sql view model dbt_ddemo.stg_top_tracks ..................... [CREATE VIEW (0 processed) in 0.96s]
2022-12-25 17:33:56.929398 (Thread-3): 17:33:56  Finished running node model.spotify.stg_top_tracks
2022-12-25 17:33:56.930092 (Thread-1): 17:33:56  Began running node model.spotify.dim_albums
2022-12-25 17:33:56.930329 (Thread-1): 17:33:56  6 of 13 START sql table model dbt_ddemo.dim_albums ............................. [RUN]
2022-12-25 17:33:56.930679 (Thread-1): 17:33:56  Acquiring new bigquery connection "model.spotify.dim_albums"
2022-12-25 17:33:56.930779 (Thread-1): 17:33:56  Began compiling node model.spotify.dim_albums
2022-12-25 17:33:56.930865 (Thread-1): 17:33:56  Compiling model.spotify.dim_albums
2022-12-25 17:33:56.934584 (Thread-1): 17:33:56  Writing injected SQL for node "model.spotify.dim_albums"
2022-12-25 17:33:56.934857 (Thread-3): 17:33:56  Began running node model.spotify.dim_artists
2022-12-25 17:33:56.935065 (Thread-3): 17:33:56  7 of 13 START sql table model dbt_ddemo.dim_artists ............................ [RUN]
2022-12-25 17:33:56.935415 (Thread-3): 17:33:56  Acquiring new bigquery connection "model.spotify.dim_artists"
2022-12-25 17:33:56.935523 (Thread-3): 17:33:56  Began compiling node model.spotify.dim_artists
2022-12-25 17:33:56.935628 (Thread-3): 17:33:56  Compiling model.spotify.dim_artists
2022-12-25 17:33:56.939027 (Thread-3): 17:33:56  Writing injected SQL for node "model.spotify.dim_artists"
2022-12-25 17:33:56.943232 (Thread-2): 17:33:56  finished collecting timing info
2022-12-25 17:33:56.943383 (Thread-2): 17:33:56  Began executing node model.spotify.fct_songplays
2022-12-25 17:33:56.947650 (Thread-1): 17:33:56  finished collecting timing info
2022-12-25 17:33:56.947801 (Thread-1): 17:33:56  Began executing node model.spotify.dim_albums
2022-12-25 17:33:56.950024 (Thread-1): 17:33:56  Writing runtime sql for node "model.spotify.dim_albums"
2022-12-25 17:33:56.952528 (Thread-2): 17:33:56  Writing runtime sql for node "model.spotify.fct_songplays"
2022-12-25 17:33:56.952787 (Thread-3): 17:33:56  finished collecting timing info
2022-12-25 17:33:56.952930 (Thread-3): 17:33:56  Began executing node model.spotify.dim_artists
2022-12-25 17:33:56.955403 (Thread-3): 17:33:56  Writing runtime sql for node "model.spotify.dim_artists"
2022-12-25 17:33:56.963417 (Thread-1): 17:33:56  Opening a new connection, currently in state closed
2022-12-25 17:33:56.967575 (Thread-2): 17:33:56  Opening a new connection, currently in state closed
2022-12-25 17:33:56.967967 (Thread-1): 17:33:56  On model.spotify.dim_albums: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "user", "target_name": "default", "node_id": "model.spotify.dim_albums"} */

  
    

    create or replace table `dbt-demo-data-372717`.`dbt_ddemo`.`dim_albums`
    
    
    OPTIONS()
    as (
      -- albums table



    select distinct
        album_id,
        album_name,
        album_release_year,
        album_type                                   
    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`
    union

    select distinct
        album_id,
        album_name,
        album_release_year,
        album_type                                   
    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`
    

    );
  
2022-12-25 17:33:56.971239 (Thread-3): 17:33:56  Opening a new connection, currently in state closed
2022-12-25 17:33:56.972956 (Thread-2): 17:33:56  On model.spotify.fct_songplays: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "user", "target_name": "default", "node_id": "model.spotify.fct_songplays"} */

  
    

    create or replace table `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays`
    
    
    OPTIONS()
    as (
      -- songplays table
with source as (
    select
        *
    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`
),
fact_songplays as (
    select
        songplays_id,
        track_id,
        track_played_at,
        album_id,
        artist_id,
        artist_id_others,
        artist_name_others
    from source
)
select
    *
from fact_songplays
    );
  
2022-12-25 17:33:56.975656 (Thread-3): 17:33:56  On model.spotify.dim_artists: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "user", "target_name": "default", "node_id": "model.spotify.dim_artists"} */

  
    

    create or replace table `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists`
    
    
    OPTIONS()
    as (
      -- artists table



    select distinct
        artist_id,
        artist_name,
        artist_popularity,
        artist_followers,
        artist_genre,
        artist_genre_others                                     
    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`
    union

    select distinct
        artist_id,
        artist_name,
        artist_popularity,
        artist_followers,
        artist_genre,
        artist_genre_others                                     
    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_artists`
    union

    select distinct
        artist_id,
        artist_name,
        artist_popularity,
        artist_followers,
        artist_genre,
        artist_genre_others                                     
    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`
    

    );
  
2022-12-25 17:33:57.166255 (Thread-1): 17:33:57  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [23:5]')
2022-12-25 17:33:57.168504 (Thread-3): 17:33:57  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [25:5]')
2022-12-25 17:33:57.447836 (Thread-1): 17:33:57  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:US:74043bee-b2e6-41a5-8be4-5ca1eab90b65&page=queryresults
2022-12-25 17:33:57.448094 (Thread-1): 17:33:57  finished collecting timing info
2022-12-25 17:33:57.448653 (Thread-1): 17:33:57  Database Error in model dim_albums (models/mart/dim_albums.sql)
  Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [23:5]
  compiled Code at target/run/spotify/models/mart/dim_albums.sql
2022-12-25 17:33:57.448883 (Thread-1): 17:33:57  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '896efbf2-36d2-4753-abf4-492b6c6eb053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d4058b790>]}
2022-12-25 17:33:57.449395 (Thread-1): 17:33:57  6 of 13 ERROR creating sql table model dbt_ddemo.dim_albums .................... [ERROR in 0.52s]
2022-12-25 17:33:57.449659 (Thread-1): 17:33:57  Finished running node model.spotify.dim_albums
2022-12-25 17:33:57.449831 (Thread-1): 17:33:57  Began running node model.spotify.dim_tracks
2022-12-25 17:33:57.450024 (Thread-1): 17:33:57  8 of 13 START sql table model dbt_ddemo.dim_tracks ............................. [RUN]
2022-12-25 17:33:57.450434 (Thread-1): 17:33:57  Acquiring new bigquery connection "model.spotify.dim_tracks"
2022-12-25 17:33:57.450538 (Thread-1): 17:33:57  Began compiling node model.spotify.dim_tracks
2022-12-25 17:33:57.451201 (Thread-1): 17:33:57  Compiling model.spotify.dim_tracks
2022-12-25 17:33:57.455147 (Thread-1): 17:33:57  Writing injected SQL for node "model.spotify.dim_tracks"
2022-12-25 17:33:57.466560 (Thread-1): 17:33:57  finished collecting timing info
2022-12-25 17:33:57.466710 (Thread-1): 17:33:57  Began executing node model.spotify.dim_tracks
2022-12-25 17:33:57.469188 (Thread-1): 17:33:57  Writing runtime sql for node "model.spotify.dim_tracks"
2022-12-25 17:33:57.478719 (Thread-1): 17:33:57  Opening a new connection, currently in state closed
2022-12-25 17:33:57.483083 (Thread-1): 17:33:57  On model.spotify.dim_tracks: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "user", "target_name": "default", "node_id": "model.spotify.dim_tracks"} */

  
    

    create or replace table `dbt-demo-data-372717`.`dbt_ddemo`.`dim_tracks`
    
    
    OPTIONS()
    as (
      -- tracks table



    select distinct
        track_id,
        track_name,
        track_duration,
        track_is_explicit,
        track_popularity,
        track_danceability,
        track_energy,
        track_key,
        track_loudness,
        track_mode,
        track_speechiness,
        track_acousticness,
        track_instrumentalness,
        track_liveness,
        track_valence
    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`
    union

    select distinct
        track_id,
        track_name,
        track_duration,
        track_is_explicit,
        track_popularity,
        track_danceability,
        track_energy,
        track_key,
        track_loudness,
        track_mode,
        track_speechiness,
        track_acousticness,
        track_instrumentalness,
        track_liveness,
        track_valence
    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`
    

    );
  
2022-12-25 17:33:57.618669 (Thread-1): 17:33:57  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [34:5]')
2022-12-25 17:33:57.889171 (Thread-45): handling ps request
2022-12-25 17:33:57.889571 (Thread-45): 17:33:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec35083640>]}
2022-12-25 17:33:57.890125 (Thread-45): sending response (<Response 946 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:33:58.158035 (Thread-46): handling status request
2022-12-25 17:33:58.158435 (Thread-46): 17:33:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec350835e0>]}
2022-12-25 17:33:58.159807 (Thread-46): sending response (<Response 33739 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:33:58.160209 (Thread-3): 17:33:58  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:US:7aedb5b8-b0fd-42a8-9246-988f0035afa5&page=queryresults
2022-12-25 17:33:58.160461 (Thread-3): 17:33:58  finished collecting timing info
2022-12-25 17:33:58.161012 (Thread-3): 17:33:58  Database Error in model dim_artists (models/mart/dim_artists.sql)
  Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [25:5]
  compiled Code at target/run/spotify/models/mart/dim_artists.sql
2022-12-25 17:33:58.161209 (Thread-3): 17:33:58  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '896efbf2-36d2-4753-abf4-492b6c6eb053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d4051cc10>]}
2022-12-25 17:33:58.161542 (Thread-3): 17:33:58  7 of 13 ERROR creating sql table model dbt_ddemo.dim_artists ................... [ERROR in 1.23s]
2022-12-25 17:33:58.161800 (Thread-3): 17:33:58  Finished running node model.spotify.dim_artists
2022-12-25 17:33:58.161955 (Thread-3): 17:33:58  Began running node model.spotify.fct_top_tracks
2022-12-25 17:33:58.162149 (Thread-3): 17:33:58  9 of 13 START sql table model dbt_ddemo.fct_top_tracks ......................... [RUN]
2022-12-25 17:33:58.162550 (Thread-3): 17:33:58  Acquiring new bigquery connection "model.spotify.fct_top_tracks"
2022-12-25 17:33:58.162658 (Thread-3): 17:33:58  Began compiling node model.spotify.fct_top_tracks
2022-12-25 17:33:58.162747 (Thread-3): 17:33:58  Compiling model.spotify.fct_top_tracks
2022-12-25 17:33:58.165858 (Thread-3): 17:33:58  Writing injected SQL for node "model.spotify.fct_top_tracks"
2022-12-25 17:33:58.173758 (Thread-47): handling poll request
2022-12-25 17:33:58.174044 (Thread-47): 17:33:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec35083a00>]}
2022-12-25 17:33:58.175207 (Thread-47): sending response (<Response 35546 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:33:58.175324 (Thread-3): 17:33:58  finished collecting timing info
2022-12-25 17:33:58.175491 (Thread-3): 17:33:58  Began executing node model.spotify.fct_top_tracks
2022-12-25 17:33:58.178300 (Thread-3): 17:33:58  Writing runtime sql for node "model.spotify.fct_top_tracks"
2022-12-25 17:33:58.188725 (Thread-3): 17:33:58  Opening a new connection, currently in state closed
2022-12-25 17:33:58.193067 (Thread-3): 17:33:58  On model.spotify.fct_top_tracks: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "user", "target_name": "default", "node_id": "model.spotify.fct_top_tracks"} */

  
    

    create or replace table `dbt-demo-data-372717`.`dbt_ddemo`.`fct_top_tracks`
    
    
    OPTIONS()
    as (
      -- top_tracks table
with source as (
    select
        *
    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`
),
fact_top_tracks as (
    select
        track_rank,
        track_id,
        album_id,
        artist_name_others,
        artist_id,
        artist_id_others
    from source
)
select
    *
from fact_top_tracks
    );
  
2022-12-25 17:33:58.426876 (Thread-1): 17:33:58  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:US:cb0c137e-29ed-4ad2-b0a9-1ffc880b867d&page=queryresults
2022-12-25 17:33:58.427127 (Thread-1): 17:33:58  finished collecting timing info
2022-12-25 17:33:58.427718 (Thread-1): 17:33:58  Database Error in model dim_tracks (models/mart/dim_tracks.sql)
  Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [34:5]
  compiled Code at target/run/spotify/models/mart/dim_tracks.sql
2022-12-25 17:33:58.427923 (Thread-1): 17:33:58  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '896efbf2-36d2-4753-abf4-492b6c6eb053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d404e2e80>]}
2022-12-25 17:33:58.428404 (Thread-1): 17:33:58  8 of 13 ERROR creating sql table model dbt_ddemo.dim_tracks .................... [ERROR in 0.98s]
2022-12-25 17:33:58.428678 (Thread-1): 17:33:58  Finished running node model.spotify.dim_tracks
2022-12-25 17:33:59.042527 (Thread-2): 17:33:59  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:6872056e-d707-4811-bfc1-cbc66276ed26:US&page=queryresults
2022-12-25 17:33:59.043730 (Thread-2): 17:33:59  finished collecting timing info
2022-12-25 17:33:59.044310 (Thread-2): 17:33:59  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '896efbf2-36d2-4753-abf4-492b6c6eb053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d405c8cd0>]}
2022-12-25 17:33:59.044815 (Thread-2): 17:33:59  5 of 13 OK created sql table model dbt_ddemo.fct_songplays ..................... [CREATE TABLE (50.0 rows, 4.5 KB processed) in 2.12s]
2022-12-25 17:33:59.045076 (Thread-2): 17:33:59  Finished running node model.spotify.fct_songplays
2022-12-25 17:33:59.046149 (Thread-1): 17:33:59  Began running node model.spotify.vw_songplays_albums
2022-12-25 17:33:59.046324 (Thread-1): 17:33:59  10 of 13 SKIP relation dbt_ddemo.vw_songplays_albums ........................... [SKIP]
2022-12-25 17:33:59.046521 (Thread-1): 17:33:59  Finished running node model.spotify.vw_songplays_albums
2022-12-25 17:33:59.046650 (Thread-1): 17:33:59  Began running node model.spotify.vw_songplays_genres
2022-12-25 17:33:59.046759 (Thread-1): 17:33:59  11 of 13 SKIP relation dbt_ddemo.vw_songplays_genres ........................... [SKIP]
2022-12-25 17:33:59.046950 (Thread-1): 17:33:59  Finished running node model.spotify.vw_songplays_genres
2022-12-25 17:33:59.368115 (Thread-48): handling poll request
2022-12-25 17:33:59.368563 (Thread-48): 17:33:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34f7c430>]}
2022-12-25 17:33:59.369284 (Thread-48): sending response (<Response 11287 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:33:59.708823 (Thread-4): 17:33:59  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:55935db2-68ec-4c6b-b531-c93b791728aa:US&page=queryresults
2022-12-25 17:33:59.710096 (Thread-4): 17:33:59  finished collecting timing info
2022-12-25 17:33:59.710677 (Thread-4): 17:33:59  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '896efbf2-36d2-4753-abf4-492b6c6eb053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d4062cee0>]}
2022-12-25 17:33:59.711036 (Thread-4): 17:33:59  4 of 13 OK created sql table model dbt_ddemo.fct_top_artists ................... [CREATE TABLE (50.0 rows, 1.6 KB processed) in 2.91s]
2022-12-25 17:33:59.711273 (Thread-4): 17:33:59  Finished running node model.spotify.fct_top_artists
2022-12-25 17:33:59.712073 (Thread-1): 17:33:59  Began running node model.spotify.vw_top_artist_genres
2022-12-25 17:33:59.712262 (Thread-1): 17:33:59  12 of 13 SKIP relation dbt_ddemo.vw_top_artist_genres .......................... [SKIP]
2022-12-25 17:33:59.712451 (Thread-1): 17:33:59  Finished running node model.spotify.vw_top_artist_genres
2022-12-25 17:34:00.108801 (Thread-49): handling ps request
2022-12-25 17:34:00.109208 (Thread-49): 17:34:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34f0e0a0>]}
2022-12-25 17:34:00.109765 (Thread-49): sending response (<Response 946 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:34:00.262915 (Thread-3): 17:34:00  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:ed850b18-639c-4979-a3ab-b94f5f13d0d4:US&page=queryresults
2022-12-25 17:34:00.264135 (Thread-3): 17:34:00  finished collecting timing info
2022-12-25 17:34:00.264847 (Thread-3): 17:34:00  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '896efbf2-36d2-4753-abf4-492b6c6eb053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d404d1940>]}
2022-12-25 17:34:00.265205 (Thread-3): 17:34:00  9 of 13 OK created sql table model dbt_ddemo.fct_top_tracks .................... [CREATE TABLE (50.0 rows, 4.4 KB processed) in 2.10s]
2022-12-25 17:34:00.265442 (Thread-3): 17:34:00  Finished running node model.spotify.fct_top_tracks
2022-12-25 17:34:00.266501 (Thread-4): 17:34:00  Began running node model.spotify.vw_top_track_genres
2022-12-25 17:34:00.266695 (Thread-4): 17:34:00  13 of 13 SKIP relation dbt_ddemo.vw_top_track_genres ........................... [SKIP]
2022-12-25 17:34:00.266885 (Thread-4): 17:34:00  Finished running node model.spotify.vw_top_track_genres
2022-12-25 17:34:00.268322 (MainThread): 17:34:00  Acquiring new bigquery connection "master"
2022-12-25 17:34:00.268827 (MainThread): 17:34:00  
2022-12-25 17:34:00.268928 (MainThread): 17:34:00  Finished running 7 view models, 6 table models in 0 hours 0 minutes and 4.70 seconds (4.70s).
2022-12-25 17:34:00.269010 (MainThread): 17:34:00  Connection 'master' was properly closed.
2022-12-25 17:34:00.269078 (MainThread): 17:34:00  Connection 'model.spotify.dim_tracks' was properly closed.
2022-12-25 17:34:00.269142 (MainThread): 17:34:00  Connection 'model.spotify.fct_songplays' was properly closed.
2022-12-25 17:34:00.269205 (MainThread): 17:34:00  Connection 'model.spotify.fct_top_tracks' was properly closed.
2022-12-25 17:34:00.269268 (MainThread): 17:34:00  Connection 'model.spotify.fct_top_artists' was properly closed.
2022-12-25 17:34:00.290615 (Thread-50): handling status request
2022-12-25 17:34:00.290984 (Thread-50): 17:34:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2d531bb0>]}
2022-12-25 17:34:00.292519 (Thread-50): sending response (<Response 33739 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:34:00.333932 (MainThread): 17:34:00  
2022-12-25 17:34:00.334136 (MainThread): 17:34:00  Completed with 3 errors and 0 warnings:
2022-12-25 17:34:00.334225 (MainThread): 17:34:00  
2022-12-25 17:34:00.334315 (MainThread): 17:34:00  Database Error in model dim_albums (models/mart/dim_albums.sql)
2022-12-25 17:34:00.334392 (MainThread): 17:34:00    Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [23:5]
2022-12-25 17:34:00.334462 (MainThread): 17:34:00    compiled Code at target/run/spotify/models/mart/dim_albums.sql
2022-12-25 17:34:00.334534 (MainThread): 17:34:00  
2022-12-25 17:34:00.334611 (MainThread): 17:34:00  Database Error in model dim_artists (models/mart/dim_artists.sql)
2022-12-25 17:34:00.334680 (MainThread): 17:34:00    Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [25:5]
2022-12-25 17:34:00.334745 (MainThread): 17:34:00    compiled Code at target/run/spotify/models/mart/dim_artists.sql
2022-12-25 17:34:00.334813 (MainThread): 17:34:00  
2022-12-25 17:34:00.334886 (MainThread): 17:34:00  Database Error in model dim_tracks (models/mart/dim_tracks.sql)
2022-12-25 17:34:00.334953 (MainThread): 17:34:00    Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [34:5]
2022-12-25 17:34:00.335017 (MainThread): 17:34:00    compiled Code at target/run/spotify/models/mart/dim_tracks.sql
2022-12-25 17:34:00.335101 (MainThread): 17:34:00  
2022-12-25 17:34:00.335178 (MainThread): 17:34:00  Done. PASS=6 WARN=0 ERROR=3 SKIP=4 TOTAL=13
2022-12-25 17:34:00.568311 (Thread-51): handling poll request
2022-12-25 17:34:00.568723 (Thread-51): 17:34:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2d49bb20>]}
2022-12-25 17:34:00.569679 (Thread-51): sending response (<Response 17766 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:34:01.771003 (Thread-52): handling poll request
2022-12-25 17:34:01.771403 (Thread-52): 17:34:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2d49baf0>]}
2022-12-25 17:34:01.773484 (Thread-52): sending response (<Response 46860 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:34:02.312452 (Thread-53): handling ps request
2022-12-25 17:34:02.312871 (Thread-53): 17:34:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2d49bc40>]}
2022-12-25 17:34:02.313417 (Thread-53): sending response (<Response 970 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:34:02.574765 (Thread-54): handling status request
2022-12-25 17:34:02.575194 (Thread-54): 17:34:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2d49bf70>]}
2022-12-25 17:34:02.576497 (Thread-54): sending response (<Response 33739 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:35:46.476854 (Thread-55): handling status request
2022-12-25 17:35:46.478517 (Thread-55): 17:35:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2d49bcd0>]}
2022-12-25 17:35:46.479811 (Thread-55): sending response (<Response 33739 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:36:05.412104 (Thread-56): handling ps request
2022-12-25 17:36:05.412522 (Thread-56): 17:36:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2d4a1100>]}
2022-12-25 17:36:05.413062 (Thread-56): sending response (<Response 970 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:36:05.519419 (Thread-57): handling status request
2022-12-25 17:36:05.519791 (Thread-57): 17:36:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2d4a13d0>]}
2022-12-25 17:36:05.521039 (Thread-57): sending response (<Response 33722 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:36:05.528506 (Thread-58): handling list request
2022-12-25 17:36:05.528815 (Thread-58): 17:36:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2d47dd00>]}
2022-12-25 17:36:05.537746 (Thread-59): handling ps request
2022-12-25 17:36:05.538114 (Thread-59): 17:36:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2d4a7160>]}
2022-12-25 17:36:05.538755 (Thread-59): sending response (<Response 1242 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:36:05.546037 (Thread-60): handling status request
2022-12-25 17:36:05.546193 (Thread-60): 17:36:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2d4a7ca0>]}
2022-12-25 17:36:05.547350 (Thread-60): sending response (<Response 33739 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:36:05.564194 (Thread-58): 17:36:05  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2d4a1b20>]}
2022-12-25 17:36:05.564462 (Thread-58): 17:36:05  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 17:36:05.564587 (Thread-58): 17:36:05  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec676776a0>]}
2022-12-25 17:36:05.570029 (Thread-58): sending response (<Response 16208 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:36:27.972757 (Thread-61): handling status request
2022-12-25 17:36:27.973241 (Thread-61): 17:36:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2d49bb20>]}
2022-12-25 17:36:27.974608 (Thread-61): sending response (<Response 33722 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:36:27.979282 (Thread-62): handling list request
2022-12-25 17:36:27.979561 (Thread-62): 17:36:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2d4a7b80>]}
2022-12-25 17:36:28.004066 (Thread-62): 17:36:28  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2d4a12b0>]}
2022-12-25 17:36:28.004491 (Thread-62): 17:36:28  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 17:36:28.004752 (Thread-62): 17:36:28  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2d4a1fd0>]}
2022-12-25 17:36:28.010463 (Thread-62): sending response (<Response 26161 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:36:33.770641 (Thread-63): handling run_sql request
2022-12-25 17:36:33.771049 (Thread-63): 17:36:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2d432730>]}
2022-12-25 17:36:33.818673 (Thread-64): handling ps request
2022-12-25 17:36:33.820898 (Thread-65): handling ps request
2022-12-25 17:36:33.823625 (Thread-64): 17:36:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2d439790>]}
2022-12-25 17:36:33.825996 (Thread-64): sending response (<Response 2022 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:36:33.826229 (Thread-65): 17:36:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2d3f3610>]}
2022-12-25 17:36:33.856171 (Thread-65): sending response (<Response 2022 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:36:34.047766 (Thread-66): handling poll request
2022-12-25 17:36:34.048155 (Thread-66): 17:36:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2d439ac0>]}
2022-12-25 17:36:34.048662 (Thread-66): sending response (<Response 376 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:36:34.276722 (Thread-67): handling status request
2022-12-25 17:36:34.277113 (Thread-67): 17:36:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2d439610>]}
2022-12-25 17:36:34.278701 (Thread-67): sending response (<Response 33739 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:36:34.286355 (Thread-68): handling ps request
2022-12-25 17:36:34.286622 (Thread-68): 17:36:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2d3fc4f0>]}
2022-12-25 17:36:34.287119 (Thread-68): sending response (<Response 2022 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:36:36.234099 (Thread-69): handling poll request
2022-12-25 17:36:36.234503 (Thread-69): 17:36:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2d3fc5b0>]}
2022-12-25 17:36:36.234983 (Thread-69): sending response (<Response 377 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:36:36.419783 (Thread-63): sending response (<Response 133 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:36:36.421919 (Thread-70): handling status request
2022-12-25 17:36:36.422315 (Thread-70): 17:36:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec353097f0>]}
2022-12-25 17:36:36.423596 (Thread-70): sending response (<Response 33739 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:36:36.450780 (MainThread): 17:36:36  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40a0e33c-0684-4a29-942a-57fb09b6ec74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc27c553970>]}
2022-12-25 17:36:36.451294 (MainThread): 17:36:36  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 17:36:36.451931 (Thread-1): 17:36:36  Acquiring new bigquery connection "rpc.spotify.request"
2022-12-25 17:36:36.452059 (Thread-1): 17:36:36  Began compiling node rpc.spotify.request
2022-12-25 17:36:36.452156 (Thread-1): 17:36:36  Compiling rpc.spotify.request
2022-12-25 17:36:36.454693 (Thread-1): 17:36:36  finished collecting timing info
2022-12-25 17:36:36.454828 (Thread-1): 17:36:36  Began executing node rpc.spotify.request
2022-12-25 17:36:36.454931 (Thread-1): 17:36:36  Opening a new connection, currently in state init
2022-12-25 17:36:36.459489 (Thread-1): 17:36:36  On rpc.spotify.request: -- stage_songplays
with source as (
    select 
        *
    from `dbt-demo-data-372717`.`dbt_ddemo`.`current_user_recently_played`
),

stage_songplays as (
    select
        songplays_id,
        track_id,
    	track_name,
        track_duration,
        track_is_explicit,
        track_popularity,
        track_played_at,
        album_id,
        album_name,
        album_release_year,
        album_type,
        artist_name,
        artist_name_others,
        artist_id,
        artist_id_others,
        track_danceability,
        track_energy,
        track_key,
        track_loudness,
        track_mode,
        track_speechiness,
        track_acousticness,
        track_instrumentalness,
        track_liveness,
        track_valence,
        artist_popularity,
        artist_followers,
        artist_genre,
        artist_genre_others
    from source
)
select
    *
from stage_songplays
limit 500
/* limit added automatically by dbt cloud */
2022-12-25 17:36:36.602451 (Thread-71): handling ps request
2022-12-25 17:36:36.602884 (Thread-71): 17:36:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2d439910>]}
2022-12-25 17:36:36.603495 (Thread-71): sending response (<Response 2017 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:36:36.609814 (Thread-72): handling ps request
2022-12-25 17:36:36.610082 (Thread-72): 17:36:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2d3fcc10>]}
2022-12-25 17:36:36.610544 (Thread-72): sending response (<Response 2017 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:36:36.836496 (Thread-73): handling status request
2022-12-25 17:36:36.836908 (Thread-73): 17:36:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2d3fcac0>]}
2022-12-25 17:36:36.838241 (Thread-73): sending response (<Response 33739 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:36:36.844522 (Thread-74): handling poll request
2022-12-25 17:36:36.844796 (Thread-74): 17:36:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2d3fc970>]}
2022-12-25 17:36:36.845260 (Thread-74): sending response (<Response 4393 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:36:37.482767 (Thread-1): 17:36:37  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:0063cbdf-9618-45f0-817b-ea941c5211ff:US&page=queryresults
2022-12-25 17:36:37.483104 (Thread-1): 17:36:37  finished collecting timing info
2022-12-25 17:36:38.097774 (Thread-75): handling poll request
2022-12-25 17:36:38.098267 (Thread-75): 17:36:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2d40f280>]}
2022-12-25 17:36:38.100419 (Thread-75): sending response (<Response 25110 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:36:38.436502 (Thread-76): handling poll request
2022-12-25 17:36:38.436900 (Thread-76): 17:36:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2d40fa60>]}
2022-12-25 17:36:38.438823 (Thread-76): sending response (<Response 29133 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:36:38.729668 (Thread-77): handling status request
2022-12-25 17:36:38.730068 (Thread-77): 17:36:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2d40fdf0>]}
2022-12-25 17:36:38.731346 (Thread-77): sending response (<Response 33739 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:36:38.740050 (Thread-78): handling ps request
2022-12-25 17:36:38.740323 (Thread-78): 17:36:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe030f220>]}
2022-12-25 17:36:38.740835 (Thread-78): sending response (<Response 2042 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:36:38.874610 (Thread-79): handling ps request
2022-12-25 17:36:38.875004 (Thread-79): 17:36:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe030f400>]}
2022-12-25 17:36:38.875606 (Thread-79): sending response (<Response 2042 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:36:39.052419 (Thread-80): handling status request
2022-12-25 17:36:39.052819 (Thread-80): 17:36:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe030f760>]}
2022-12-25 17:36:39.054123 (Thread-80): sending response (<Response 33739 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:36:48.665857 (Thread-81): handling status request
2022-12-25 17:36:48.666263 (Thread-81): 17:36:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe030f700>]}
2022-12-25 17:36:48.667512 (Thread-81): sending response (<Response 33722 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:36:48.672191 (Thread-82): handling list request
2022-12-25 17:36:48.672498 (Thread-82): 17:36:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe03c80a0>]}
2022-12-25 17:36:48.704817 (Thread-82): 17:36:48  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe030fdf0>]}
2022-12-25 17:36:48.705434 (Thread-82): 17:36:48  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 17:36:48.705870 (Thread-82): 17:36:48  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2d4a7040>]}
2022-12-25 17:36:48.712298 (Thread-82): sending response (<Response 13535 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:36:48.725543 (Thread-83): handling ps request
2022-12-25 17:36:48.725833 (Thread-83): 17:36:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2d439ca0>]}
2022-12-25 17:36:48.726363 (Thread-83): sending response (<Response 2332 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:36:48.899365 (Thread-84): handling status request
2022-12-25 17:36:48.899750 (Thread-84): 17:36:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2d439460>]}
2022-12-25 17:36:48.901050 (Thread-84): sending response (<Response 33739 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:36:48.915865 (Thread-85): handling poll request
2022-12-25 17:36:48.916137 (Thread-85): 17:36:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2d4393a0>]}
2022-12-25 17:36:48.917084 (Thread-85): sending response (<Response 27304 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:36:49.084638 (Thread-86): handling status request
2022-12-25 17:36:49.085041 (Thread-86): 17:36:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2d439760>]}
2022-12-25 17:36:49.086360 (Thread-86): sending response (<Response 33722 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:36:49.091137 (Thread-87): handling list request
2022-12-25 17:36:49.091417 (Thread-87): 17:36:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2d3fc850>]}
2022-12-25 17:36:49.124128 (Thread-87): 17:36:49  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec350865b0>]}
2022-12-25 17:36:49.124560 (Thread-87): 17:36:49  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 17:36:49.124838 (Thread-87): 17:36:49  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2d4327c0>]}
2022-12-25 17:36:49.128921 (Thread-87): sending response (<Response 13535 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:36:54.147489 (Thread-88): handling status request
2022-12-25 17:36:54.147892 (Thread-88): 17:36:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2d3fcbb0>]}
2022-12-25 17:36:54.149182 (Thread-88): sending response (<Response 33722 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:36:54.153865 (Thread-89): handling list request
2022-12-25 17:36:54.154146 (Thread-89): 17:36:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe06b6670>]}
2022-12-25 17:36:54.183038 (Thread-89): 17:36:54  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe06b6e80>]}
2022-12-25 17:36:54.183526 (Thread-89): 17:36:54  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 17:36:54.183802 (Thread-89): 17:36:54  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe06b6250>]}
2022-12-25 17:36:54.210325 (Thread-89): sending response (<Response 26161 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:00.954027 (Thread-90): handling status request
2022-12-25 17:37:00.954452 (Thread-90): 17:37:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2abb0820>]}
2022-12-25 17:37:00.955818 (Thread-90): sending response (<Response 33722 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:00.960694 (Thread-91): handling list request
2022-12-25 17:37:00.960967 (Thread-91): 17:37:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2abb0af0>]}
2022-12-25 17:37:00.996193 (Thread-91): 17:37:00  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2d3fcb20>]}
2022-12-25 17:37:00.996660 (Thread-91): 17:37:00  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 17:37:00.996936 (Thread-91): 17:37:00  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe06b6580>]}
2022-12-25 17:37:01.001580 (Thread-91): sending response (<Response 13535 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:11.390095 (Thread-92): handling status request
2022-12-25 17:37:11.390522 (Thread-92): 17:37:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2ad5ad30>]}
2022-12-25 17:37:11.391894 (Thread-92): sending response (<Response 33722 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:11.396550 (Thread-93): handling list request
2022-12-25 17:37:11.396815 (Thread-93): 17:37:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2ad5a0d0>]}
2022-12-25 17:37:11.428549 (Thread-93): 17:37:11  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe06b6970>]}
2022-12-25 17:37:11.429007 (Thread-93): 17:37:11  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 17:37:11.429265 (Thread-93): 17:37:11  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2ad5a0a0>]}
2022-12-25 17:37:11.434706 (Thread-93): sending response (<Response 26161 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:12.750064 (Thread-94): handling status request
2022-12-25 17:37:12.750477 (Thread-94): 17:37:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2855d490>]}
2022-12-25 17:37:12.751801 (Thread-94): sending response (<Response 33722 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:12.756529 (Thread-95): handling list request
2022-12-25 17:37:12.756798 (Thread-95): 17:37:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2855d9d0>]}
2022-12-25 17:37:12.786064 (Thread-95): 17:37:12  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2ad5a0d0>]}
2022-12-25 17:37:12.786509 (Thread-95): 17:37:12  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 17:37:12.786768 (Thread-95): 17:37:12  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2855d580>]}
2022-12-25 17:37:12.790744 (Thread-95): sending response (<Response 13535 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:14.531704 (Thread-96): handling ps request
2022-12-25 17:37:14.532102 (Thread-96): 17:37:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec283df7c0>]}
2022-12-25 17:37:14.532815 (Thread-96): sending response (<Response 3790 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:14.547113 (Thread-97): handling status request
2022-12-25 17:37:14.547430 (Thread-97): 17:37:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec283dfd00>]}
2022-12-25 17:37:14.548657 (Thread-97): sending response (<Response 33739 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:14.650980 (Thread-98): handling ps request
2022-12-25 17:37:14.651358 (Thread-98): 17:37:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec14042160>]}
2022-12-25 17:37:14.652063 (Thread-98): sending response (<Response 3790 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:14.843943 (Thread-99): handling poll request
2022-12-25 17:37:14.844349 (Thread-99): 17:37:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec140423d0>]}
2022-12-25 17:37:14.845316 (Thread-99): sending response (<Response 27304 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:14.855994 (Thread-100): handling status request
2022-12-25 17:37:14.856262 (Thread-100): 17:37:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec14042550>]}
2022-12-25 17:37:14.857451 (Thread-100): sending response (<Response 33739 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:15.017436 (Thread-101): handling status request
2022-12-25 17:37:15.017878 (Thread-101): 17:37:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec14042220>]}
2022-12-25 17:37:15.019146 (Thread-101): sending response (<Response 33722 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:15.024064 (Thread-102): handling list request
2022-12-25 17:37:15.024339 (Thread-102): 17:37:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec14042670>]}
2022-12-25 17:37:15.051632 (Thread-102): 17:37:15  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec14042b50>]}
2022-12-25 17:37:15.052107 (Thread-102): 17:37:15  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 17:37:15.052381 (Thread-102): 17:37:15  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2855d4f0>]}
2022-12-25 17:37:15.056453 (Thread-102): sending response (<Response 13538 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:21.162211 (Thread-103): handling status request
2022-12-25 17:37:21.162641 (Thread-103): 17:37:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec14042820>]}
2022-12-25 17:37:21.164004 (Thread-103): sending response (<Response 33722 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:21.169020 (Thread-104): handling list request
2022-12-25 17:37:21.169299 (Thread-104): 17:37:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec141342b0>]}
2022-12-25 17:37:21.201313 (Thread-104): 17:37:21  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec14042700>]}
2022-12-25 17:37:21.201829 (Thread-104): 17:37:21  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 17:37:21.202112 (Thread-104): 17:37:21  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec14042fd0>]}
2022-12-25 17:37:21.208144 (Thread-104): sending response (<Response 26164 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:23.742504 (Thread-105): handling ps request
2022-12-25 17:37:23.742918 (Thread-105): 17:37:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec283df7c0>]}
2022-12-25 17:37:23.743698 (Thread-105): sending response (<Response 4374 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:23.790884 (Thread-106): handling ps request
2022-12-25 17:37:23.791278 (Thread-106): 17:37:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febf4148fa0>]}
2022-12-25 17:37:23.792045 (Thread-106): sending response (<Response 4374 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:23.799320 (Thread-107): handling run_sql request
2022-12-25 17:37:23.799620 (Thread-107): 17:37:23  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febf4148c40>]}
2022-12-25 17:37:26.400592 (Thread-107): sending response (<Response 133 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:26.430903 (MainThread): 17:37:26  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1058bd22-0aae-45ae-8d54-3ae45ea19017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f846428a970>]}
2022-12-25 17:37:26.431422 (MainThread): 17:37:26  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 17:37:26.432017 (Thread-1): 17:37:26  Acquiring new bigquery connection "rpc.spotify.request"
2022-12-25 17:37:26.432161 (Thread-1): 17:37:26  Began compiling node rpc.spotify.request
2022-12-25 17:37:26.432262 (Thread-1): 17:37:26  Compiling rpc.spotify.request
2022-12-25 17:37:26.434851 (Thread-1): 17:37:26  finished collecting timing info
2022-12-25 17:37:26.434990 (Thread-1): 17:37:26  Began executing node rpc.spotify.request
2022-12-25 17:37:26.435101 (Thread-1): 17:37:26  Opening a new connection, currently in state init
2022-12-25 17:37:26.439651 (Thread-1): 17:37:26  On rpc.spotify.request: -- stage_songplays
with source as (
    select 
        *
    from `dbt-demo-data-372717`.`dbt_ddemo`.`current_user_recently_played`
),

stage_songplays as (
    select
        songplays_id,
        track_id,
    	track_name,
        track_duration,
        track_is_explicit,
        track_popularity,
        track_played_at,
        album_id,
        album_name,
        album_release_year,
        album_type,
        artist_name,
        artist_name_others,
        artist_id,
        artist_id_others,
        track_danceability,
        track_energy,
        track_key,
        track_loudness,
        track_mode,
        track_speechiness,
        track_acousticness,
        track_instrumentalness,
        track_liveness,
        track_valence,
        artist_popularity,
        artist_followers,
        artist_genre,
        artist_genre_others
    from source
)
select
    *
from stage_songplays
limit 500
/* limit added automatically by dbt cloud */
2022-12-25 17:37:26.592300 (Thread-108): handling ps request
2022-12-25 17:37:26.592770 (Thread-108): 17:37:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe06fd730>]}
2022-12-25 17:37:26.593972 (Thread-108): sending response (<Response 4837 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:26.708865 (Thread-109): handling ps request
2022-12-25 17:37:26.709258 (Thread-109): 17:37:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe06fd9a0>]}
2022-12-25 17:37:26.731064 (Thread-109): sending response (<Response 4837 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:26.829094 (Thread-110): handling status request
2022-12-25 17:37:26.829503 (Thread-110): 17:37:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe06fdac0>]}
2022-12-25 17:37:26.831053 (Thread-110): sending response (<Response 33739 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:26.846249 (Thread-111): handling poll request
2022-12-25 17:37:26.846526 (Thread-111): 17:37:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe06fd640>]}
2022-12-25 17:37:26.847059 (Thread-111): sending response (<Response 4393 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:26.915102 (Thread-112): handling poll request
2022-12-25 17:37:26.915492 (Thread-112): 17:37:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe06fd850>]}
2022-12-25 17:37:26.916051 (Thread-112): sending response (<Response 4393 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:27.092236 (Thread-113): handling status request
2022-12-25 17:37:27.092643 (Thread-113): 17:37:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe06fd9d0>]}
2022-12-25 17:37:27.093964 (Thread-113): sending response (<Response 33739 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:27.318644 (Thread-1): 17:37:27  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:e00a0963-6b06-4849-82f4-cc623e7fdfe7:US&page=queryresults
2022-12-25 17:37:27.319001 (Thread-1): 17:37:27  finished collecting timing info
2022-12-25 17:37:28.030856 (Thread-114): handling poll request
2022-12-25 17:37:28.031261 (Thread-114): 17:37:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe06c8100>]}
2022-12-25 17:37:28.033199 (Thread-114): sending response (<Response 25110 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:28.775047 (Thread-115): handling ps request
2022-12-25 17:37:28.775458 (Thread-115): 17:37:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe06c8760>]}
2022-12-25 17:37:28.776224 (Thread-115): sending response (<Response 4862 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:28.956439 (Thread-116): handling status request
2022-12-25 17:37:28.956841 (Thread-116): 17:37:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe06c8b80>]}
2022-12-25 17:37:28.958121 (Thread-116): sending response (<Response 33739 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:29.126388 (Thread-117): handling poll request
2022-12-25 17:37:29.126799 (Thread-117): 17:37:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe06c8970>]}
2022-12-25 17:37:29.128641 (Thread-117): sending response (<Response 29133 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:29.375761 (Thread-118): handling status request
2022-12-25 17:37:29.376139 (Thread-118): 17:37:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe0587310>]}
2022-12-25 17:37:29.377335 (Thread-118): sending response (<Response 33739 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:29.392453 (Thread-119): handling ps request
2022-12-25 17:37:29.392712 (Thread-119): 17:37:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe0587220>]}
2022-12-25 17:37:29.393353 (Thread-119): sending response (<Response 4862 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:33.836421 (Thread-120): handling run_sql request
2022-12-25 17:37:33.836822 (Thread-120): 17:37:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe0587640>]}
2022-12-25 17:37:33.852831 (Thread-121): handling ps request
2022-12-25 17:37:33.858535 (Thread-121): 17:37:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe0587fd0>]}
2022-12-25 17:37:33.860718 (Thread-121): sending response (<Response 5318 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:34.039053 (Thread-122): handling poll request
2022-12-25 17:37:34.039454 (Thread-122): 17:37:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe05aa790>]}
2022-12-25 17:37:34.039972 (Thread-122): sending response (<Response 365 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:34.220739 (Thread-123): handling status request
2022-12-25 17:37:34.221136 (Thread-123): 17:37:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe05aa850>]}
2022-12-25 17:37:34.223191 (Thread-123): sending response (<Response 33739 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:34.234078 (Thread-124): handling ps request
2022-12-25 17:37:34.234364 (Thread-124): 17:37:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe06fdc40>]}
2022-12-25 17:37:34.235079 (Thread-124): sending response (<Response 5318 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:36.258759 (Thread-125): handling poll request
2022-12-25 17:37:36.259160 (Thread-125): 17:37:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe06fd7f0>]}
2022-12-25 17:37:36.259663 (Thread-125): sending response (<Response 365 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:36.434879 (Thread-120): sending response (<Response 133 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:36.447216 (Thread-126): handling status request
2022-12-25 17:37:36.447555 (Thread-126): 17:37:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe06fd820>]}
2022-12-25 17:37:36.448770 (Thread-126): sending response (<Response 33739 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:36.467093 (MainThread): 17:37:36  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'daf36858-625b-41de-a02d-098ad2a15a8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45d0312970>]}
2022-12-25 17:37:36.467617 (MainThread): 17:37:36  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 17:37:36.468197 (Thread-1): 17:37:36  Acquiring new bigquery connection "rpc.spotify.request"
2022-12-25 17:37:36.468342 (Thread-1): 17:37:36  Began compiling node rpc.spotify.request
2022-12-25 17:37:36.468454 (Thread-1): 17:37:36  Compiling rpc.spotify.request
2022-12-25 17:37:36.471926 (Thread-1): 17:37:36  finished collecting timing info
2022-12-25 17:37:36.472061 (Thread-1): 17:37:36  Began executing node rpc.spotify.request
2022-12-25 17:37:36.472167 (Thread-1): 17:37:36  Opening a new connection, currently in state init
2022-12-25 17:37:36.476682 (Thread-1): 17:37:36  On rpc.spotify.request: -- albums table



    select distinct
        album_id,
        album_name,
        album_release_year,
        album_type                                   
    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`
    union

    select distinct
        album_id,
        album_name,
        album_release_year,
        album_type                                   
    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`
    

limit 500
/* limit added automatically by dbt cloud */
2022-12-25 17:37:36.682681 (Thread-127): handling ps request
2022-12-25 17:37:36.683080 (Thread-127): 17:37:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe06c8070>]}
2022-12-25 17:37:36.683901 (Thread-127): sending response (<Response 5313 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:36.691272 (Thread-128): handling ps request
2022-12-25 17:37:36.691615 (Thread-128): 17:37:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe06c8850>]}
2022-12-25 17:37:36.692478 (Thread-128): sending response (<Response 5313 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:36.702522 (Thread-1): 17:37:36  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [13:5]')
2022-12-25 17:37:36.915054 (Thread-129): handling status request
2022-12-25 17:37:36.915479 (Thread-129): 17:37:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe06c85b0>]}
2022-12-25 17:37:36.916749 (Thread-129): sending response (<Response 33739 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:36.946707 (Thread-130): handling poll request
2022-12-25 17:37:36.947095 (Thread-130): 17:37:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe06c8460>]}
2022-12-25 17:37:36.947696 (Thread-130): sending response (<Response 4288 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:37.115362 (Thread-1): 17:37:37  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:US:46a5f605-b6a3-4304-857a-f97f03437af9&page=queryresults
2022-12-25 17:37:37.115579 (Thread-1): 17:37:37  finished collecting timing info
2022-12-25 17:37:37.115720 (Thread-1): Got an exception: Database Error
  Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [13:5]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 207, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 646, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 429, in fn
    return self._query_and_results(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 631, in _query_and_results
    iterator = query_job.result(timeout=job_execution_timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1303, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 679, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [13:5]

(job ID: 46a5f605-b6a3-4304-857a-f97f03437af9)

                 -----Query Job SQL Follows-----                 

    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:-- albums table
   2:
   3:
   4:
   5:    select distinct
   6:        album_id,
   7:        album_name,
   8:        album_release_year,
   9:        album_type                                   
  10:    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`
  11:    union
  12:
  13:    select distinct
  14:        album_id,
  15:        album_name,
  16:        album_release_year,
  17:        album_type                                   
  18:    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`
  19:    
  20:
  21:limit 500
  22:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 385, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 338, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 429, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 108, in execute
    _, execute_result = self.adapter.execute(compiled_sql, fetch=True)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 278, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 446, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 437, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 646, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 211, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 199, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [13:5]
2022-12-25 17:37:37.117758 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system.sql)\n  Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [13:5]', 'raw_code': "-- albums table\r\n{% set tables = ['stg_songplays', 'stg_top_tracks'] %}\r\n\r\n{% for table in tables %}\r\n    select distinct\r\n        album_id,\r\n        album_name,\r\n        album_release_year,\r\n        album_type                                   \r\n    from {{ ref(table) }}\r\n    {% if not loop.last -%} union {%- endif %}\r\n{% endfor %}\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_code': '-- albums table\n\n\n\n    select distinct\n        album_id,\n        album_name,\n        album_release_year,\n        album_type                                   \n    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`\n    union\n\n    select distinct\n        album_id,\n        album_name,\n        album_release_year,\n        album_type                                   \n    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`\n    \n\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 148, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 68, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system.sql)\n  Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [13:5]', 'raw_code': "-- albums table\r\n{% set tables = ['stg_songplays', 'stg_top_tracks'] %}\r\n\r\n{% for table in tables %}\r\n    select distinct\r\n        album_id,\r\n        album_name,\r\n        album_release_year,\r\n        album_type                                   \r\n    from {{ ref(table) }}\r\n    {% if not loop.last -%} union {%- endif %}\r\n{% endfor %}\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_code': '-- albums table\n\n\n\n    select distinct\n        album_id,\n        album_name,\n        album_release_year,\n        album_type                                   \n    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`\n    union\n\n    select distinct\n        album_id,\n        album_name,\n        album_release_year,\n        album_type                                   \n    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`\n    \n\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2022-12-25 17:37:38.137945 (Thread-131): handling poll request
2022-12-25 17:37:38.138341 (Thread-131): 17:37:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe05aa070>]}
2022-12-25 17:37:38.138932 (Thread-131): sending response (<Response 13858 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:38.467173 (Thread-132): handling poll request
2022-12-25 17:37:38.467583 (Thread-132): 17:37:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe05aa8b0>]}
2022-12-25 17:37:38.468198 (Thread-132): sending response (<Response 13858 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:38.645514 (Thread-133): handling status request
2022-12-25 17:37:38.645881 (Thread-133): 17:37:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe05aab20>]}
2022-12-25 17:37:38.647158 (Thread-133): sending response (<Response 33739 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:38.876649 (Thread-134): handling ps request
2022-12-25 17:37:38.877013 (Thread-134): 17:37:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe05aaca0>]}
2022-12-25 17:37:38.877816 (Thread-134): sending response (<Response 5336 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:37:39.057443 (Thread-135): handling status request
2022-12-25 17:37:39.057813 (Thread-135): 17:37:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe05aaee0>]}
2022-12-25 17:37:39.059041 (Thread-135): sending response (<Response 33739 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:38:39.693215 (Thread-136): handling ps request
2022-12-25 17:38:39.693651 (Thread-136): 17:38:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe05aad60>]}
2022-12-25 17:38:39.694448 (Thread-136): sending response (<Response 5336 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:38:39.696142 (Thread-137): handling run_sql request
2022-12-25 17:38:39.696418 (Thread-137): 17:38:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe05201f0>]}
2022-12-25 17:38:42.307385 (Thread-137): sending response (<Response 133 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:38:42.340285 (MainThread): 17:38:42  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc9544f0-030b-4b97-92bb-f6ce8688ef96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f99e01098b0>]}
2022-12-25 17:38:42.340829 (MainThread): 17:38:42  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 17:38:42.341435 (Thread-1): 17:38:42  Acquiring new bigquery connection "rpc.spotify.request"
2022-12-25 17:38:42.341577 (Thread-1): 17:38:42  Began compiling node rpc.spotify.request
2022-12-25 17:38:42.341706 (Thread-1): 17:38:42  Compiling rpc.spotify.request
2022-12-25 17:38:42.345271 (Thread-1): 17:38:42  finished collecting timing info
2022-12-25 17:38:42.345412 (Thread-1): 17:38:42  Began executing node rpc.spotify.request
2022-12-25 17:38:42.345522 (Thread-1): 17:38:42  Opening a new connection, currently in state init
2022-12-25 17:38:42.350180 (Thread-1): 17:38:42  On rpc.spotify.request: -- tracks table



    select distinct
        track_id,
        track_name,
        track_duration,
        track_is_explicit,
        track_popularity,
        track_danceability,
        track_energy,
        track_key,
        track_loudness,
        track_mode,
        track_speechiness,
        track_acousticness,
        track_instrumentalness,
        track_liveness,
        track_valence
    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`
    union

    select distinct
        track_id,
        track_name,
        track_duration,
        track_is_explicit,
        track_popularity,
        track_danceability,
        track_energy,
        track_key,
        track_loudness,
        track_mode,
        track_speechiness,
        track_acousticness,
        track_instrumentalness,
        track_liveness,
        track_valence
    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`
    

limit 500
/* limit added automatically by dbt cloud */
2022-12-25 17:38:42.549979 (Thread-138): handling ps request
2022-12-25 17:38:42.550454 (Thread-138): 17:38:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe0520fd0>]}
2022-12-25 17:38:42.551693 (Thread-138): sending response (<Response 5787 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:38:42.556996 (Thread-139): handling ps request
2022-12-25 17:38:42.557266 (Thread-139): 17:38:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe050b280>]}
2022-12-25 17:38:42.568063 (Thread-1): 17:38:42  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [24:5]')
2022-12-25 17:38:42.586101 (Thread-139): sending response (<Response 5787 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:38:42.756749 (Thread-1): 17:38:42  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:US:735003ad-4c1b-4f9b-8881-03cebc365c80&page=queryresults
2022-12-25 17:38:42.756959 (Thread-1): 17:38:42  finished collecting timing info
2022-12-25 17:38:42.757091 (Thread-1): Got an exception: Database Error
  Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [24:5]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 207, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 646, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 429, in fn
    return self._query_and_results(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 631, in _query_and_results
    iterator = query_job.result(timeout=job_execution_timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1303, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 679, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [24:5]

(job ID: 735003ad-4c1b-4f9b-8881-03cebc365c80)

                 -----Query Job SQL Follows-----                 

    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:-- tracks table
   2:
   3:
   4:
   5:    select distinct
   6:        track_id,
   7:        track_name,
   8:        track_duration,
   9:        track_is_explicit,
  10:        track_popularity,
  11:        track_danceability,
  12:        track_energy,
  13:        track_key,
  14:        track_loudness,
  15:        track_mode,
  16:        track_speechiness,
  17:        track_acousticness,
  18:        track_instrumentalness,
  19:        track_liveness,
  20:        track_valence
  21:    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`
  22:    union
  23:
  24:    select distinct
  25:        track_id,
  26:        track_name,
  27:        track_duration,
  28:        track_is_explicit,
  29:        track_popularity,
  30:        track_danceability,
  31:        track_energy,
  32:        track_key,
  33:        track_loudness,
  34:        track_mode,
  35:        track_speechiness,
  36:        track_acousticness,
  37:        track_instrumentalness,
  38:        track_liveness,
  39:        track_valence
  40:    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`
  41:    
  42:
  43:limit 500
  44:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 385, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 338, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 429, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 108, in execute
    _, execute_result = self.adapter.execute(compiled_sql, fetch=True)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 278, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 446, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 437, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 646, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 211, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 199, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [24:5]
2022-12-25 17:38:42.759123 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system.sql)\n  Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [24:5]', 'raw_code': "-- tracks table\r\n{% set tables = ['stg_songplays', 'stg_top_tracks'] %}\r\n\r\n{% for table in tables %}\r\n    select distinct\r\n        track_id,\r\n        track_name,\r\n        track_duration,\r\n        track_is_explicit,\r\n        track_popularity,\r\n        track_danceability,\r\n        track_energy,\r\n        track_key,\r\n        track_loudness,\r\n        track_mode,\r\n        track_speechiness,\r\n        track_acousticness,\r\n        track_instrumentalness,\r\n        track_liveness,\r\n        track_valence\r\n    from {{ ref(table) }}\r\n    {% if not loop.last -%} union {%- endif %}\r\n{% endfor %}\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_code': '-- tracks table\n\n\n\n    select distinct\n        track_id,\n        track_name,\n        track_duration,\n        track_is_explicit,\n        track_popularity,\n        track_danceability,\n        track_energy,\n        track_key,\n        track_loudness,\n        track_mode,\n        track_speechiness,\n        track_acousticness,\n        track_instrumentalness,\n        track_liveness,\n        track_valence\n    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`\n    union\n\n    select distinct\n        track_id,\n        track_name,\n        track_duration,\n        track_is_explicit,\n        track_popularity,\n        track_danceability,\n        track_energy,\n        track_key,\n        track_loudness,\n        track_mode,\n        track_speechiness,\n        track_acousticness,\n        track_instrumentalness,\n        track_liveness,\n        track_valence\n    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`\n    \n\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 148, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 68, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system.sql)\n  Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [24:5]', 'raw_code': "-- tracks table\r\n{% set tables = ['stg_songplays', 'stg_top_tracks'] %}\r\n\r\n{% for table in tables %}\r\n    select distinct\r\n        track_id,\r\n        track_name,\r\n        track_duration,\r\n        track_is_explicit,\r\n        track_popularity,\r\n        track_danceability,\r\n        track_energy,\r\n        track_key,\r\n        track_loudness,\r\n        track_mode,\r\n        track_speechiness,\r\n        track_acousticness,\r\n        track_instrumentalness,\r\n        track_liveness,\r\n        track_valence\r\n    from {{ ref(table) }}\r\n    {% if not loop.last -%} union {%- endif %}\r\n{% endfor %}\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_code': '-- tracks table\n\n\n\n    select distinct\n        track_id,\n        track_name,\n        track_duration,\n        track_is_explicit,\n        track_popularity,\n        track_danceability,\n        track_energy,\n        track_key,\n        track_loudness,\n        track_mode,\n        track_speechiness,\n        track_acousticness,\n        track_instrumentalness,\n        track_liveness,\n        track_valence\n    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`\n    union\n\n    select distinct\n        track_id,\n        track_name,\n        track_duration,\n        track_is_explicit,\n        track_popularity,\n        track_danceability,\n        track_energy,\n        track_key,\n        track_loudness,\n        track_mode,\n        track_speechiness,\n        track_acousticness,\n        track_instrumentalness,\n        track_liveness,\n        track_valence\n    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`\n    \n\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2022-12-25 17:38:42.773607 (Thread-140): handling status request
2022-12-25 17:38:42.773984 (Thread-140): 17:38:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe050b400>]}
2022-12-25 17:38:42.775563 (Thread-140): sending response (<Response 33739 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:38:42.780736 (Thread-141): handling poll request
2022-12-25 17:38:42.781027 (Thread-141): 17:38:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe050bd00>]}
2022-12-25 17:38:42.781713 (Thread-141): sending response (<Response 15726 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:38:42.846433 (Thread-142): handling poll request
2022-12-25 17:38:42.846827 (Thread-142): 17:38:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe050b730>]}
2022-12-25 17:38:42.847508 (Thread-142): sending response (<Response 15726 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:38:43.029846 (Thread-143): handling status request
2022-12-25 17:38:43.030235 (Thread-143): 17:38:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe0520ac0>]}
2022-12-25 17:38:43.031504 (Thread-143): sending response (<Response 33739 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:38:43.978456 (Thread-144): handling poll request
2022-12-25 17:38:43.978861 (Thread-144): 17:38:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe0520b80>]}
2022-12-25 17:38:43.979465 (Thread-144): sending response (<Response 17398 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:38:44.740234 (Thread-145): handling ps request
2022-12-25 17:38:44.740643 (Thread-145): 17:38:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe0520580>]}
2022-12-25 17:38:44.741471 (Thread-145): sending response (<Response 5810 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:38:44.931615 (Thread-146): handling status request
2022-12-25 17:38:44.932010 (Thread-146): 17:38:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe05aaa90>]}
2022-12-25 17:38:44.933240 (Thread-146): sending response (<Response 33739 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:38:45.044247 (Thread-147): handling poll request
2022-12-25 17:38:45.044624 (Thread-147): 17:38:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe05aa520>]}
2022-12-25 17:38:45.045204 (Thread-147): sending response (<Response 17398 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:38:45.232485 (Thread-148): handling status request
2022-12-25 17:38:45.232870 (Thread-148): 17:38:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe06c8dc0>]}
2022-12-25 17:38:45.234122 (Thread-148): sending response (<Response 33739 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:40:46.165385 (Thread-149): handling status request
2022-12-25 17:40:46.167065 (Thread-149): 17:40:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe06c88b0>]}
2022-12-25 17:40:46.168333 (Thread-149): sending response (<Response 33739 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:40:58.168902 (Thread-150): handling ps request
2022-12-25 17:40:58.169307 (Thread-150): 17:40:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe06fd130>]}
2022-12-25 17:40:58.170151 (Thread-150): sending response (<Response 5817 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:40:58.175431 (Thread-151): handling status request
2022-12-25 17:40:58.175754 (Thread-151): 17:40:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe050b970>]}
2022-12-25 17:40:58.176883 (Thread-151): sending response (<Response 33746 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:40:58.288538 (Thread-152): handling status request
2022-12-25 17:40:58.288935 (Thread-152): 17:40:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe06fdb80>]}
2022-12-25 17:40:58.290179 (Thread-152): sending response (<Response 33746 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:40:58.307640 (Thread-153): handling status request
2022-12-25 17:40:58.307931 (Thread-153): 17:40:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe06fd6a0>]}
2022-12-25 17:40:58.309025 (Thread-153): sending response (<Response 33746 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:40:58.730348 (Thread-154): handling poll request
2022-12-25 17:40:58.730757 (Thread-154): 17:40:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe04d3340>]}
2022-12-25 17:40:58.735507 (Thread-154): sending response (<Response 139085 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:40:59.511477 (Thread-155): handling status request
2022-12-25 17:40:59.511885 (Thread-155): 17:40:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe0520e20>]}
2022-12-25 17:40:59.513132 (Thread-155): sending response (<Response 33746 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:40:59.629764 (Thread-156): handling status request
2022-12-25 17:40:59.630301 (Thread-156): 17:40:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe050b970>]}
2022-12-25 17:40:59.631586 (Thread-156): sending response (<Response 33746 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:40:59.668868 (Thread-157): handling status request
2022-12-25 17:40:59.669173 (Thread-157): 17:40:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe050bcd0>]}
2022-12-25 17:40:59.670348 (Thread-157): sending response (<Response 33746 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:41:14.488047 (Thread-158): handling status request
2022-12-25 17:41:14.488483 (Thread-158): 17:41:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe050b490>]}
2022-12-25 17:41:14.489811 (Thread-158): sending response (<Response 33722 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:41:14.494676 (Thread-159): handling list request
2022-12-25 17:41:14.494954 (Thread-159): 17:41:14  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe050bdf0>]}
2022-12-25 17:41:14.527554 (Thread-159): 17:41:14  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe050be50>]}
2022-12-25 17:41:14.528067 (Thread-159): 17:41:14  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 17:41:14.528379 (Thread-159): 17:41:14  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec14134ca0>]}
2022-12-25 17:41:14.532901 (Thread-159): sending response (<Response 13538 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:42:56.122302 (Thread-160): handling status request
2022-12-25 17:42:56.123866 (Thread-160): 17:42:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe04d3700>]}
2022-12-25 17:42:56.125116 (Thread-160): sending response (<Response 33746 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:42:56.303031 (Thread-161): handling run_sql request
2022-12-25 17:42:56.303387 (Thread-161): 17:42:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe04d3850>]}
2022-12-25 17:42:58.894367 (Thread-161): sending response (<Response 140 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:42:58.927660 (MainThread): 17:42:58  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5817ea5c-1551-4563-8fc3-6fdbd62652c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e24673f10>]}
2022-12-25 17:42:58.928174 (MainThread): 17:42:58  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 319 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 17:42:58.928749 (Thread-1): 17:42:58  Acquiring new bigquery connection "rpc.spotify.request"
2022-12-25 17:42:58.928897 (Thread-1): 17:42:58  Began compiling node rpc.spotify.request
2022-12-25 17:42:58.928993 (Thread-1): 17:42:58  Compiling rpc.spotify.request
2022-12-25 17:42:58.934024 (Thread-1): 17:42:58  finished collecting timing info
2022-12-25 17:42:58.934174 (Thread-1): Got an exception: Compilation Error in rpc request (from remote system.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 510, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 542, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 1301, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 936, in handle_exception
    raise rewrite_traceback_stack(source=source)
  File "<template>", line 15, in top-level template code
  File "/usr/local/lib/python3.8/dist-packages/jinja2/sandbox.py", line 326, in getattr
    value = getattr(obj, attribute)
jinja2.exceptions.UndefinedError: 'dbt_utils' is undefined

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 385, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 325, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 57, in compile
    return compiler.compile_node(self.node, manifest, {}, write=False)
  File "/usr/local/lib/python3.8/dist-packages/dbt/compilation.py", line 535, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/lib/python3.8/dist-packages/dbt/compilation.py", line 394, in _compile_node
    compiled_node.compiled_code = jinja.get_rendered(
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 587, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 542, in render_template
    return template.render(ctx)
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 515, in catch_jinja
    raise UndefinedMacroException(str(e), node) from e
dbt.exceptions.UndefinedMacroException: Compilation Error in rpc request (from remote system.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
2022-12-25 17:42:58.935594 (Thread-1): Got exception RPCException(10004, Compilation Error, {'type': 'UndefinedMacroException', 'message': 'Compilation Error in rpc request (from remote system.sql)\n  \'dbt_utils\' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".', 'raw_code': '-- albums table\n-- {% set tables = [\'stg_songplays\', \'stg_top_tracks\'] %}\n\n-- {% for table in tables %}\n--     select distinct\n--         album_id,\n--         album_name,\n--         album_release_year,\n--         album_type                                   \n--     from {{ ref(table) }}\n--     {% if not loop.last -%} union {%- endif %}\n-- {% endfor %}\n\nselect * from \n{{ dbt_utils.union_relations(\n    relations=[ref(\'stg_songplays\'), ref(\'stg_top_tracks\')],\n    exclude=["album_id","album_name","album_release_year","album_type"]\n) }}\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_code': None, 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 148, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 68, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10004, Compilation Error, {'type': 'UndefinedMacroException', 'message': 'Compilation Error in rpc request (from remote system.sql)\n  \'dbt_utils\' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".', 'raw_code': '-- albums table\n-- {% set tables = [\'stg_songplays\', \'stg_top_tracks\'] %}\n\n-- {% for table in tables %}\n--     select distinct\n--         album_id,\n--         album_name,\n--         album_release_year,\n--         album_type                                   \n--     from {{ ref(table) }}\n--     {% if not loop.last -%} union {%- endif %}\n-- {% endfor %}\n\nselect * from \n{{ dbt_utils.union_relations(\n    relations=[ref(\'stg_songplays\'), ref(\'stg_top_tracks\')],\n    exclude=["album_id","album_name","album_release_year","album_type"]\n) }}\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_code': None, 'tags': None}, None)
2022-12-25 17:42:59.168908 (Thread-162): handling poll request
2022-12-25 17:42:59.169351 (Thread-162): 17:42:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe045ab20>]}
2022-12-25 17:42:59.170150 (Thread-162): sending response (<Response 9100 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:43:06.944574 (Thread-163): handling status request
2022-12-25 17:43:06.944986 (Thread-163): 17:43:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe045af10>]}
2022-12-25 17:43:06.946647 (Thread-163): sending response (<Response 33746 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:43:07.170130 (Thread-164): handling deps request
2022-12-25 17:43:07.170545 (Thread-164): 17:43:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe046d0a0>]}
2022-12-25 17:43:07.211416 (Thread-165): handling status request
2022-12-25 17:43:07.212629 (Thread-164): sending response (<Response 140 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:43:07.215398 (Thread-165): 17:43:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34fa1d60>]}
2022-12-25 17:43:07.217134 (Thread-165): sending response (<Response 187 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:43:07.395990 (Thread-166): handling poll request
2022-12-25 17:43:07.396375 (Thread-166): 17:43:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34fa1670>]}
2022-12-25 17:43:07.396907 (Thread-166): sending response (<Response 289 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:43:08.434141 (Thread-167): handling status request
2022-12-25 17:43:08.434562 (Thread-167): 17:43:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34fa1670>]}
2022-12-25 17:43:08.461312 (Thread-167): sending response (<Response 187 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:43:08.580348 (Thread-168): handling poll request
2022-12-25 17:43:08.580687 (Thread-168): 17:43:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34faed60>]}
2022-12-25 17:43:08.581125 (Thread-168): sending response (<Response 289 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:43:09.710111 (Thread-169): handling status request
2022-12-25 17:43:09.710511 (Thread-169): 17:43:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34f88ac0>]}
2022-12-25 17:43:09.710929 (Thread-169): sending response (<Response 187 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:43:09.788570 (Thread-170): handling poll request
2022-12-25 17:43:09.788909 (Thread-170): 17:43:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34f885e0>]}
2022-12-25 17:43:09.789351 (Thread-170): sending response (<Response 289 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:43:09.791401 (MainThread): 17:43:09  Warning: No packages were found in packages.yml
2022-12-25 17:43:10.019955 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Unable to do partial parsing because config vars, config profile, or config target have changed
2022-12-25 17:43:10.020322 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34f1ae80>]}
2022-12-25 17:43:10.240070 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/etc.sql
2022-12-25 17:43:10.242170 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/catalog.sql
2022-12-25 17:43:10.247784 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/adapters.sql
2022-12-25 17:43:10.267460 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/adapters/apply_grants.sql
2022-12-25 17:43:10.269891 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/materializations/seed.sql
2022-12-25 17:43:10.272215 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/materializations/incremental.sql
2022-12-25 17:43:10.288713 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/materializations/snapshot.sql
2022-12-25 17:43:10.290389 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/materializations/table.sql
2022-12-25 17:43:10.297048 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/materializations/copy.sql
2022-12-25 17:43:10.299634 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/materializations/view.sql
2022-12-25 17:43:10.302265 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/utils/intersect.sql
2022-12-25 17:43:10.302675 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/utils/position.sql
2022-12-25 17:43:10.303221 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/utils/escape_single_quotes.sql
2022-12-25 17:43:10.303805 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/utils/safe_cast.sql
2022-12-25 17:43:10.304337 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/utils/array_construct.sql
2022-12-25 17:43:10.305151 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/utils/datediff.sql
2022-12-25 17:43:10.306346 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/utils/timestamps.sql
2022-12-25 17:43:10.307447 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/utils/array_concat.sql
2022-12-25 17:43:10.307991 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/utils/right.sql
2022-12-25 17:43:10.308625 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/utils/array_append.sql
2022-12-25 17:43:10.309233 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/utils/split_part.sql
2022-12-25 17:43:10.310650 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/utils/date_trunc.sql
2022-12-25 17:43:10.311211 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/utils/hash.sql
2022-12-25 17:43:10.311758 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/utils/except.sql
2022-12-25 17:43:10.312155 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/utils/bool_or.sql
2022-12-25 17:43:10.312617 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/utils/dateadd.sql
2022-12-25 17:43:10.313243 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/utils/listagg.sql
2022-12-25 17:43:10.314245 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/etc/statement.sql
2022-12-25 17:43:10.319057 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/etc/datetime.sql
2022-12-25 17:43:10.326791 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/adapters/apply_grants.sql
2022-12-25 17:43:10.339537 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/adapters/freshness.sql
2022-12-25 17:43:10.341391 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/adapters/columns.sql
2022-12-25 17:43:10.350313 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/adapters/timestamps.sql
2022-12-25 17:43:10.353519 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/adapters/relation.sql
2022-12-25 17:43:10.367045 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/adapters/schema.sql
2022-12-25 17:43:10.369117 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/adapters/persist_docs.sql
2022-12-25 17:43:10.373364 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/adapters/metadata.sql
2022-12-25 17:43:10.379996 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/adapters/indexes.sql
2022-12-25 17:43:10.382548 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/get_custom_name/get_custom_database.sql
2022-12-25 17:43:10.384047 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/get_custom_name/get_custom_schema.sql
2022-12-25 17:43:10.386364 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/get_custom_name/get_custom_alias.sql
2022-12-25 17:43:10.388183 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/python_model/python.sql
2022-12-25 17:43:10.393804 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/materializations/hooks.sql
2022-12-25 17:43:10.397405 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/materializations/configs.sql
2022-12-25 17:43:10.399638 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/materializations/seeds/seed.sql
2022-12-25 17:43:10.405927 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/materializations/seeds/helpers.sql
2022-12-25 17:43:10.423541 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/materializations/tests/test.sql
2022-12-25 17:43:10.427685 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/materializations/tests/helpers.sql
2022-12-25 17:43:10.429333 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/materializations/tests/where_subquery.sql
2022-12-25 17:43:10.431069 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/materializations/models/view/helpers.sql
2022-12-25 17:43:10.432328 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/materializations/models/view/create_or_replace_view.sql
2022-12-25 17:43:10.435430 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/materializations/models/view/create_view_as.sql
2022-12-25 17:43:10.437639 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/materializations/models/view/view.sql
2022-12-25 17:43:10.442766 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/materializations/models/incremental/strategies.sql
2022-12-25 17:43:10.449256 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/materializations/models/incremental/column_helpers.sql
2022-12-25 17:43:10.456614 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/materializations/models/incremental/incremental.sql
2022-12-25 17:43:10.466020 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/materializations/models/incremental/on_schema_change.sql
2022-12-25 17:43:10.480999 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/materializations/models/incremental/is_incremental.sql
2022-12-25 17:43:10.482422 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/materializations/models/incremental/merge.sql
2022-12-25 17:43:10.496144 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/materializations/models/table/create_table_as.sql
2022-12-25 17:43:10.499451 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/materializations/models/table/table.sql
2022-12-25 17:43:10.504532 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/materializations/snapshots/strategies.sql
2022-12-25 17:43:10.519252 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/materializations/snapshots/snapshot_merge.sql
2022-12-25 17:43:10.520806 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/materializations/snapshots/snapshot.sql
2022-12-25 17:43:10.531294 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/materializations/snapshots/helpers.sql
2022-12-25 17:43:10.542968 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/generic_test_sql/not_null.sql
2022-12-25 17:43:10.543837 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/generic_test_sql/relationships.sql
2022-12-25 17:43:10.544673 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/generic_test_sql/unique.sql
2022-12-25 17:43:10.545336 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/generic_test_sql/accepted_values.sql
2022-12-25 17:43:10.546663 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/utils/intersect.sql
2022-12-25 17:43:10.547532 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/utils/position.sql
2022-12-25 17:43:10.548590 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/utils/escape_single_quotes.sql
2022-12-25 17:43:10.549598 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/utils/safe_cast.sql
2022-12-25 17:43:10.550857 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/utils/array_construct.sql
2022-12-25 17:43:10.552353 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/utils/cast_bool_to_text.sql
2022-12-25 17:43:10.553384 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/utils/datediff.sql
2022-12-25 17:43:10.554615 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/utils/concat.sql
2022-12-25 17:43:10.555590 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/utils/length.sql
2022-12-25 17:43:10.556522 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/utils/any_value.sql
2022-12-25 17:43:10.557462 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/utils/data_types.sql
2022-12-25 17:43:10.564339 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/utils/array_concat.sql
2022-12-25 17:43:10.565381 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/utils/right.sql
2022-12-25 17:43:10.566479 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/utils/array_append.sql
2022-12-25 17:43:10.567557 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/utils/last_day.sql
2022-12-25 17:43:10.569315 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/utils/split_part.sql
2022-12-25 17:43:10.571260 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/utils/date_trunc.sql
2022-12-25 17:43:10.572304 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/utils/literal.sql
2022-12-25 17:43:10.573218 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/utils/hash.sql
2022-12-25 17:43:10.574288 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/utils/except.sql
2022-12-25 17:43:10.575258 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/utils/bool_or.sql
2022-12-25 17:43:10.576193 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/utils/replace.sql
2022-12-25 17:43:10.577398 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/utils/dateadd.sql
2022-12-25 17:43:10.578667 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing macros/utils/listagg.sql
2022-12-25 17:43:10.580825 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  Parsing tests/generic/builtin.sql
2022-12-25 17:43:10.833847 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  1699: static parser successfully parsed mart/fct_top_tracks.sql
2022-12-25 17:43:10.836695 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  1699: static parser successfully parsed mart/fct_songplays.sql
2022-12-25 17:43:10.839418 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  1699: static parser successfully parsed mart/fct_top_artists.sql
2022-12-25 17:43:10.841981 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  1603: static parser failed on mart/dim_artists.sql
2022-12-25 17:43:10.847116 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  1602: parser fallback to jinja rendering on mart/dim_artists.sql
2022-12-25 17:43:10.848403 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  1603: static parser failed on mart/dim_albums.sql
2022-12-25 17:43:10.852936 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  1602: parser fallback to jinja rendering on mart/dim_albums.sql
2022-12-25 17:43:10.854239 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  1603: static parser failed on mart/dim_tracks.sql
2022-12-25 17:43:10.859185 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  1602: parser fallback to jinja rendering on mart/dim_tracks.sql
2022-12-25 17:43:10.860509 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  1699: static parser successfully parsed staging/stg_top_tracks.sql
2022-12-25 17:43:10.863314 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  1699: static parser successfully parsed staging/stg_songplays.sql
2022-12-25 17:43:10.865919 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  1699: static parser successfully parsed staging/stg_top_artists.sql
2022-12-25 17:43:10.868754 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  1699: static parser successfully parsed view/vw_top_track_genres.sql
2022-12-25 17:43:10.871663 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  1699: static parser successfully parsed view/vw_top_artist_genres.sql
2022-12-25 17:43:10.874684 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  1699: static parser successfully parsed view/vw_songplays_genres.sql
2022-12-25 17:43:10.877671 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:10  1699: static parser successfully parsed view/vw_songplays_albums.sql
2022-12-25 17:43:10.989386 (Thread-171): handling status request
2022-12-25 17:43:11.010114 (Thread-171): 17:43:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec14053e20>]}
2022-12-25 17:43:11.015687 (Thread-171): sending response (<Response 187 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:43:11.026559 (Thread-172): handling poll request
2022-12-25 17:43:11.047761 (Thread-172): 17:43:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec283f43d0>]}
2022-12-25 17:43:11.053354 (Thread-172): sending response (<Response 587 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:43:11.100006 (39a4eab2-a55f-4f30-8649-26c83d228f4e-handler-deps): 17:43:11  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34ca3df0>]}
2022-12-25 17:43:12.267968 (Thread-173): handling status request
2022-12-25 17:43:12.268382 (Thread-173): 17:43:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec35006100>]}
2022-12-25 17:43:12.268835 (Thread-173): sending response (<Response 481 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:43:12.273070 (Thread-174): handling poll request
2022-12-25 17:43:12.273336 (Thread-174): 17:43:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec350063a0>]}
2022-12-25 17:43:12.273758 (Thread-174): sending response (<Response 361 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:43:12.795660 (Thread-175): handling status request
2022-12-25 17:43:12.796064 (Thread-175): 17:43:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34f41400>]}
2022-12-25 17:43:12.796502 (Thread-175): sending response (<Response 481 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:43:12.822646 (Thread-176): handling status request
2022-12-25 17:43:12.822932 (Thread-176): 17:43:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe0541580>]}
2022-12-25 17:43:12.823288 (Thread-176): sending response (<Response 481 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:43:12.866049 (Thread-177): handling status request
2022-12-25 17:43:12.866326 (Thread-177): 17:43:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe0541ac0>]}
2022-12-25 17:43:12.866659 (Thread-177): sending response (<Response 481 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:43:45.331698 (Thread-178): 17:43:45  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-12-25 17:43:45.331913 (Thread-178): 17:43:45  Partial parsing enabled, no changes found, skipping parsing
2022-12-25 17:43:45.338508 (Thread-178): 17:43:45  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe01d5f70>]}
2022-12-25 17:43:45.783354 (Thread-179): handling status request
2022-12-25 17:43:45.783766 (Thread-179): 17:43:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe028ca60>]}
2022-12-25 17:43:45.784229 (Thread-179): sending response (<Response 1273 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:43:45.814645 (Thread-180): handling status request
2022-12-25 17:43:45.814958 (Thread-180): 17:43:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe028c8b0>]}
2022-12-25 17:43:45.815386 (Thread-180): sending response (<Response 1273 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:44:24.336940 (Thread-182): handling status request
2022-12-25 17:44:24.337359 (Thread-182): 17:44:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe01d7a60>]}
2022-12-25 17:44:24.337827 (Thread-182): sending response (<Response 363 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:44:24.380224 (Thread-183): handling status request
2022-12-25 17:44:24.380521 (Thread-183): 17:44:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe028c3d0>]}
2022-12-25 17:44:24.380886 (Thread-183): sending response (<Response 363 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:44:30.283085 (Thread-184): handling status request
2022-12-25 17:44:30.283511 (Thread-184): 17:44:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe028ce50>]}
2022-12-25 17:44:30.283942 (Thread-184): sending response (<Response 363 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:44:33.537686 (Thread-186): handling status request
2022-12-25 17:44:33.538143 (Thread-186): 17:44:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34ffd430>]}
2022-12-25 17:44:33.538604 (Thread-186): sending response (<Response 363 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:44:33.550107 (Thread-187): handling status request
2022-12-25 17:44:33.550389 (Thread-187): 17:44:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34ffdca0>]}
2022-12-25 17:44:33.550745 (Thread-187): sending response (<Response 363 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:44:33.616508 (Thread-188): handling status request
2022-12-25 17:44:33.616826 (Thread-188): 17:44:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe01d5f10>]}
2022-12-25 17:44:33.617181 (Thread-188): sending response (<Response 363 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:44:33.703718 (Thread-189): handling status request
2022-12-25 17:44:33.704089 (Thread-189): 17:44:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe0541df0>]}
2022-12-25 17:44:33.704483 (Thread-189): sending response (<Response 363 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:44:33.754598 (Thread-190): handling deps request
2022-12-25 17:44:33.754941 (Thread-190): 17:44:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe01d0fd0>]}
2022-12-25 17:44:33.795337 (Thread-190): sending response (<Response 140 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:44:33.980534 (Thread-191): handling poll request
2022-12-25 17:44:33.980991 (Thread-191): 17:44:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe02b4b50>]}
2022-12-25 17:44:33.981775 (Thread-191): sending response (<Response 288 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:44:35.213284 (Thread-192): handling poll request
2022-12-25 17:44:35.213715 (Thread-192): 17:44:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe028ea90>]}
2022-12-25 17:44:35.214191 (Thread-192): sending response (<Response 289 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:44:36.405673 (Thread-193): handling poll request
2022-12-25 17:44:36.406123 (Thread-193): 17:44:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe01d5f10>]}
2022-12-25 17:44:36.406595 (Thread-193): sending response (<Response 289 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:44:36.453330 (MainThread): 17:44:36  Set downloads directory='/tmp/dbt-downloads-7r4io_3z'
2022-12-25 17:44:36.454057 (MainThread): 17:44:36  Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
2022-12-25 17:44:36.480615 (MainThread): 17:44:36  Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
2022-12-25 17:44:36.480893 (MainThread): 17:44:36  Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
2022-12-25 17:44:36.513326 (MainThread): 17:44:36  Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
2022-12-25 17:44:36.560553 (MainThread): 17:44:36  Installing dbt-labs/dbt_utils
2022-12-25 17:44:37.588938 (Thread-194): handling poll request
2022-12-25 17:44:37.589341 (Thread-194): 17:44:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe028c700>]}
2022-12-25 17:44:37.589927 (Thread-194): sending response (<Response 2228 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:44:38.779068 (Thread-195): handling poll request
2022-12-25 17:44:38.779497 (Thread-195): 17:44:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe028c460>]}
2022-12-25 17:44:38.779994 (Thread-195): sending response (<Response 289 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:44:39.979685 (Thread-196): handling poll request
2022-12-25 17:44:39.980096 (Thread-196): 17:44:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe028c1c0>]}
2022-12-25 17:44:39.980584 (Thread-196): sending response (<Response 288 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:44:40.465058 (MainThread): 17:44:40    Installed from version 1.0.0
2022-12-25 17:44:40.465239 (MainThread): 17:44:40    Up to date!
2022-12-25 17:44:40.465418 (MainThread): 17:44:40  Sending event: {'category': 'dbt', 'action': 'package', 'label': '8bbbd547-7a61-4535-b450-4180c80c1e39', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44dc246730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f44dc246790>]}
2022-12-25 17:44:40.719446 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:40  Unable to do partial parsing because a project dependency has been added
2022-12-25 17:44:40.719795 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:40  Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34f041f0>]}
2022-12-25 17:44:40.965554 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:40  Parsing macros/etc.sql
2022-12-25 17:44:40.967839 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:40  Parsing macros/catalog.sql
2022-12-25 17:44:40.973260 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:40  Parsing macros/adapters.sql
2022-12-25 17:44:40.992680 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:40  Parsing macros/adapters/apply_grants.sql
2022-12-25 17:44:40.995117 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:40  Parsing macros/materializations/seed.sql
2022-12-25 17:44:40.997409 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:40  Parsing macros/materializations/incremental.sql
2022-12-25 17:44:41.013798 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/materializations/snapshot.sql
2022-12-25 17:44:41.015367 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/materializations/table.sql
2022-12-25 17:44:41.022004 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/materializations/copy.sql
2022-12-25 17:44:41.024515 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/materializations/view.sql
2022-12-25 17:44:41.027140 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/utils/intersect.sql
2022-12-25 17:44:41.027555 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/utils/position.sql
2022-12-25 17:44:41.028099 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/utils/escape_single_quotes.sql
2022-12-25 17:44:41.028653 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/utils/safe_cast.sql
2022-12-25 17:44:41.029168 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/utils/array_construct.sql
2022-12-25 17:44:41.029994 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/utils/datediff.sql
2022-12-25 17:44:41.031150 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/utils/timestamps.sql
2022-12-25 17:44:41.032236 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/utils/array_concat.sql
2022-12-25 17:44:41.032766 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/utils/right.sql
2022-12-25 17:44:41.033388 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/utils/array_append.sql
2022-12-25 17:44:41.034017 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/utils/split_part.sql
2022-12-25 17:44:41.035393 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/utils/date_trunc.sql
2022-12-25 17:44:41.035941 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/utils/hash.sql
2022-12-25 17:44:41.036455 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/utils/except.sql
2022-12-25 17:44:41.036838 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/utils/bool_or.sql
2022-12-25 17:44:41.037286 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/utils/dateadd.sql
2022-12-25 17:44:41.037924 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/utils/listagg.sql
2022-12-25 17:44:41.038885 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/etc/statement.sql
2022-12-25 17:44:41.043664 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/etc/datetime.sql
2022-12-25 17:44:41.051334 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/adapters/apply_grants.sql
2022-12-25 17:44:41.063940 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/adapters/freshness.sql
2022-12-25 17:44:41.065810 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/adapters/columns.sql
2022-12-25 17:44:41.074567 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/adapters/timestamps.sql
2022-12-25 17:44:41.077751 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/adapters/relation.sql
2022-12-25 17:44:41.091104 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/adapters/schema.sql
2022-12-25 17:44:41.093136 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/adapters/persist_docs.sql
2022-12-25 17:44:41.097346 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/adapters/metadata.sql
2022-12-25 17:44:41.103916 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/adapters/indexes.sql
2022-12-25 17:44:41.106427 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/get_custom_name/get_custom_database.sql
2022-12-25 17:44:41.107916 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/get_custom_name/get_custom_schema.sql
2022-12-25 17:44:41.110190 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/get_custom_name/get_custom_alias.sql
2022-12-25 17:44:41.111729 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/python_model/python.sql
2022-12-25 17:44:41.117245 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/materializations/hooks.sql
2022-12-25 17:44:41.120785 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/materializations/configs.sql
2022-12-25 17:44:41.122964 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/materializations/seeds/seed.sql
2022-12-25 17:44:41.129214 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/materializations/seeds/helpers.sql
2022-12-25 17:44:41.145797 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/materializations/tests/test.sql
2022-12-25 17:44:41.149858 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/materializations/tests/helpers.sql
2022-12-25 17:44:41.151503 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/materializations/tests/where_subquery.sql
2022-12-25 17:44:41.153189 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/materializations/models/view/helpers.sql
2022-12-25 17:44:41.154446 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/materializations/models/view/create_or_replace_view.sql
2022-12-25 17:44:41.157501 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/materializations/models/view/create_view_as.sql
2022-12-25 17:44:41.159678 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/materializations/models/view/view.sql
2022-12-25 17:44:41.164810 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/materializations/models/incremental/strategies.sql
2022-12-25 17:44:41.171303 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/materializations/models/incremental/column_helpers.sql
2022-12-25 17:44:41.177136 (Thread-197): handling poll request
2022-12-25 17:44:41.179539 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/materializations/models/incremental/incremental.sql
2022-12-25 17:44:41.179885 (Thread-197): 17:44:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe01d91f0>]}
2022-12-25 17:44:41.189091 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/materializations/models/incremental/on_schema_change.sql
2022-12-25 17:44:41.189640 (Thread-197): sending response (<Response 1401 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:44:41.204598 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/materializations/models/incremental/is_incremental.sql
2022-12-25 17:44:41.206277 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/materializations/models/incremental/merge.sql
2022-12-25 17:44:41.220113 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/materializations/models/table/create_table_as.sql
2022-12-25 17:44:41.223440 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/materializations/models/table/table.sql
2022-12-25 17:44:41.228419 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/materializations/snapshots/strategies.sql
2022-12-25 17:44:41.242830 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/materializations/snapshots/snapshot_merge.sql
2022-12-25 17:44:41.244355 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/materializations/snapshots/snapshot.sql
2022-12-25 17:44:41.254659 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/materializations/snapshots/helpers.sql
2022-12-25 17:44:41.266257 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/generic_test_sql/not_null.sql
2022-12-25 17:44:41.267055 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/generic_test_sql/relationships.sql
2022-12-25 17:44:41.267894 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/generic_test_sql/unique.sql
2022-12-25 17:44:41.268556 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/generic_test_sql/accepted_values.sql
2022-12-25 17:44:41.269853 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/utils/intersect.sql
2022-12-25 17:44:41.270668 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/utils/position.sql
2022-12-25 17:44:41.271728 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/utils/escape_single_quotes.sql
2022-12-25 17:44:41.272746 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/utils/safe_cast.sql
2022-12-25 17:44:41.273958 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/utils/array_construct.sql
2022-12-25 17:44:41.275381 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/utils/cast_bool_to_text.sql
2022-12-25 17:44:41.276396 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/utils/datediff.sql
2022-12-25 17:44:41.277566 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/utils/concat.sql
2022-12-25 17:44:41.278581 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/utils/length.sql
2022-12-25 17:44:41.279527 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/utils/any_value.sql
2022-12-25 17:44:41.280443 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/utils/data_types.sql
2022-12-25 17:44:41.286807 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/utils/array_concat.sql
2022-12-25 17:44:41.287838 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/utils/right.sql
2022-12-25 17:44:41.288892 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/utils/array_append.sql
2022-12-25 17:44:41.289946 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/utils/last_day.sql
2022-12-25 17:44:41.291673 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/utils/split_part.sql
2022-12-25 17:44:41.293572 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/utils/date_trunc.sql
2022-12-25 17:44:41.294615 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/utils/literal.sql
2022-12-25 17:44:41.295535 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/utils/hash.sql
2022-12-25 17:44:41.296577 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/utils/except.sql
2022-12-25 17:44:41.297523 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/utils/bool_or.sql
2022-12-25 17:44:41.298455 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/utils/replace.sql
2022-12-25 17:44:41.299623 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/utils/dateadd.sql
2022-12-25 17:44:41.300796 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/utils/listagg.sql
2022-12-25 17:44:41.302941 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing tests/generic/builtin.sql
2022-12-25 17:44:41.305760 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/sql/pivot.sql
2022-12-25 17:44:41.309486 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/sql/star.sql
2022-12-25 17:44:41.314750 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/sql/get_table_types_sql.sql
2022-12-25 17:44:41.316232 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/sql/generate_surrogate_key.sql
2022-12-25 17:44:41.318591 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/sql/deduplicate.sql
2022-12-25 17:44:41.322007 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/sql/surrogate_key.sql
2022-12-25 17:44:41.323433 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/sql/get_query_results_as_dict.sql
2022-12-25 17:44:41.325574 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/sql/date_spine.sql
2022-12-25 17:44:41.329452 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/sql/get_column_values.sql
2022-12-25 17:44:41.334690 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/sql/groupby.sql
2022-12-25 17:44:41.335977 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/sql/get_tables_by_pattern_sql.sql
2022-12-25 17:44:41.342005 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/sql/nullcheck_table.sql
2022-12-25 17:44:41.343499 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/sql/get_tables_by_prefix_sql.sql
2022-12-25 17:44:41.345030 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/sql/safe_divide.sql
2022-12-25 17:44:41.346089 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/sql/get_relations_by_pattern.sql
2022-12-25 17:44:41.349189 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/sql/get_relations_by_prefix.sql
2022-12-25 17:44:41.352292 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/sql/safe_add.sql
2022-12-25 17:44:41.354336 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/sql/haversine_distance.sql
2022-12-25 17:44:41.359753 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/sql/unpivot.sql
2022-12-25 17:44:41.365262 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/sql/generate_series.sql
2022-12-25 17:44:41.369188 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/sql/get_single_value.sql
2022-12-25 17:44:41.371823 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/sql/width_bucket.sql
2022-12-25 17:44:41.376492 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/sql/nullcheck.sql
2022-12-25 17:44:41.378053 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/sql/union.sql
2022-12-25 17:44:41.390104 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/sql/get_filtered_columns_in_relation.sql
2022-12-25 17:44:41.392699 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/jinja_helpers/pretty_time.sql
2022-12-25 17:44:41.393898 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/jinja_helpers/_is_relation.sql
2022-12-25 17:44:41.394946 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/jinja_helpers/slugify.sql
2022-12-25 17:44:41.396350 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/jinja_helpers/_is_ephemeral.sql
2022-12-25 17:44:41.398135 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/jinja_helpers/log_info.sql
2022-12-25 17:44:41.399210 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/jinja_helpers/pretty_log_format.sql
2022-12-25 17:44:41.400291 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/web/get_url_parameter.sql
2022-12-25 17:44:41.401780 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/web/get_url_path.sql
2022-12-25 17:44:41.404112 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/web/get_url_host.sql
2022-12-25 17:44:41.405930 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/generic_tests/expression_is_true.sql
2022-12-25 17:44:41.407639 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/generic_tests/not_constant.sql
2022-12-25 17:44:41.409760 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/generic_tests/sequential_values.sql
2022-12-25 17:44:41.413261 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/generic_tests/not_null_proportion.sql
2022-12-25 17:44:41.416236 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/generic_tests/at_least_one.sql
2022-12-25 17:44:41.418235 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/generic_tests/equality.sql
2022-12-25 17:44:41.421576 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/generic_tests/equal_rowcount.sql
2022-12-25 17:44:41.425460 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/generic_tests/not_accepted_values.sql
2022-12-25 17:44:41.427456 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/generic_tests/mutually_exclusive_ranges.sql
2022-12-25 17:44:41.435833 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/generic_tests/relationships_where.sql
2022-12-25 17:44:41.437861 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/generic_tests/not_empty_string.sql
2022-12-25 17:44:41.439565 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/generic_tests/accepted_range.sql
2022-12-25 17:44:41.441822 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/generic_tests/fewer_rows_than.sql
2022-12-25 17:44:41.445829 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/generic_tests/unique_combination_of_columns.sql
2022-12-25 17:44:41.448475 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/generic_tests/recency.sql
2022-12-25 17:44:41.451669 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  Parsing macros/generic_tests/cardinality_equality.sql
2022-12-25 17:44:41.806626 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  1699: static parser successfully parsed mart/fct_top_tracks.sql
2022-12-25 17:44:41.809709 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  1699: static parser successfully parsed mart/fct_songplays.sql
2022-12-25 17:44:41.812188 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  1699: static parser successfully parsed mart/fct_top_artists.sql
2022-12-25 17:44:41.814695 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  1603: static parser failed on mart/dim_artists.sql
2022-12-25 17:44:41.819972 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  1602: parser fallback to jinja rendering on mart/dim_artists.sql
2022-12-25 17:44:41.821208 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  1603: static parser failed on mart/dim_albums.sql
2022-12-25 17:44:41.825907 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  1602: parser fallback to jinja rendering on mart/dim_albums.sql
2022-12-25 17:44:41.827152 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  1603: static parser failed on mart/dim_tracks.sql
2022-12-25 17:44:41.832356 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  1602: parser fallback to jinja rendering on mart/dim_tracks.sql
2022-12-25 17:44:41.833660 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  1699: static parser successfully parsed staging/stg_top_tracks.sql
2022-12-25 17:44:41.836227 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  1699: static parser successfully parsed staging/stg_songplays.sql
2022-12-25 17:44:41.838790 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  1699: static parser successfully parsed staging/stg_top_artists.sql
2022-12-25 17:44:41.841969 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  1699: static parser successfully parsed view/vw_top_track_genres.sql
2022-12-25 17:44:41.844867 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  1699: static parser successfully parsed view/vw_top_artist_genres.sql
2022-12-25 17:44:41.847985 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  1699: static parser successfully parsed view/vw_songplays_genres.sql
2022-12-25 17:44:41.850959 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:41  1699: static parser successfully parsed view/vw_songplays_albums.sql
2022-12-25 17:44:42.098043 (e33b0887-ea57-4c53-9e91-6b06158bc859-handler-deps): 17:44:42  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb106f60d0>]}
2022-12-25 17:44:42.422190 (Thread-198): handling poll request
2022-12-25 17:44:42.422611 (Thread-198): 17:44:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe01ce940>]}
2022-12-25 17:44:42.423144 (Thread-198): sending response (<Response 361 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:44:42.972189 (Thread-199): handling status request
2022-12-25 17:44:42.972611 (Thread-199): 17:44:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1077b400>]}
2022-12-25 17:44:42.973248 (Thread-199): sending response (<Response 3236 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:44:43.140999 (Thread-200): handling status request
2022-12-25 17:44:43.141396 (Thread-200): 17:44:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb107e7460>]}
2022-12-25 17:44:43.141971 (Thread-200): sending response (<Response 3236 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:44:43.279475 (Thread-201): handling status request
2022-12-25 17:44:43.279874 (Thread-201): 17:44:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb107e7bb0>]}
2022-12-25 17:44:43.280396 (Thread-201): sending response (<Response 3236 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:44:48.784643 (Thread-202): handling status request
2022-12-25 17:44:48.785055 (Thread-202): 17:44:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb107c51c0>]}
2022-12-25 17:44:48.785577 (Thread-202): sending response (<Response 3236 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:44:48.958894 (Thread-203): handling run_sql request
2022-12-25 17:44:48.959236 (Thread-203): 17:44:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb107c5a00>]}
2022-12-25 17:44:51.542326 (Thread-203): sending response (<Response 140 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:44:51.594966 (MainThread): 17:44:51  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6cb0664-30cb-4d9f-a00c-8b5934ab5d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76484e3130>]}
2022-12-25 17:44:51.595498 (MainThread): 17:44:51  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 431 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 17:44:51.596073 (Thread-1): 17:44:51  Acquiring new bigquery connection "rpc.spotify.request"
2022-12-25 17:44:51.596211 (Thread-1): 17:44:51  Began compiling node rpc.spotify.request
2022-12-25 17:44:51.596300 (Thread-1): 17:44:51  Compiling rpc.spotify.request
2022-12-25 17:44:51.607619 (Thread-1): 17:44:51  Opening a new connection, currently in state init
2022-12-25 17:44:51.812150 (Thread-204): handling poll request
2022-12-25 17:44:51.812598 (Thread-204): 17:44:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1071f4f0>]}
2022-12-25 17:44:51.813453 (Thread-204): sending response (<Response 2427 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:44:51.979927 (Thread-1): 17:44:51  finished collecting timing info
2022-12-25 17:44:51.980135 (Thread-1): 17:44:51  Began executing node rpc.spotify.request
2022-12-25 17:44:51.980251 (Thread-1): 17:44:51  On rpc.spotify.request: -- albums table
-- 

-- 
--     select distinct
--         album_id,
--         album_name,
--         album_release_year,
--         album_type                                   
--     from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`
--     union
-- 
--     select distinct
--         album_id,
--         album_name,
--         album_release_year,
--         album_type                                   
--     from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`
--     
-- 

select * from 


        (
            select
                cast('`dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`' as STRING) as _dbt_source_relation,

                
                    cast(`songplays_id` as INT64) as `songplays_id` ,
                    cast(`track_id` as STRING) as `track_id` ,
                    cast(`track_name` as STRING) as `track_name` ,
                    cast(`track_duration` as FLOAT64) as `track_duration` ,
                    cast(`track_is_explicit` as BOOLEAN) as `track_is_explicit` ,
                    cast(`track_popularity` as INT64) as `track_popularity` ,
                    cast(`track_played_at` as DATETIME) as `track_played_at` ,
                    cast(`artist_name` as STRING) as `artist_name` ,
                    cast(`artist_name_others` as STRING) as `artist_name_others` ,
                    cast(`artist_id` as STRING) as `artist_id` ,
                    cast(`artist_id_others` as STRING) as `artist_id_others` ,
                    cast(`track_danceability` as FLOAT64) as `track_danceability` ,
                    cast(`track_energy` as FLOAT64) as `track_energy` ,
                    cast(`track_key` as INT64) as `track_key` ,
                    cast(`track_loudness` as FLOAT64) as `track_loudness` ,
                    cast(`track_mode` as INT64) as `track_mode` ,
                    cast(`track_speechiness` as FLOAT64) as `track_speechiness` ,
                    cast(`track_acousticness` as FLOAT64) as `track_acousticness` ,
                    cast(`track_instrumentalness` as FLOAT64) as `track_instrumentalness` ,
                    cast(`track_liveness` as FLOAT64) as `track_liveness` ,
                    cast(`track_valence` as FLOAT64) as `track_valence` ,
                    cast(`artist_popularity` as INT64) as `artist_popularity` ,
                    cast(`artist_followers` as INT64) as `artist_followers` ,
                    cast(`artist_genre` as STRING) as `artist_genre` ,
                    cast(`artist_genre_others` as STRING) as `artist_genre_others` ,
                    cast(null as INT64) as `track_rank` 

            from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`

            
        )

        union all
        

        (
            select
                cast('`dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`' as STRING) as _dbt_source_relation,

                
                    cast(null as INT64) as `songplays_id` ,
                    cast(`track_id` as STRING) as `track_id` ,
                    cast(`track_name` as STRING) as `track_name` ,
                    cast(`track_duration` as FLOAT64) as `track_duration` ,
                    cast(`track_is_explicit` as BOOLEAN) as `track_is_explicit` ,
                    cast(`track_popularity` as INT64) as `track_popularity` ,
                    cast(null as DATETIME) as `track_played_at` ,
                    cast(`artist_name` as STRING) as `artist_name` ,
                    cast(`artist_name_others` as STRING) as `artist_name_others` ,
                    cast(`artist_id` as STRING) as `artist_id` ,
                    cast(`artist_id_others` as STRING) as `artist_id_others` ,
                    cast(`track_danceability` as FLOAT64) as `track_danceability` ,
                    cast(`track_energy` as FLOAT64) as `track_energy` ,
                    cast(`track_key` as INT64) as `track_key` ,
                    cast(`track_loudness` as FLOAT64) as `track_loudness` ,
                    cast(`track_mode` as INT64) as `track_mode` ,
                    cast(`track_speechiness` as FLOAT64) as `track_speechiness` ,
                    cast(`track_acousticness` as FLOAT64) as `track_acousticness` ,
                    cast(`track_instrumentalness` as FLOAT64) as `track_instrumentalness` ,
                    cast(`track_liveness` as FLOAT64) as `track_liveness` ,
                    cast(`track_valence` as FLOAT64) as `track_valence` ,
                    cast(`artist_popularity` as INT64) as `artist_popularity` ,
                    cast(`artist_followers` as INT64) as `artist_followers` ,
                    cast(`artist_genre` as STRING) as `artist_genre` ,
                    cast(`artist_genre_others` as STRING) as `artist_genre_others` ,
                    cast(`track_rank` as INT64) as `track_rank` 

            from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`

            
        )

        
limit 500
/* limit added automatically by dbt cloud */
2022-12-25 17:44:53.005876 (Thread-205): handling poll request
2022-12-25 17:44:53.006343 (Thread-205): 17:44:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb107c5550>]}
2022-12-25 17:44:53.006921 (Thread-205): sending response (<Response 6496 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:44:53.050869 (Thread-1): 17:44:53  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:12443643-34b3-4e6d-b669-cb916ecbfcbb:US&page=queryresults
2022-12-25 17:44:53.051277 (Thread-1): 17:44:53  finished collecting timing info
2022-12-25 17:44:54.210790 (Thread-206): handling poll request
2022-12-25 17:44:54.211200 (Thread-206): 17:44:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe01c8f40>]}
2022-12-25 17:44:54.214349 (Thread-206): sending response (<Response 50007 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:45:03.756419 (Thread-207): handling status request
2022-12-25 17:45:03.756836 (Thread-207): 17:45:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe01bffd0>]}
2022-12-25 17:45:03.757425 (Thread-207): sending response (<Response 3236 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:45:03.939567 (Thread-208): handling run_sql request
2022-12-25 17:45:03.939985 (Thread-208): 17:45:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe024b2e0>]}
2022-12-25 17:45:06.537530 (Thread-208): sending response (<Response 140 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:45:06.589916 (MainThread): 17:45:06  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '786bd79f-c8c0-4086-96f1-189860781db6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff7982e3250>]}
2022-12-25 17:45:06.590426 (MainThread): 17:45:06  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 431 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 17:45:06.591011 (Thread-1): 17:45:06  Acquiring new bigquery connection "rpc.spotify.request"
2022-12-25 17:45:06.591153 (Thread-1): 17:45:06  Began compiling node rpc.spotify.request
2022-12-25 17:45:06.591245 (Thread-1): 17:45:06  Compiling rpc.spotify.request
2022-12-25 17:45:06.602553 (Thread-1): 17:45:06  Opening a new connection, currently in state init
2022-12-25 17:45:06.766456 (Thread-209): handling poll request
2022-12-25 17:45:06.766908 (Thread-209): 17:45:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe02664c0>]}
2022-12-25 17:45:06.767758 (Thread-209): sending response (<Response 2427 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:45:06.978373 (Thread-1): 17:45:06  finished collecting timing info
2022-12-25 17:45:06.978572 (Thread-1): 17:45:06  Began executing node rpc.spotify.request
2022-12-25 17:45:06.978688 (Thread-1): 17:45:06  On rpc.spotify.request: -- albums table
-- 

-- 
--     select distinct
--         album_id,
--         album_name,
--         album_release_year,
--         album_type                                   
--     from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`
--     union
-- 
--     select distinct
--         album_id,
--         album_name,
--         album_release_year,
--         album_type                                   
--     from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`
--     
-- 

select * from 


        (
            select
                cast('`dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`' as STRING) as _dbt_source_relation,

                
                    cast(`album_id` as STRING) as `album_id` ,
                    cast(`album_name` as STRING) as `album_name` ,
                    cast(`album_release_year` as INT64) as `album_release_year` ,
                    cast(`album_type` as STRING) as `album_type` 

            from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`

            
        )

        union all
        

        (
            select
                cast('`dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`' as STRING) as _dbt_source_relation,

                
                    cast(`album_id` as STRING) as `album_id` ,
                    cast(`album_name` as STRING) as `album_name` ,
                    cast(`album_release_year` as INT64) as `album_release_year` ,
                    cast(`album_type` as STRING) as `album_type` 

            from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`

            
        )

        
limit 500
/* limit added automatically by dbt cloud */
2022-12-25 17:45:07.965879 (Thread-210): handling poll request
2022-12-25 17:45:07.966323 (Thread-210): 17:45:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe0266130>]}
2022-12-25 17:45:07.966885 (Thread-210): sending response (<Response 3119 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:45:08.091643 (Thread-1): 17:45:08  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:e732b1af-2693-4a1a-b0e9-e39f59e82cc5:US&page=queryresults
2022-12-25 17:45:08.091973 (Thread-1): 17:45:08  finished collecting timing info
2022-12-25 17:45:09.170104 (Thread-211): handling poll request
2022-12-25 17:45:09.170518 (Thread-211): 17:45:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe0261340>]}
2022-12-25 17:45:09.171785 (Thread-211): sending response (<Response 20147 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:45:34.327337 (Thread-212): handling status request
2022-12-25 17:45:34.327757 (Thread-212): 17:45:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe02614c0>]}
2022-12-25 17:45:34.328363 (Thread-212): sending response (<Response 3236 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:45:34.504141 (Thread-213): handling run_sql request
2022-12-25 17:45:34.504519 (Thread-213): 17:45:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe02615b0>]}
2022-12-25 17:45:37.178768 (Thread-213): sending response (<Response 140 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:45:37.221660 (MainThread): 17:45:37  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6e16b84-26c3-4c54-a322-19e22a5180a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c7c3231f0>]}
2022-12-25 17:45:37.222233 (MainThread): 17:45:37  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 431 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 17:45:37.222909 (Thread-1): 17:45:37  Acquiring new bigquery connection "rpc.spotify.request"
2022-12-25 17:45:37.223057 (Thread-1): 17:45:37  Began compiling node rpc.spotify.request
2022-12-25 17:45:37.223162 (Thread-1): 17:45:37  Compiling rpc.spotify.request
2022-12-25 17:45:37.235081 (Thread-1): 17:45:37  Opening a new connection, currently in state init
2022-12-25 17:45:37.360491 (Thread-214): handling poll request
2022-12-25 17:45:37.361011 (Thread-214): 17:45:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe0261dc0>]}
2022-12-25 17:45:37.361925 (Thread-214): sending response (<Response 2427 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:45:37.561250 (Thread-1): 17:45:37  finished collecting timing info
2022-12-25 17:45:37.561465 (Thread-1): 17:45:37  Began executing node rpc.spotify.request
2022-12-25 17:45:37.561584 (Thread-1): 17:45:37  On rpc.spotify.request: -- albums table
-- 

-- 
--     select distinct
--         album_id,
--         album_name,
--         album_release_year,
--         album_type                                   
--     from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`
--     union
-- 
--     select distinct
--         album_id,
--         album_name,
--         album_release_year,
--         album_type                                   
--     from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`
--     
-- 

select -_dbt_source_relation from 


        (
            select
                cast('`dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`' as STRING) as _dbt_source_relation,

                
                    cast(`album_id` as STRING) as `album_id` ,
                    cast(`album_name` as STRING) as `album_name` ,
                    cast(`album_release_year` as INT64) as `album_release_year` ,
                    cast(`album_type` as STRING) as `album_type` 

            from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`

            
        )

        union all
        

        (
            select
                cast('`dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`' as STRING) as _dbt_source_relation,

                
                    cast(`album_id` as STRING) as `album_id` ,
                    cast(`album_name` as STRING) as `album_name` ,
                    cast(`album_release_year` as INT64) as `album_release_year` ,
                    cast(`album_type` as STRING) as `album_type` 

            from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`

            
        )

        
limit 500
/* limit added automatically by dbt cloud */
2022-12-25 17:45:37.862535 (Thread-1): 17:45:37  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for operator - for argument types: STRING. Supported signatures: -(INT64); -(FLOAT64); -(NUMERIC); -(BIGNUMERIC); -(INTERVAL) at [22:8]')
2022-12-25 17:45:38.344456 (Thread-1): 17:45:38  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:US:a2992d7f-9015-44f4-8152-8131c77183b0&page=queryresults
2022-12-25 17:45:38.344652 (Thread-1): 17:45:38  finished collecting timing info
2022-12-25 17:45:38.344780 (Thread-1): Got an exception: Database Error
  No matching signature for operator - for argument types: STRING. Supported signatures: -(INT64); -(FLOAT64); -(NUMERIC); -(BIGNUMERIC); -(INTERVAL) at [22:8]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 207, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 646, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 429, in fn
    return self._query_and_results(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 631, in _query_and_results
    iterator = query_job.result(timeout=job_execution_timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1303, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 679, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 No matching signature for operator - for argument types: STRING. Supported signatures: -(INT64); -(FLOAT64); -(NUMERIC); -(BIGNUMERIC); -(INTERVAL) at [22:8]

(job ID: a2992d7f-9015-44f4-8152-8131c77183b0)

                                          -----Query Job SQL Follows-----                                          

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:-- albums table
   2:-- 
   3:
   4:-- 
   5:--     select distinct
   6:--         album_id,
   7:--         album_name,
   8:--         album_release_year,
   9:--         album_type                                   
  10:--     from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`
  11:--     union
  12:-- 
  13:--     select distinct
  14:--         album_id,
  15:--         album_name,
  16:--         album_release_year,
  17:--         album_type                                   
  18:--     from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`
  19:--     
  20:-- 
  21:
  22:select -_dbt_source_relation from 
  23:
  24:
  25:        (
  26:            select
  27:                cast('`dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`' as STRING) as _dbt_source_relation,
  28:
  29:                
  30:                    cast(`album_id` as STRING) as `album_id` ,
  31:                    cast(`album_name` as STRING) as `album_name` ,
  32:                    cast(`album_release_year` as INT64) as `album_release_year` ,
  33:                    cast(`album_type` as STRING) as `album_type` 
  34:
  35:            from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`
  36:
  37:            
  38:        )
  39:
  40:        union all
  41:        
  42:
  43:        (
  44:            select
  45:                cast('`dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`' as STRING) as _dbt_source_relation,
  46:
  47:                
  48:                    cast(`album_id` as STRING) as `album_id` ,
  49:                    cast(`album_name` as STRING) as `album_name` ,
  50:                    cast(`album_release_year` as INT64) as `album_release_year` ,
  51:                    cast(`album_type` as STRING) as `album_type` 
  52:
  53:            from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`
  54:
  55:            
  56:        )
  57:
  58:        
  59:limit 500
  60:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 385, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 338, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 429, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 108, in execute
    _, execute_result = self.adapter.execute(compiled_sql, fetch=True)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 278, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 446, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 437, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 646, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 211, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 199, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  No matching signature for operator - for argument types: STRING. Supported signatures: -(INT64); -(FLOAT64); -(NUMERIC); -(BIGNUMERIC); -(INTERVAL) at [22:8]
2022-12-25 17:45:38.346789 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system.sql)\n  No matching signature for operator - for argument types: STRING. Supported signatures: -(INT64); -(FLOAT64); -(NUMERIC); -(BIGNUMERIC); -(INTERVAL) at [22:8]', 'raw_code': '-- albums table\n-- {% set tables = [\'stg_songplays\', \'stg_top_tracks\'] %}\n\n-- {% for table in tables %}\n--     select distinct\n--         album_id,\n--         album_name,\n--         album_release_year,\n--         album_type                                   \n--     from {{ ref(table) }}\n--     {% if not loop.last -%} union {%- endif %}\n-- {% endfor %}\n\nselect -_dbt_source_relation from \n{{ dbt_utils.union_relations(\n    relations=[ref(\'stg_songplays\'), ref(\'stg_top_tracks\')],\n    include=["album_id","album_name","album_release_year","album_type"]\n) }}\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_code': "-- albums table\n-- \n\n-- \n--     select distinct\n--         album_id,\n--         album_name,\n--         album_release_year,\n--         album_type                                   \n--     from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`\n--     union\n-- \n--     select distinct\n--         album_id,\n--         album_name,\n--         album_release_year,\n--         album_type                                   \n--     from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`\n--     \n-- \n\nselect -_dbt_source_relation from \n\n\n        (\n            select\n                cast('`dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`' as STRING) as _dbt_source_relation,\n\n                \n                    cast(`album_id` as STRING) as `album_id` ,\n                    cast(`album_name` as STRING) as `album_name` ,\n                    cast(`album_release_year` as INT64) as `album_release_year` ,\n                    cast(`album_type` as STRING) as `album_type` \n\n            from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('`dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`' as STRING) as _dbt_source_relation,\n\n                \n                    cast(`album_id` as STRING) as `album_id` ,\n                    cast(`album_name` as STRING) as `album_name` ,\n                    cast(`album_release_year` as INT64) as `album_release_year` ,\n                    cast(`album_type` as STRING) as `album_type` \n\n            from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`\n\n            \n        )\n\n        \nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 148, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 68, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system.sql)\n  No matching signature for operator - for argument types: STRING. Supported signatures: -(INT64); -(FLOAT64); -(NUMERIC); -(BIGNUMERIC); -(INTERVAL) at [22:8]', 'raw_code': '-- albums table\n-- {% set tables = [\'stg_songplays\', \'stg_top_tracks\'] %}\n\n-- {% for table in tables %}\n--     select distinct\n--         album_id,\n--         album_name,\n--         album_release_year,\n--         album_type                                   \n--     from {{ ref(table) }}\n--     {% if not loop.last -%} union {%- endif %}\n-- {% endfor %}\n\nselect -_dbt_source_relation from \n{{ dbt_utils.union_relations(\n    relations=[ref(\'stg_songplays\'), ref(\'stg_top_tracks\')],\n    include=["album_id","album_name","album_release_year","album_type"]\n) }}\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_code': "-- albums table\n-- \n\n-- \n--     select distinct\n--         album_id,\n--         album_name,\n--         album_release_year,\n--         album_type                                   \n--     from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`\n--     union\n-- \n--     select distinct\n--         album_id,\n--         album_name,\n--         album_release_year,\n--         album_type                                   \n--     from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`\n--     \n-- \n\nselect -_dbt_source_relation from \n\n\n        (\n            select\n                cast('`dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`' as STRING) as _dbt_source_relation,\n\n                \n                    cast(`album_id` as STRING) as `album_id` ,\n                    cast(`album_name` as STRING) as `album_name` ,\n                    cast(`album_release_year` as INT64) as `album_release_year` ,\n                    cast(`album_type` as STRING) as `album_type` \n\n            from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('`dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`' as STRING) as _dbt_source_relation,\n\n                \n                    cast(`album_id` as STRING) as `album_id` ,\n                    cast(`album_name` as STRING) as `album_name` ,\n                    cast(`album_release_year` as INT64) as `album_release_year` ,\n                    cast(`album_type` as STRING) as `album_type` \n\n            from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`\n\n            \n        )\n\n        \nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-12-25 17:45:38.553253 (Thread-215): handling poll request
2022-12-25 17:45:38.553703 (Thread-215): 17:45:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe025b2e0>]}
2022-12-25 17:45:38.554424 (Thread-215): sending response (<Response 17215 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:45:39.776003 (Thread-216): handling poll request
2022-12-25 17:45:39.776438 (Thread-216): 17:45:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe025b520>]}
2022-12-25 17:45:39.777140 (Thread-216): sending response (<Response 21657 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:46:27.277387 (Thread-217): handling status request
2022-12-25 17:46:27.277823 (Thread-217): 17:46:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe025b700>]}
2022-12-25 17:46:27.278426 (Thread-217): sending response (<Response 3236 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:46:27.462907 (Thread-218): handling run_sql request
2022-12-25 17:46:27.463336 (Thread-218): 17:46:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe025b880>]}
2022-12-25 17:46:30.065493 (Thread-218): sending response (<Response 140 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:46:30.118813 (MainThread): 17:46:30  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11dae38b-1875-4b58-8407-078dd5351e69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0e401a3160>]}
2022-12-25 17:46:30.119347 (MainThread): 17:46:30  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 431 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 17:46:30.119936 (Thread-1): 17:46:30  Acquiring new bigquery connection "rpc.spotify.request"
2022-12-25 17:46:30.120078 (Thread-1): 17:46:30  Began compiling node rpc.spotify.request
2022-12-25 17:46:30.120168 (Thread-1): 17:46:30  Compiling rpc.spotify.request
2022-12-25 17:46:30.131883 (Thread-1): 17:46:30  Opening a new connection, currently in state init
2022-12-25 17:46:30.468804 (Thread-1): 17:46:30  finished collecting timing info
2022-12-25 17:46:30.469015 (Thread-1): 17:46:30  Began executing node rpc.spotify.request
2022-12-25 17:46:30.469134 (Thread-1): 17:46:30  On rpc.spotify.request: -- albums table
-- 

-- 
--     select distinct
--         album_id,
--         album_name,
--         album_release_year,
--         album_type                                   
--     from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`
--     union
-- 
--     select distinct
--         album_id,
--         album_name,
--         album_release_year,
--         album_type                                   
--     from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`
--     
-- 

select * except(-_dbt_source_relation) from 


        (
            select
                cast('`dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`' as STRING) as _dbt_source_relation,

                
                    cast(`album_id` as STRING) as `album_id` ,
                    cast(`album_name` as STRING) as `album_name` ,
                    cast(`album_release_year` as INT64) as `album_release_year` ,
                    cast(`album_type` as STRING) as `album_type` 

            from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`

            
        )

        union all
        

        (
            select
                cast('`dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`' as STRING) as _dbt_source_relation,

                
                    cast(`album_id` as STRING) as `album_id` ,
                    cast(`album_name` as STRING) as `album_name` ,
                    cast(`album_release_year` as INT64) as `album_release_year` ,
                    cast(`album_type` as STRING) as `album_type` 

            from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`

            
        )

        
limit 500
/* limit added automatically by dbt cloud */
2022-12-25 17:46:30.611524 (Thread-1): 17:46:30  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected "-" at [22:17]')
2022-12-25 17:46:30.723985 (Thread-219): handling poll request
2022-12-25 17:46:30.724458 (Thread-219): 17:46:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe0259820>]}
2022-12-25 17:46:30.725362 (Thread-219): sending response (<Response 5533 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:46:30.759818 (Thread-1): 17:46:30  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:US:e033c399-fdb8-4b21-8fc1-31a918e72a6c&page=queryresults
2022-12-25 17:46:30.760014 (Thread-1): 17:46:30  finished collecting timing info
2022-12-25 17:46:30.760134 (Thread-1): Got an exception: Database Error
  Syntax error: Unexpected "-" at [22:17]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 207, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 646, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 429, in fn
    return self._query_and_results(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 631, in _query_and_results
    iterator = query_job.result(timeout=job_execution_timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1303, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 679, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Syntax error: Unexpected "-" at [22:17]

(job ID: e033c399-fdb8-4b21-8fc1-31a918e72a6c)

                                          -----Query Job SQL Follows-----                                          

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:-- albums table
   2:-- 
   3:
   4:-- 
   5:--     select distinct
   6:--         album_id,
   7:--         album_name,
   8:--         album_release_year,
   9:--         album_type                                   
  10:--     from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`
  11:--     union
  12:-- 
  13:--     select distinct
  14:--         album_id,
  15:--         album_name,
  16:--         album_release_year,
  17:--         album_type                                   
  18:--     from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`
  19:--     
  20:-- 
  21:
  22:select * except(-_dbt_source_relation) from 
  23:
  24:
  25:        (
  26:            select
  27:                cast('`dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`' as STRING) as _dbt_source_relation,
  28:
  29:                
  30:                    cast(`album_id` as STRING) as `album_id` ,
  31:                    cast(`album_name` as STRING) as `album_name` ,
  32:                    cast(`album_release_year` as INT64) as `album_release_year` ,
  33:                    cast(`album_type` as STRING) as `album_type` 
  34:
  35:            from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`
  36:
  37:            
  38:        )
  39:
  40:        union all
  41:        
  42:
  43:        (
  44:            select
  45:                cast('`dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`' as STRING) as _dbt_source_relation,
  46:
  47:                
  48:                    cast(`album_id` as STRING) as `album_id` ,
  49:                    cast(`album_name` as STRING) as `album_name` ,
  50:                    cast(`album_release_year` as INT64) as `album_release_year` ,
  51:                    cast(`album_type` as STRING) as `album_type` 
  52:
  53:            from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`
  54:
  55:            
  56:        )
  57:
  58:        
  59:limit 500
  60:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 385, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 338, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 429, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 108, in execute
    _, execute_result = self.adapter.execute(compiled_sql, fetch=True)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 278, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 446, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 437, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 646, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 211, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 199, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  Syntax error: Unexpected "-" at [22:17]
2022-12-25 17:46:30.762130 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system.sql)\n  Syntax error: Unexpected "-" at [22:17]', 'raw_code': '-- albums table\n-- {% set tables = [\'stg_songplays\', \'stg_top_tracks\'] %}\n\n-- {% for table in tables %}\n--     select distinct\n--         album_id,\n--         album_name,\n--         album_release_year,\n--         album_type                                   \n--     from {{ ref(table) }}\n--     {% if not loop.last -%} union {%- endif %}\n-- {% endfor %}\n\nselect * except(-_dbt_source_relation) from \n{{ dbt_utils.union_relations(\n    relations=[ref(\'stg_songplays\'), ref(\'stg_top_tracks\')],\n    include=["album_id","album_name","album_release_year","album_type"]\n) }}\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_code': "-- albums table\n-- \n\n-- \n--     select distinct\n--         album_id,\n--         album_name,\n--         album_release_year,\n--         album_type                                   \n--     from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`\n--     union\n-- \n--     select distinct\n--         album_id,\n--         album_name,\n--         album_release_year,\n--         album_type                                   \n--     from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`\n--     \n-- \n\nselect * except(-_dbt_source_relation) from \n\n\n        (\n            select\n                cast('`dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`' as STRING) as _dbt_source_relation,\n\n                \n                    cast(`album_id` as STRING) as `album_id` ,\n                    cast(`album_name` as STRING) as `album_name` ,\n                    cast(`album_release_year` as INT64) as `album_release_year` ,\n                    cast(`album_type` as STRING) as `album_type` \n\n            from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('`dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`' as STRING) as _dbt_source_relation,\n\n                \n                    cast(`album_id` as STRING) as `album_id` ,\n                    cast(`album_name` as STRING) as `album_name` ,\n                    cast(`album_release_year` as INT64) as `album_release_year` ,\n                    cast(`album_type` as STRING) as `album_type` \n\n            from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`\n\n            \n        )\n\n        \nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 148, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 68, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system.sql)\n  Syntax error: Unexpected "-" at [22:17]', 'raw_code': '-- albums table\n-- {% set tables = [\'stg_songplays\', \'stg_top_tracks\'] %}\n\n-- {% for table in tables %}\n--     select distinct\n--         album_id,\n--         album_name,\n--         album_release_year,\n--         album_type                                   \n--     from {{ ref(table) }}\n--     {% if not loop.last -%} union {%- endif %}\n-- {% endfor %}\n\nselect * except(-_dbt_source_relation) from \n{{ dbt_utils.union_relations(\n    relations=[ref(\'stg_songplays\'), ref(\'stg_top_tracks\')],\n    include=["album_id","album_name","album_release_year","album_type"]\n) }}\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_code': "-- albums table\n-- \n\n-- \n--     select distinct\n--         album_id,\n--         album_name,\n--         album_release_year,\n--         album_type                                   \n--     from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`\n--     union\n-- \n--     select distinct\n--         album_id,\n--         album_name,\n--         album_release_year,\n--         album_type                                   \n--     from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`\n--     \n-- \n\nselect * except(-_dbt_source_relation) from \n\n\n        (\n            select\n                cast('`dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`' as STRING) as _dbt_source_relation,\n\n                \n                    cast(`album_id` as STRING) as `album_id` ,\n                    cast(`album_name` as STRING) as `album_name` ,\n                    cast(`album_release_year` as INT64) as `album_release_year` ,\n                    cast(`album_type` as STRING) as `album_type` \n\n            from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('`dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`' as STRING) as _dbt_source_relation,\n\n                \n                    cast(`album_id` as STRING) as `album_id` ,\n                    cast(`album_name` as STRING) as `album_name` ,\n                    cast(`album_release_year` as INT64) as `album_release_year` ,\n                    cast(`album_type` as STRING) as `album_type` \n\n            from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`\n\n            \n        )\n\n        \nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-12-25 17:46:31.913493 (Thread-220): handling poll request
2022-12-25 17:46:31.913961 (Thread-220): 17:46:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe0259970>]}
2022-12-25 17:46:31.914662 (Thread-220): sending response (<Response 20925 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:46:38.964320 (Thread-221): handling status request
2022-12-25 17:46:38.964732 (Thread-221): 17:46:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe0259e50>]}
2022-12-25 17:46:38.965337 (Thread-221): sending response (<Response 3236 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:46:39.142791 (Thread-222): handling run_sql request
2022-12-25 17:46:39.143104 (Thread-222): 17:46:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe0259f40>]}
2022-12-25 17:46:41.794958 (Thread-222): sending response (<Response 140 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:46:41.848463 (MainThread): 17:46:41  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '738cdbac-e0ea-4c11-aa0b-88cc78f00dd6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f427c523160>]}
2022-12-25 17:46:41.848988 (MainThread): 17:46:41  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 431 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 17:46:41.849579 (Thread-1): 17:46:41  Acquiring new bigquery connection "rpc.spotify.request"
2022-12-25 17:46:41.849763 (Thread-1): 17:46:41  Began compiling node rpc.spotify.request
2022-12-25 17:46:41.849861 (Thread-1): 17:46:41  Compiling rpc.spotify.request
2022-12-25 17:46:41.861650 (Thread-1): 17:46:41  Opening a new connection, currently in state init
2022-12-25 17:46:41.995148 (Thread-223): handling poll request
2022-12-25 17:46:41.995650 (Thread-223): 17:46:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe0258df0>]}
2022-12-25 17:46:41.996929 (Thread-223): sending response (<Response 2427 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:46:42.213167 (Thread-1): 17:46:42  finished collecting timing info
2022-12-25 17:46:42.213377 (Thread-1): 17:46:42  Began executing node rpc.spotify.request
2022-12-25 17:46:42.213495 (Thread-1): 17:46:42  On rpc.spotify.request: -- albums table
-- 

-- 
--     select distinct
--         album_id,
--         album_name,
--         album_release_year,
--         album_type                                   
--     from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`
--     union
-- 
--     select distinct
--         album_id,
--         album_name,
--         album_release_year,
--         album_type                                   
--     from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`
--     
-- 

select * except(_dbt_source_relation) from 


        (
            select
                cast('`dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`' as STRING) as _dbt_source_relation,

                
                    cast(`album_id` as STRING) as `album_id` ,
                    cast(`album_name` as STRING) as `album_name` ,
                    cast(`album_release_year` as INT64) as `album_release_year` ,
                    cast(`album_type` as STRING) as `album_type` 

            from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`

            
        )

        union all
        

        (
            select
                cast('`dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`' as STRING) as _dbt_source_relation,

                
                    cast(`album_id` as STRING) as `album_id` ,
                    cast(`album_name` as STRING) as `album_name` ,
                    cast(`album_release_year` as INT64) as `album_release_year` ,
                    cast(`album_type` as STRING) as `album_type` 

            from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`

            
        )

        
limit 500
/* limit added automatically by dbt cloud */
2022-12-25 17:46:42.542053 (Thread-1): 17:46:42  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Queries in UNION ALL have mismatched column count; query 1 has 4 columns, query 2 has 5 columns at [44:13]')
2022-12-25 17:46:43.217756 (Thread-1): 17:46:43  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:US:b7d5bcb6-8fe7-4fe5-a0f9-7cb62655b155&page=queryresults
2022-12-25 17:46:43.217957 (Thread-1): 17:46:43  finished collecting timing info
2022-12-25 17:46:43.218081 (Thread-1): Got an exception: Database Error
  Queries in UNION ALL have mismatched column count; query 1 has 4 columns, query 2 has 5 columns at [44:13]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 207, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 646, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 429, in fn
    return self._query_and_results(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 631, in _query_and_results
    iterator = query_job.result(timeout=job_execution_timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1303, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 679, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Queries in UNION ALL have mismatched column count; query 1 has 4 columns, query 2 has 5 columns at [44:13]

(job ID: b7d5bcb6-8fe7-4fe5-a0f9-7cb62655b155)

                                          -----Query Job SQL Follows-----                                          

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:-- albums table
   2:-- 
   3:
   4:-- 
   5:--     select distinct
   6:--         album_id,
   7:--         album_name,
   8:--         album_release_year,
   9:--         album_type                                   
  10:--     from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`
  11:--     union
  12:-- 
  13:--     select distinct
  14:--         album_id,
  15:--         album_name,
  16:--         album_release_year,
  17:--         album_type                                   
  18:--     from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`
  19:--     
  20:-- 
  21:
  22:select * except(_dbt_source_relation) from 
  23:
  24:
  25:        (
  26:            select
  27:                cast('`dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`' as STRING) as _dbt_source_relation,
  28:
  29:                
  30:                    cast(`album_id` as STRING) as `album_id` ,
  31:                    cast(`album_name` as STRING) as `album_name` ,
  32:                    cast(`album_release_year` as INT64) as `album_release_year` ,
  33:                    cast(`album_type` as STRING) as `album_type` 
  34:
  35:            from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`
  36:
  37:            
  38:        )
  39:
  40:        union all
  41:        
  42:
  43:        (
  44:            select
  45:                cast('`dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`' as STRING) as _dbt_source_relation,
  46:
  47:                
  48:                    cast(`album_id` as STRING) as `album_id` ,
  49:                    cast(`album_name` as STRING) as `album_name` ,
  50:                    cast(`album_release_year` as INT64) as `album_release_year` ,
  51:                    cast(`album_type` as STRING) as `album_type` 
  52:
  53:            from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`
  54:
  55:            
  56:        )
  57:
  58:        
  59:limit 500
  60:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 385, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 338, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 429, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 108, in execute
    _, execute_result = self.adapter.execute(compiled_sql, fetch=True)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 278, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 446, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 437, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 646, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 211, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 199, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  Queries in UNION ALL have mismatched column count; query 1 has 4 columns, query 2 has 5 columns at [44:13]
2022-12-25 17:46:43.219997 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system.sql)\n  Queries in UNION ALL have mismatched column count; query 1 has 4 columns, query 2 has 5 columns at [44:13]', 'raw_code': '-- albums table\n-- {% set tables = [\'stg_songplays\', \'stg_top_tracks\'] %}\n\n-- {% for table in tables %}\n--     select distinct\n--         album_id,\n--         album_name,\n--         album_release_year,\n--         album_type                                   \n--     from {{ ref(table) }}\n--     {% if not loop.last -%} union {%- endif %}\n-- {% endfor %}\n\nselect * except(_dbt_source_relation) from \n{{ dbt_utils.union_relations(\n    relations=[ref(\'stg_songplays\'), ref(\'stg_top_tracks\')],\n    include=["album_id","album_name","album_release_year","album_type"]\n) }}\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_code': "-- albums table\n-- \n\n-- \n--     select distinct\n--         album_id,\n--         album_name,\n--         album_release_year,\n--         album_type                                   \n--     from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`\n--     union\n-- \n--     select distinct\n--         album_id,\n--         album_name,\n--         album_release_year,\n--         album_type                                   \n--     from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`\n--     \n-- \n\nselect * except(_dbt_source_relation) from \n\n\n        (\n            select\n                cast('`dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`' as STRING) as _dbt_source_relation,\n\n                \n                    cast(`album_id` as STRING) as `album_id` ,\n                    cast(`album_name` as STRING) as `album_name` ,\n                    cast(`album_release_year` as INT64) as `album_release_year` ,\n                    cast(`album_type` as STRING) as `album_type` \n\n            from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('`dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`' as STRING) as _dbt_source_relation,\n\n                \n                    cast(`album_id` as STRING) as `album_id` ,\n                    cast(`album_name` as STRING) as `album_name` ,\n                    cast(`album_release_year` as INT64) as `album_release_year` ,\n                    cast(`album_type` as STRING) as `album_type` \n\n            from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`\n\n            \n        )\n\n        \nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 148, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 68, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system.sql)\n  Queries in UNION ALL have mismatched column count; query 1 has 4 columns, query 2 has 5 columns at [44:13]', 'raw_code': '-- albums table\n-- {% set tables = [\'stg_songplays\', \'stg_top_tracks\'] %}\n\n-- {% for table in tables %}\n--     select distinct\n--         album_id,\n--         album_name,\n--         album_release_year,\n--         album_type                                   \n--     from {{ ref(table) }}\n--     {% if not loop.last -%} union {%- endif %}\n-- {% endfor %}\n\nselect * except(_dbt_source_relation) from \n{{ dbt_utils.union_relations(\n    relations=[ref(\'stg_songplays\'), ref(\'stg_top_tracks\')],\n    include=["album_id","album_name","album_release_year","album_type"]\n) }}\nlimit 500\n/* limit added automatically by dbt cloud */', 'compiled_code': "-- albums table\n-- \n\n-- \n--     select distinct\n--         album_id,\n--         album_name,\n--         album_release_year,\n--         album_type                                   \n--     from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`\n--     union\n-- \n--     select distinct\n--         album_id,\n--         album_name,\n--         album_release_year,\n--         album_type                                   \n--     from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`\n--     \n-- \n\nselect * except(_dbt_source_relation) from \n\n\n        (\n            select\n                cast('`dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`' as STRING) as _dbt_source_relation,\n\n                \n                    cast(`album_id` as STRING) as `album_id` ,\n                    cast(`album_name` as STRING) as `album_name` ,\n                    cast(`album_release_year` as INT64) as `album_release_year` ,\n                    cast(`album_type` as STRING) as `album_type` \n\n            from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('`dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`' as STRING) as _dbt_source_relation,\n\n                \n                    cast(`album_id` as STRING) as `album_id` ,\n                    cast(`album_name` as STRING) as `album_name` ,\n                    cast(`album_release_year` as INT64) as `album_release_year` ,\n                    cast(`album_type` as STRING) as `album_type` \n\n            from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`\n\n            \n        )\n\n        \nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-12-25 17:46:43.224507 (Thread-224): handling poll request
2022-12-25 17:46:43.224843 (Thread-224): 17:46:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe025bd60>]}
2022-12-25 17:46:43.225551 (Thread-224): sending response (<Response 16963 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:46:44.420476 (Thread-225): handling poll request
2022-12-25 17:46:44.420882 (Thread-225): 17:46:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe025bd60>]}
2022-12-25 17:46:44.448720 (Thread-225): sending response (<Response 21372 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:47:04.988762 (Thread-226): handling status request
2022-12-25 17:47:04.989187 (Thread-226): 17:47:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe02552e0>]}
2022-12-25 17:47:04.989814 (Thread-226): sending response (<Response 3236 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:47:05.170884 (Thread-227): handling run_sql request
2022-12-25 17:47:05.171264 (Thread-227): 17:47:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe02553d0>]}
2022-12-25 17:47:07.763386 (Thread-227): sending response (<Response 140 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:47:07.815663 (MainThread): 17:47:07  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c325a5c5-5e2a-41b2-b1f7-1521cb3cb16b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37a07231f0>]}
2022-12-25 17:47:07.816193 (MainThread): 17:47:07  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 431 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 17:47:07.816767 (Thread-1): 17:47:07  Acquiring new bigquery connection "rpc.spotify.request"
2022-12-25 17:47:07.816907 (Thread-1): 17:47:07  Began compiling node rpc.spotify.request
2022-12-25 17:47:07.816996 (Thread-1): 17:47:07  Compiling rpc.spotify.request
2022-12-25 17:47:07.828332 (Thread-1): 17:47:07  Opening a new connection, currently in state init
2022-12-25 17:47:07.939404 (Thread-228): handling poll request
2022-12-25 17:47:07.939802 (Thread-228): 17:47:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe0252430>]}
2022-12-25 17:47:07.940613 (Thread-228): sending response (<Response 2427 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:47:08.149606 (Thread-1): 17:47:08  finished collecting timing info
2022-12-25 17:47:08.149834 (Thread-1): 17:47:08  Began executing node rpc.spotify.request
2022-12-25 17:47:08.149948 (Thread-1): 17:47:08  On rpc.spotify.request: -- albums table
-- 

-- 
--     select distinct
--         album_id,
--         album_name,
--         album_release_year,
--         album_type                                   
--     from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`
--     union
-- 
--     select distinct
--         album_id,
--         album_name,
--         album_release_year,
--         album_type                                   
--     from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`
--     
-- 

select * from


        (
            select
                cast('`dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`' as STRING) as _dbt_source_relation,

                
                    cast(`album_id` as STRING) as `album_id` ,
                    cast(`album_name` as STRING) as `album_name` ,
                    cast(`album_release_year` as INT64) as `album_release_year` ,
                    cast(`album_type` as STRING) as `album_type` 

            from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`

            
        )

        union all
        

        (
            select
                cast('`dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`' as STRING) as _dbt_source_relation,

                
                    cast(`album_id` as STRING) as `album_id` ,
                    cast(`album_name` as STRING) as `album_name` ,
                    cast(`album_release_year` as INT64) as `album_release_year` ,
                    cast(`album_type` as STRING) as `album_type` 

            from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`

            
        )

        
limit 500
/* limit added automatically by dbt cloud */
2022-12-25 17:47:09.067820 (Thread-1): 17:47:09  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:ebd8dc71-7e80-4772-849d-904b8f9e93f4:US&page=queryresults
2022-12-25 17:47:09.068150 (Thread-1): 17:47:09  finished collecting timing info
2022-12-25 17:47:09.134882 (Thread-229): handling poll request
2022-12-25 17:47:09.135316 (Thread-229): 17:47:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe0252bb0>]}
2022-12-25 17:47:09.135902 (Thread-229): sending response (<Response 3951 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:47:10.336324 (Thread-230): handling poll request
2022-12-25 17:47:10.336730 (Thread-230): 17:47:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe0252b80>]}
2022-12-25 17:47:10.338007 (Thread-230): sending response (<Response 19312 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:51:39.788838 (Thread-231): handling status request
2022-12-25 17:51:39.790483 (Thread-231): 17:51:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe0252730>]}
2022-12-25 17:51:39.791098 (Thread-231): sending response (<Response 3236 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:51:39.971655 (Thread-232): handling run_sql request
2022-12-25 17:51:39.972012 (Thread-232): 17:51:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb10703190>]}
2022-12-25 17:51:42.590211 (Thread-232): sending response (<Response 140 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:51:42.645254 (MainThread): 17:51:42  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '04d773f9-7b35-4723-8675-2b124a59e595', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faeb0663160>]}
2022-12-25 17:51:42.645844 (MainThread): 17:51:42  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 431 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 17:51:42.646440 (Thread-1): 17:51:42  Acquiring new bigquery connection "rpc.spotify.request"
2022-12-25 17:51:42.646582 (Thread-1): 17:51:42  Began compiling node rpc.spotify.request
2022-12-25 17:51:42.646674 (Thread-1): 17:51:42  Compiling rpc.spotify.request
2022-12-25 17:51:42.658199 (Thread-1): 17:51:42  Opening a new connection, currently in state init
2022-12-25 17:51:42.846523 (Thread-233): handling poll request
2022-12-25 17:51:42.846991 (Thread-233): 17:51:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb10703f70>]}
2022-12-25 17:51:42.848475 (Thread-233): sending response (<Response 2427 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:51:43.046049 (Thread-1): 17:51:43  finished collecting timing info
2022-12-25 17:51:43.046255 (Thread-1): 17:51:43  Began executing node rpc.spotify.request
2022-12-25 17:51:43.046369 (Thread-1): 17:51:43  On rpc.spotify.request: -- albums table
-- 

-- 
--     select distinct
--         album_id,
--         album_name,
--         album_release_year,
--         album_type                                   
--     from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`
--     union
-- 
--     select distinct
--         album_id,
--         album_name,
--         album_release_year,
--         album_type                                   
--     from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`
--     
-- 

With cte as (
    select * from
    

        (
            select
                cast('`dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`' as STRING) as _dbt_source_relation,

                
                    cast(`album_id` as STRING) as `album_id` ,
                    cast(`album_name` as STRING) as `album_name` ,
                    cast(`album_release_year` as INT64) as `album_release_year` ,
                    cast(`album_type` as STRING) as `album_type` 

            from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`

            
        )

        union all
        

        (
            select
                cast('`dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`' as STRING) as _dbt_source_relation,

                
                    cast(`album_id` as STRING) as `album_id` ,
                    cast(`album_name` as STRING) as `album_name` ,
                    cast(`album_release_year` as INT64) as `album_release_year` ,
                    cast(`album_type` as STRING) as `album_type` 

            from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`

            
        )

        
)

select * except(_dbt_source_relation) from cte
limit 500
/* limit added automatically by dbt cloud */
2022-12-25 17:51:44.024420 (Thread-1): 17:51:44  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:caf72790-0886-44cd-9470-97783ae9b81e:US&page=queryresults
2022-12-25 17:51:44.024763 (Thread-1): 17:51:44  finished collecting timing info
2022-12-25 17:51:44.033892 (Thread-234): handling poll request
2022-12-25 17:51:44.034263 (Thread-234): 17:51:44  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe02522b0>]}
2022-12-25 17:51:44.034820 (Thread-234): sending response (<Response 4027 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:51:45.231625 (Thread-235): handling poll request
2022-12-25 17:51:45.232033 (Thread-235): 17:51:45  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe0252760>]}
2022-12-25 17:51:45.233197 (Thread-235): sending response (<Response 14167 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:52:08.043820 (Thread-236): 17:52:08  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-12-25 17:52:08.044396 (Thread-236): 17:52:08  Partial parsing: updated file: spotify://models/mart/dim_albums.sql
2022-12-25 17:52:08.051619 (Thread-236): 17:52:08  1603: static parser failed on mart/dim_albums.sql
2022-12-25 17:52:08.078178 (Thread-236): 17:52:08  1602: parser fallback to jinja rendering on mart/dim_albums.sql
2022-12-25 17:52:08.138225 (Thread-236): 17:52:08  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1047e5e0>]}
2022-12-25 17:52:08.379915 (Thread-237): handling status request
2022-12-25 17:52:08.380337 (Thread-237): 17:52:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb106cc9a0>]}
2022-12-25 17:52:08.380847 (Thread-237): sending response (<Response 1895 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:52:08.385289 (Thread-238): handling status request
2022-12-25 17:52:08.385552 (Thread-238): 17:52:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb106ccdf0>]}
2022-12-25 17:52:08.385955 (Thread-238): sending response (<Response 1895 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:53:48.844627 (Thread-239): handling status request
2022-12-25 17:53:48.845589 (Thread-239): 17:53:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb104b6940>]}
2022-12-25 17:53:48.846113 (Thread-239): sending response (<Response 1895 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:53:49.024117 (Thread-240): handling run_sql request
2022-12-25 17:53:49.024534 (Thread-240): 17:53:49  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb10439040>]}
2022-12-25 17:53:51.637390 (Thread-240): sending response (<Response 140 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:53:51.657334 (MainThread): dbt runtime exception
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 510, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 537, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 1105, in from_string
    return cls.from_code(self, self.compile(source), gs, None)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 768, in compile
    self.handle_exception(source=source_hint)
  File "/usr/local/lib/python3.8/dist-packages/jinja2/environment.py", line 936, in handle_exception
    raise rewrite_traceback_stack(source=source)
  File "<unknown>", line 17, in template
jinja2.exceptions.TemplateSyntaxError: expected token ',', got 'stg_top_tracks'
  line 17
    relations=[ref('stg_songplays'), ref('stg_top_artists), ref('stg_top_tracks')],

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/task_handler.py", line 102, in task_exec
    result = self.task.handle_request()
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 166, in handle_request
    node = self._get_exec_node()
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 125, in _get_exec_node
    rpc_node = rpc_parser.parse_remote(sql, self.args.name, self.args.language)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/parser/rpc.py", line 47, in parse_remote
    return self.parse_node(contents)
  File "/usr/local/lib/python3.8/dist-packages/dbt/parser/base.py", line 388, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/dist-packages/dbt/parser/base.py", line 363, in render_update
    context = self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/dist-packages/dbt/parser/base.py", line 242, in render_with_context
    get_rendered(parsed_node.raw_code, context, parsed_node, capture_macros=True)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 580, in get_rendered
    template = get_template(
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 537, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/clients/jinja.py", line 513, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in rpc request (from remote system.sql)
  expected token ',', got 'stg_top_tracks'
    line 17
      relations=[ref('stg_songplays'), ref('stg_top_artists), ref('stg_top_tracks')],
2022-12-25 17:53:51.871877 (Thread-241): handling poll request
2022-12-25 17:53:51.872357 (Thread-241): 17:53:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb104d7eb0>]}
2022-12-25 17:53:51.873142 (Thread-241): sending response (<Response 3622 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:53:53.081871 (Thread-242): handling poll request
2022-12-25 17:53:53.082317 (Thread-242): 17:53:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb104d76d0>]}
2022-12-25 17:53:53.082869 (Thread-242): sending response (<Response 4648 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:54:24.754381 (Thread-243): handling status request
2022-12-25 17:54:24.754788 (Thread-243): 17:54:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb104d7bb0>]}
2022-12-25 17:54:24.755357 (Thread-243): sending response (<Response 1895 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:54:24.933397 (Thread-244): handling run_sql request
2022-12-25 17:54:24.933828 (Thread-244): 17:54:24  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1048dd30>]}
2022-12-25 17:54:27.543173 (Thread-244): sending response (<Response 140 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:54:27.598496 (MainThread): 17:54:27  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c95dd59c-3e44-4f0a-ac53-817e0212f994', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72107831f0>]}
2022-12-25 17:54:27.599060 (MainThread): 17:54:27  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 431 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 17:54:27.599665 (Thread-1): 17:54:27  Acquiring new bigquery connection "rpc.spotify.request"
2022-12-25 17:54:27.599802 (Thread-1): 17:54:27  Began compiling node rpc.spotify.request
2022-12-25 17:54:27.599891 (Thread-1): 17:54:27  Compiling rpc.spotify.request
2022-12-25 17:54:27.611868 (Thread-1): 17:54:27  Opening a new connection, currently in state init
2022-12-25 17:54:27.811847 (Thread-245): handling poll request
2022-12-25 17:54:27.812318 (Thread-245): 17:54:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb106e7940>]}
2022-12-25 17:54:27.813165 (Thread-245): sending response (<Response 2427 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:54:28.091476 (Thread-1): 17:54:28  finished collecting timing info
2022-12-25 17:54:28.091688 (Thread-1): 17:54:28  Began executing node rpc.spotify.request
2022-12-25 17:54:28.091806 (Thread-1): 17:54:28  On rpc.spotify.request: -- albums table
-- 

-- 
--     select distinct
--         album_id,
--         album_name,
--         album_release_year,
--         album_type                                   
--     from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`
--     union
-- 
--     select distinct
--         album_id,
--         album_name,
--         album_release_year,
--         album_type                                   
--     from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`
--     
-- 

With cte as (
    select * from
    

        (
            select
                cast('`dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`' as STRING) as _dbt_source_relation,

                
                    cast(`artist_name` as STRING) as `artist_name` ,
                    cast(`artist_id` as STRING) as `artist_id` ,
                    cast(`artist_popularity` as INT64) as `artist_popularity` ,
                    cast(`artist_followers` as INT64) as `artist_followers` ,
                    cast(`artist_genre` as STRING) as `artist_genre` ,
                    cast(`artist_genre_others` as STRING) as `artist_genre_others` 

            from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`

            
        )

        union all
        

        (
            select
                cast('`dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_artists`' as STRING) as _dbt_source_relation,

                
                    cast(`artist_name` as STRING) as `artist_name` ,
                    cast(`artist_id` as STRING) as `artist_id` ,
                    cast(`artist_popularity` as INT64) as `artist_popularity` ,
                    cast(`artist_followers` as INT64) as `artist_followers` ,
                    cast(`artist_genre` as STRING) as `artist_genre` ,
                    cast(`artist_genre_others` as STRING) as `artist_genre_others` 

            from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_artists`

            
        )

        union all
        

        (
            select
                cast('`dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`' as STRING) as _dbt_source_relation,

                
                    cast(`artist_name` as STRING) as `artist_name` ,
                    cast(`artist_id` as STRING) as `artist_id` ,
                    cast(`artist_popularity` as INT64) as `artist_popularity` ,
                    cast(`artist_followers` as INT64) as `artist_followers` ,
                    cast(`artist_genre` as STRING) as `artist_genre` ,
                    cast(`artist_genre_others` as STRING) as `artist_genre_others` 

            from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`

            
        )

        
)

select * except(_dbt_source_relation) from cte
limit 500
/* limit added automatically by dbt cloud */
2022-12-25 17:54:29.010397 (Thread-246): handling poll request
2022-12-25 17:54:29.010810 (Thread-246): 17:54:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb106e7c10>]}
2022-12-25 17:54:29.011398 (Thread-246): sending response (<Response 4286 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:54:29.038864 (Thread-1): 17:54:29  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:b4ae6139-6db3-4f04-8ff9-791374c69ec8:US&page=queryresults
2022-12-25 17:54:29.039293 (Thread-1): 17:54:29  finished collecting timing info
2022-12-25 17:54:30.208043 (Thread-247): handling poll request
2022-12-25 17:54:30.208517 (Thread-247): 17:54:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe0255c10>]}
2022-12-25 17:54:30.210108 (Thread-247): sending response (<Response 27210 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:55:13.292255 (Thread-248): handling status request
2022-12-25 17:55:13.292669 (Thread-248): 17:55:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1047e940>]}
2022-12-25 17:55:13.293201 (Thread-248): sending response (<Response 1895 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:55:13.474052 (Thread-249): handling run_sql request
2022-12-25 17:55:13.474448 (Thread-249): 17:55:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1047ef10>]}
2022-12-25 17:55:16.060688 (Thread-249): sending response (<Response 140 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:55:16.114092 (MainThread): 17:55:16  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7de96282-ff7f-4e23-9286-e0c0cf272484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde08201340>]}
2022-12-25 17:55:16.114615 (MainThread): 17:55:16  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 431 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 17:55:16.115198 (Thread-1): 17:55:16  Acquiring new bigquery connection "rpc.spotify.request"
2022-12-25 17:55:16.115341 (Thread-1): 17:55:16  Began compiling node rpc.spotify.request
2022-12-25 17:55:16.115433 (Thread-1): 17:55:16  Compiling rpc.spotify.request
2022-12-25 17:55:16.126964 (Thread-1): 17:55:16  Opening a new connection, currently in state init
2022-12-25 17:55:16.354733 (Thread-250): handling poll request
2022-12-25 17:55:16.355236 (Thread-250): 17:55:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1047e850>]}
2022-12-25 17:55:16.356106 (Thread-250): sending response (<Response 2426 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:55:16.598636 (Thread-1): 17:55:16  finished collecting timing info
2022-12-25 17:55:16.598846 (Thread-1): 17:55:16  Began executing node rpc.spotify.request
2022-12-25 17:55:16.598962 (Thread-1): 17:55:16  On rpc.spotify.request: -- albums table
-- 

-- 
--     select distinct
--         album_id,
--         album_name,
--         album_release_year,
--         album_type                                   
--     from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`
--     union
-- 
--     select distinct
--         album_id,
--         album_name,
--         album_release_year,
--         album_type                                   
--     from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`
--     
-- 

With cte as (
    select * from
    

        (
            select
                cast('`dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`' as STRING) as _dbt_source_relation,

                
                    cast(`artist_name` as STRING) as `artist_name` ,
                    cast(`artist_id` as STRING) as `artist_id` ,
                    cast(`artist_popularity` as INT64) as `artist_popularity` ,
                    cast(`artist_followers` as INT64) as `artist_followers` ,
                    cast(`artist_genre` as STRING) as `artist_genre` ,
                    cast(`artist_genre_others` as STRING) as `artist_genre_others` 

            from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`

            
        )

        union all
        

        (
            select
                cast('`dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_artists`' as STRING) as _dbt_source_relation,

                
                    cast(`artist_name` as STRING) as `artist_name` ,
                    cast(`artist_id` as STRING) as `artist_id` ,
                    cast(`artist_popularity` as INT64) as `artist_popularity` ,
                    cast(`artist_followers` as INT64) as `artist_followers` ,
                    cast(`artist_genre` as STRING) as `artist_genre` ,
                    cast(`artist_genre_others` as STRING) as `artist_genre_others` 

            from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_artists`

            
        )

        union all
        

        (
            select
                cast('`dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`' as STRING) as _dbt_source_relation,

                
                    cast(`artist_name` as STRING) as `artist_name` ,
                    cast(`artist_id` as STRING) as `artist_id` ,
                    cast(`artist_popularity` as INT64) as `artist_popularity` ,
                    cast(`artist_followers` as INT64) as `artist_followers` ,
                    cast(`artist_genre` as STRING) as `artist_genre` ,
                    cast(`artist_genre_others` as STRING) as `artist_genre_others` 

            from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`

            
        )

        
)

select distinct * except(_dbt_source_relation) from cte
limit 500
/* limit added automatically by dbt cloud */
2022-12-25 17:55:17.548781 (Thread-251): handling poll request
2022-12-25 17:55:17.549191 (Thread-251): 17:55:17  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1047c280>]}
2022-12-25 17:55:17.549778 (Thread-251): sending response (<Response 4295 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:55:17.765352 (Thread-1): 17:55:17  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:7bd6a3e4-f814-4e46-ba28-1c9f36d2caf2:US&page=queryresults
2022-12-25 17:55:17.765745 (Thread-1): 17:55:17  finished collecting timing info
2022-12-25 17:55:18.751777 (Thread-252): handling poll request
2022-12-25 17:55:18.752199 (Thread-252): 17:55:18  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1047c670>]}
2022-12-25 17:55:18.753569 (Thread-252): sending response (<Response 23002 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:56:39.143251 (Thread-253): handling status request
2022-12-25 17:56:39.144969 (Thread-253): 17:56:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1047c880>]}
2022-12-25 17:56:39.145511 (Thread-253): sending response (<Response 1895 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:56:39.328825 (Thread-254): handling run_sql request
2022-12-25 17:56:39.329199 (Thread-254): 17:56:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1047c820>]}
2022-12-25 17:56:41.962396 (Thread-254): sending response (<Response 140 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:56:41.996317 (MainThread): 17:56:41  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '954ed46b-8be8-4203-b724-0cc59e843a6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f169c431370>]}
2022-12-25 17:56:41.996870 (MainThread): 17:56:41  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 431 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 17:56:41.997457 (Thread-1): 17:56:41  Acquiring new bigquery connection "rpc.spotify.request"
2022-12-25 17:56:41.997600 (Thread-1): 17:56:41  Began compiling node rpc.spotify.request
2022-12-25 17:56:41.997726 (Thread-1): 17:56:41  Compiling rpc.spotify.request
2022-12-25 17:56:42.001423 (Thread-1): 17:56:42  finished collecting timing info
2022-12-25 17:56:42.001562 (Thread-1): 17:56:42  Began executing node rpc.spotify.request
2022-12-25 17:56:42.001698 (Thread-1): 17:56:42  Opening a new connection, currently in state init
2022-12-25 17:56:42.006198 (Thread-1): 17:56:42  On rpc.spotify.request: -- tracks table



    select distinct
        track_id,
        track_name,
        track_duration,
        track_is_explicit,
        track_popularity,
        track_danceability,
        track_energy,
        track_key,
        track_loudness,
        track_mode,
        track_speechiness,
        track_acousticness,
        track_instrumentalness,
        track_liveness,
        track_valence
    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`
    union

    select distinct
        track_id,
        track_name,
        track_duration,
        track_is_explicit,
        track_popularity,
        track_danceability,
        track_energy,
        track_key,
        track_loudness,
        track_mode,
        track_speechiness,
        track_acousticness,
        track_instrumentalness,
        track_liveness,
        track_valence
    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`
    

limit 500
/* limit added automatically by dbt cloud */
2022-12-25 17:56:42.161318 (Thread-255): handling poll request
2022-12-25 17:56:42.161861 (Thread-255): 17:56:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1047cac0>]}
2022-12-25 17:56:42.204449 (Thread-255): sending response (<Response 4427 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:56:42.221833 (Thread-1): 17:56:42  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [24:5]')
2022-12-25 17:56:42.859639 (Thread-1): 17:56:42  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:US:5de49384-1de5-4d97-9f3a-56f19e765582&page=queryresults
2022-12-25 17:56:42.859841 (Thread-1): 17:56:42  finished collecting timing info
2022-12-25 17:56:42.859963 (Thread-1): Got an exception: Database Error
  Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [24:5]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 207, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 646, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 429, in fn
    return self._query_and_results(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 631, in _query_and_results
    iterator = query_job.result(timeout=job_execution_timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1303, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 679, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [24:5]

(job ID: 5de49384-1de5-4d97-9f3a-56f19e765582)

                 -----Query Job SQL Follows-----                 

    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:-- tracks table
   2:
   3:
   4:
   5:    select distinct
   6:        track_id,
   7:        track_name,
   8:        track_duration,
   9:        track_is_explicit,
  10:        track_popularity,
  11:        track_danceability,
  12:        track_energy,
  13:        track_key,
  14:        track_loudness,
  15:        track_mode,
  16:        track_speechiness,
  17:        track_acousticness,
  18:        track_instrumentalness,
  19:        track_liveness,
  20:        track_valence
  21:    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`
  22:    union
  23:
  24:    select distinct
  25:        track_id,
  26:        track_name,
  27:        track_duration,
  28:        track_is_explicit,
  29:        track_popularity,
  30:        track_danceability,
  31:        track_energy,
  32:        track_key,
  33:        track_loudness,
  34:        track_mode,
  35:        track_speechiness,
  36:        track_acousticness,
  37:        track_instrumentalness,
  38:        track_liveness,
  39:        track_valence
  40:    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`
  41:    
  42:
  43:limit 500
  44:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 385, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 338, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 429, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 108, in execute
    _, execute_result = self.adapter.execute(compiled_sql, fetch=True)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 278, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 446, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 437, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 646, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 211, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 199, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [24:5]
2022-12-25 17:56:42.861893 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system.sql)\n  Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [24:5]', 'raw_code': "-- tracks table\r\n{% set tables = ['stg_songplays', 'stg_top_tracks'] %}\r\n\r\n{% for table in tables %}\r\n    select distinct\r\n        track_id,\r\n        track_name,\r\n        track_duration,\r\n        track_is_explicit,\r\n        track_popularity,\r\n        track_danceability,\r\n        track_energy,\r\n        track_key,\r\n        track_loudness,\r\n        track_mode,\r\n        track_speechiness,\r\n        track_acousticness,\r\n        track_instrumentalness,\r\n        track_liveness,\r\n        track_valence\r\n    from {{ ref(table) }}\r\n    {% if not loop.last -%} union {%- endif %}\r\n{% endfor %}\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_code': '-- tracks table\n\n\n\n    select distinct\n        track_id,\n        track_name,\n        track_duration,\n        track_is_explicit,\n        track_popularity,\n        track_danceability,\n        track_energy,\n        track_key,\n        track_loudness,\n        track_mode,\n        track_speechiness,\n        track_acousticness,\n        track_instrumentalness,\n        track_liveness,\n        track_valence\n    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`\n    union\n\n    select distinct\n        track_id,\n        track_name,\n        track_duration,\n        track_is_explicit,\n        track_popularity,\n        track_danceability,\n        track_energy,\n        track_key,\n        track_loudness,\n        track_mode,\n        track_speechiness,\n        track_acousticness,\n        track_instrumentalness,\n        track_liveness,\n        track_valence\n    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`\n    \n\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 148, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 68, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system.sql)\n  Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [24:5]', 'raw_code': "-- tracks table\r\n{% set tables = ['stg_songplays', 'stg_top_tracks'] %}\r\n\r\n{% for table in tables %}\r\n    select distinct\r\n        track_id,\r\n        track_name,\r\n        track_duration,\r\n        track_is_explicit,\r\n        track_popularity,\r\n        track_danceability,\r\n        track_energy,\r\n        track_key,\r\n        track_loudness,\r\n        track_mode,\r\n        track_speechiness,\r\n        track_acousticness,\r\n        track_instrumentalness,\r\n        track_liveness,\r\n        track_valence\r\n    from {{ ref(table) }}\r\n    {% if not loop.last -%} union {%- endif %}\r\n{% endfor %}\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_code': '-- tracks table\n\n\n\n    select distinct\n        track_id,\n        track_name,\n        track_duration,\n        track_is_explicit,\n        track_popularity,\n        track_danceability,\n        track_energy,\n        track_key,\n        track_loudness,\n        track_mode,\n        track_speechiness,\n        track_acousticness,\n        track_instrumentalness,\n        track_liveness,\n        track_valence\n    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`\n    union\n\n    select distinct\n        track_id,\n        track_name,\n        track_duration,\n        track_is_explicit,\n        track_popularity,\n        track_danceability,\n        track_energy,\n        track_key,\n        track_loudness,\n        track_mode,\n        track_speechiness,\n        track_acousticness,\n        track_instrumentalness,\n        track_liveness,\n        track_valence\n    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`\n    \n\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2022-12-25 17:56:43.396632 (Thread-256): handling poll request
2022-12-25 17:56:43.397070 (Thread-256): 17:56:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb10482b80>]}
2022-12-25 17:56:43.397761 (Thread-256): sending response (<Response 17442 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:57:04.921542 (Thread-257): 17:57:04  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-12-25 17:57:04.922190 (Thread-257): 17:57:04  Partial parsing: updated file: spotify://models/mart/dim_albums.sql
2022-12-25 17:57:05.126368 (Thread-257): 17:57:05  1603: static parser failed on mart/dim_albums.sql
2022-12-25 17:57:05.131882 (Thread-257): 17:57:05  1602: parser fallback to jinja rendering on mart/dim_albums.sql
2022-12-25 17:57:05.196863 (Thread-257): 17:57:05  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe0077a60>]}
2022-12-25 17:57:05.394168 (Thread-258): handling status request
2022-12-25 17:57:05.394586 (Thread-258): 17:57:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb103112b0>]}
2022-12-25 17:57:05.395079 (Thread-258): sending response (<Response 1895 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:57:05.421385 (Thread-259): handling status request
2022-12-25 17:57:05.421743 (Thread-259): 17:57:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb10311190>]}
2022-12-25 17:57:05.422193 (Thread-259): sending response (<Response 1895 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:57:28.782099 (Thread-260): handling status request
2022-12-25 17:57:28.782521 (Thread-260): 17:57:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb10499730>]}
2022-12-25 17:57:28.783007 (Thread-260): sending response (<Response 1895 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:57:29.001199 (Thread-261): handling cli_args request
2022-12-25 17:57:29.001553 (Thread-261): 17:57:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb10298fa0>]}
2022-12-25 17:57:29.042394 (Thread-262): handling status request
2022-12-25 17:57:29.043125 (Thread-262): 17:57:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb10298d90>]}
2022-12-25 17:57:29.043927 (Thread-262): sending response (<Response 1895 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:57:31.602560 (Thread-261): sending response (<Response 140 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:57:31.677969 (MainThread): 17:57:31  Unable to do partial parsing because config vars, config profile, or config target have changed
2022-12-25 17:57:31.678362 (MainThread): 17:57:31  Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '07f0356e-bfa8-41da-bd29-3c53af78eec8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faedf7cfa60>]}
2022-12-25 17:57:31.782725 (Thread-263): handling poll request
2022-12-25 17:57:31.783107 (Thread-263): 17:57:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb10499220>]}
2022-12-25 17:57:31.783721 (Thread-263): sending response (<Response 1095 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:57:31.818089 (MainThread): 17:57:31  Parsing macros/etc.sql
2022-12-25 17:57:31.820750 (MainThread): 17:57:31  Parsing macros/catalog.sql
2022-12-25 17:57:31.826412 (MainThread): 17:57:31  Parsing macros/adapters.sql
2022-12-25 17:57:31.846850 (MainThread): 17:57:31  Parsing macros/adapters/apply_grants.sql
2022-12-25 17:57:31.849345 (MainThread): 17:57:31  Parsing macros/materializations/seed.sql
2022-12-25 17:57:31.851907 (MainThread): 17:57:31  Parsing macros/materializations/incremental.sql
2022-12-25 17:57:31.869188 (MainThread): 17:57:31  Parsing macros/materializations/snapshot.sql
2022-12-25 17:57:31.870852 (MainThread): 17:57:31  Parsing macros/materializations/table.sql
2022-12-25 17:57:31.877725 (MainThread): 17:57:31  Parsing macros/materializations/copy.sql
2022-12-25 17:57:31.880401 (MainThread): 17:57:31  Parsing macros/materializations/view.sql
2022-12-25 17:57:31.883117 (MainThread): 17:57:31  Parsing macros/utils/intersect.sql
2022-12-25 17:57:31.883510 (MainThread): 17:57:31  Parsing macros/utils/position.sql
2022-12-25 17:57:31.884023 (MainThread): 17:57:31  Parsing macros/utils/escape_single_quotes.sql
2022-12-25 17:57:31.884551 (MainThread): 17:57:31  Parsing macros/utils/safe_cast.sql
2022-12-25 17:57:31.885135 (MainThread): 17:57:31  Parsing macros/utils/array_construct.sql
2022-12-25 17:57:31.885967 (MainThread): 17:57:31  Parsing macros/utils/datediff.sql
2022-12-25 17:57:31.887136 (MainThread): 17:57:31  Parsing macros/utils/timestamps.sql
2022-12-25 17:57:31.888221 (MainThread): 17:57:31  Parsing macros/utils/array_concat.sql
2022-12-25 17:57:31.888726 (MainThread): 17:57:31  Parsing macros/utils/right.sql
2022-12-25 17:57:31.889328 (MainThread): 17:57:31  Parsing macros/utils/array_append.sql
2022-12-25 17:57:31.890170 (MainThread): 17:57:31  Parsing macros/utils/split_part.sql
2022-12-25 17:57:31.891454 (MainThread): 17:57:31  Parsing macros/utils/date_trunc.sql
2022-12-25 17:57:31.891983 (MainThread): 17:57:31  Parsing macros/utils/hash.sql
2022-12-25 17:57:31.892475 (MainThread): 17:57:31  Parsing macros/utils/except.sql
2022-12-25 17:57:31.892829 (MainThread): 17:57:31  Parsing macros/utils/bool_or.sql
2022-12-25 17:57:31.893251 (MainThread): 17:57:31  Parsing macros/utils/dateadd.sql
2022-12-25 17:57:31.893882 (MainThread): 17:57:31  Parsing macros/utils/listagg.sql
2022-12-25 17:57:31.894840 (MainThread): 17:57:31  Parsing macros/etc/statement.sql
2022-12-25 17:57:31.899948 (MainThread): 17:57:31  Parsing macros/etc/datetime.sql
2022-12-25 17:57:31.908163 (MainThread): 17:57:31  Parsing macros/adapters/apply_grants.sql
2022-12-25 17:57:31.921565 (MainThread): 17:57:31  Parsing macros/adapters/freshness.sql
2022-12-25 17:57:31.923499 (MainThread): 17:57:31  Parsing macros/adapters/columns.sql
2022-12-25 17:57:31.932843 (MainThread): 17:57:31  Parsing macros/adapters/timestamps.sql
2022-12-25 17:57:31.936294 (MainThread): 17:57:31  Parsing macros/adapters/relation.sql
2022-12-25 17:57:31.951119 (MainThread): 17:57:31  Parsing macros/adapters/schema.sql
2022-12-25 17:57:31.953306 (MainThread): 17:57:31  Parsing macros/adapters/persist_docs.sql
2022-12-25 17:57:31.957782 (MainThread): 17:57:31  Parsing macros/adapters/metadata.sql
2022-12-25 17:57:31.964626 (MainThread): 17:57:31  Parsing macros/adapters/indexes.sql
2022-12-25 17:57:31.967318 (MainThread): 17:57:31  Parsing macros/get_custom_name/get_custom_database.sql
2022-12-25 17:57:31.968820 (MainThread): 17:57:31  Parsing macros/get_custom_name/get_custom_schema.sql
2022-12-25 17:57:31.971189 (MainThread): 17:57:31  Parsing macros/get_custom_name/get_custom_alias.sql
2022-12-25 17:57:31.972830 (MainThread): 17:57:31  Parsing macros/python_model/python.sql
2022-12-25 17:57:31.978646 (MainThread): 17:57:31  Parsing macros/materializations/hooks.sql
2022-12-25 17:57:31.982389 (MainThread): 17:57:31  Parsing macros/materializations/configs.sql
2022-12-25 17:57:31.984613 (MainThread): 17:57:31  Parsing macros/materializations/seeds/seed.sql
2022-12-25 17:57:31.991508 (MainThread): 17:57:31  Parsing macros/materializations/seeds/helpers.sql
2022-12-25 17:57:32.009053 (MainThread): 17:57:32  Parsing macros/materializations/tests/test.sql
2022-12-25 17:57:32.013484 (MainThread): 17:57:32  Parsing macros/materializations/tests/helpers.sql
2022-12-25 17:57:32.015249 (MainThread): 17:57:32  Parsing macros/materializations/tests/where_subquery.sql
2022-12-25 17:57:32.016970 (MainThread): 17:57:32  Parsing macros/materializations/models/view/helpers.sql
2022-12-25 17:57:32.018292 (MainThread): 17:57:32  Parsing macros/materializations/models/view/create_or_replace_view.sql
2022-12-25 17:57:32.021403 (MainThread): 17:57:32  Parsing macros/materializations/models/view/create_view_as.sql
2022-12-25 17:57:32.023750 (MainThread): 17:57:32  Parsing macros/materializations/models/view/view.sql
2022-12-25 17:57:32.028976 (MainThread): 17:57:32  Parsing macros/materializations/models/incremental/strategies.sql
2022-12-25 17:57:32.035752 (MainThread): 17:57:32  Parsing macros/materializations/models/incremental/column_helpers.sql
2022-12-25 17:57:32.043558 (MainThread): 17:57:32  Parsing macros/materializations/models/incremental/incremental.sql
2022-12-25 17:57:32.054096 (MainThread): 17:57:32  Parsing macros/materializations/models/incremental/on_schema_change.sql
2022-12-25 17:57:32.070084 (MainThread): 17:57:32  Parsing macros/materializations/models/incremental/is_incremental.sql
2022-12-25 17:57:32.071522 (MainThread): 17:57:32  Parsing macros/materializations/models/incremental/merge.sql
2022-12-25 17:57:32.086067 (MainThread): 17:57:32  Parsing macros/materializations/models/table/create_table_as.sql
2022-12-25 17:57:32.089426 (MainThread): 17:57:32  Parsing macros/materializations/models/table/table.sql
2022-12-25 17:57:32.094832 (MainThread): 17:57:32  Parsing macros/materializations/snapshots/strategies.sql
2022-12-25 17:57:32.111003 (MainThread): 17:57:32  Parsing macros/materializations/snapshots/snapshot_merge.sql
2022-12-25 17:57:32.112587 (MainThread): 17:57:32  Parsing macros/materializations/snapshots/snapshot.sql
2022-12-25 17:57:32.123773 (MainThread): 17:57:32  Parsing macros/materializations/snapshots/helpers.sql
2022-12-25 17:57:32.136145 (MainThread): 17:57:32  Parsing macros/generic_test_sql/not_null.sql
2022-12-25 17:57:32.136949 (MainThread): 17:57:32  Parsing macros/generic_test_sql/relationships.sql
2022-12-25 17:57:32.137825 (MainThread): 17:57:32  Parsing macros/generic_test_sql/unique.sql
2022-12-25 17:57:32.138483 (MainThread): 17:57:32  Parsing macros/generic_test_sql/accepted_values.sql
2022-12-25 17:57:32.139779 (MainThread): 17:57:32  Parsing macros/utils/intersect.sql
2022-12-25 17:57:32.140592 (MainThread): 17:57:32  Parsing macros/utils/position.sql
2022-12-25 17:57:32.141799 (MainThread): 17:57:32  Parsing macros/utils/escape_single_quotes.sql
2022-12-25 17:57:32.142984 (MainThread): 17:57:32  Parsing macros/utils/safe_cast.sql
2022-12-25 17:57:32.144074 (MainThread): 17:57:32  Parsing macros/utils/array_construct.sql
2022-12-25 17:57:32.145528 (MainThread): 17:57:32  Parsing macros/utils/cast_bool_to_text.sql
2022-12-25 17:57:32.146713 (MainThread): 17:57:32  Parsing macros/utils/datediff.sql
2022-12-25 17:57:32.147919 (MainThread): 17:57:32  Parsing macros/utils/concat.sql
2022-12-25 17:57:32.148874 (MainThread): 17:57:32  Parsing macros/utils/length.sql
2022-12-25 17:57:32.149869 (MainThread): 17:57:32  Parsing macros/utils/any_value.sql
2022-12-25 17:57:32.150795 (MainThread): 17:57:32  Parsing macros/utils/data_types.sql
2022-12-25 17:57:32.157901 (MainThread): 17:57:32  Parsing macros/utils/array_concat.sql
2022-12-25 17:57:32.158947 (MainThread): 17:57:32  Parsing macros/utils/right.sql
2022-12-25 17:57:32.160029 (MainThread): 17:57:32  Parsing macros/utils/array_append.sql
2022-12-25 17:57:32.161058 (MainThread): 17:57:32  Parsing macros/utils/last_day.sql
2022-12-25 17:57:32.162958 (MainThread): 17:57:32  Parsing macros/utils/split_part.sql
2022-12-25 17:57:32.164941 (MainThread): 17:57:32  Parsing macros/utils/date_trunc.sql
2022-12-25 17:57:32.165989 (MainThread): 17:57:32  Parsing macros/utils/literal.sql
2022-12-25 17:57:32.167148 (MainThread): 17:57:32  Parsing macros/utils/hash.sql
2022-12-25 17:57:32.168210 (MainThread): 17:57:32  Parsing macros/utils/except.sql
2022-12-25 17:57:32.169003 (MainThread): 17:57:32  Parsing macros/utils/bool_or.sql
2022-12-25 17:57:32.169943 (MainThread): 17:57:32  Parsing macros/utils/replace.sql
2022-12-25 17:57:32.171148 (MainThread): 17:57:32  Parsing macros/utils/dateadd.sql
2022-12-25 17:57:32.172480 (MainThread): 17:57:32  Parsing macros/utils/listagg.sql
2022-12-25 17:57:32.174783 (MainThread): 17:57:32  Parsing tests/generic/builtin.sql
2022-12-25 17:57:32.177763 (MainThread): 17:57:32  Parsing macros/sql/pivot.sql
2022-12-25 17:57:32.181841 (MainThread): 17:57:32  Parsing macros/sql/star.sql
2022-12-25 17:57:32.187271 (MainThread): 17:57:32  Parsing macros/sql/get_table_types_sql.sql
2022-12-25 17:57:32.188864 (MainThread): 17:57:32  Parsing macros/sql/generate_surrogate_key.sql
2022-12-25 17:57:32.191381 (MainThread): 17:57:32  Parsing macros/sql/deduplicate.sql
2022-12-25 17:57:32.195038 (MainThread): 17:57:32  Parsing macros/sql/surrogate_key.sql
2022-12-25 17:57:32.196516 (MainThread): 17:57:32  Parsing macros/sql/get_query_results_as_dict.sql
2022-12-25 17:57:32.198886 (MainThread): 17:57:32  Parsing macros/sql/date_spine.sql
2022-12-25 17:57:32.203292 (MainThread): 17:57:32  Parsing macros/sql/get_column_values.sql
2022-12-25 17:57:32.208660 (MainThread): 17:57:32  Parsing macros/sql/groupby.sql
2022-12-25 17:57:32.210029 (MainThread): 17:57:32  Parsing macros/sql/get_tables_by_pattern_sql.sql
2022-12-25 17:57:32.216467 (MainThread): 17:57:32  Parsing macros/sql/nullcheck_table.sql
2022-12-25 17:57:32.218048 (MainThread): 17:57:32  Parsing macros/sql/get_tables_by_prefix_sql.sql
2022-12-25 17:57:32.219721 (MainThread): 17:57:32  Parsing macros/sql/safe_divide.sql
2022-12-25 17:57:32.220751 (MainThread): 17:57:32  Parsing macros/sql/get_relations_by_pattern.sql
2022-12-25 17:57:32.224028 (MainThread): 17:57:32  Parsing macros/sql/get_relations_by_prefix.sql
2022-12-25 17:57:32.227396 (MainThread): 17:57:32  Parsing macros/sql/safe_add.sql
2022-12-25 17:57:32.229536 (MainThread): 17:57:32  Parsing macros/sql/haversine_distance.sql
2022-12-25 17:57:32.235170 (MainThread): 17:57:32  Parsing macros/sql/unpivot.sql
2022-12-25 17:57:32.241058 (MainThread): 17:57:32  Parsing macros/sql/generate_series.sql
2022-12-25 17:57:32.245339 (MainThread): 17:57:32  Parsing macros/sql/get_single_value.sql
2022-12-25 17:57:32.248122 (MainThread): 17:57:32  Parsing macros/sql/width_bucket.sql
2022-12-25 17:57:32.253044 (MainThread): 17:57:32  Parsing macros/sql/nullcheck.sql
2022-12-25 17:57:32.255145 (MainThread): 17:57:32  Parsing macros/sql/union.sql
2022-12-25 17:57:32.267549 (MainThread): 17:57:32  Parsing macros/sql/get_filtered_columns_in_relation.sql
2022-12-25 17:57:32.270311 (MainThread): 17:57:32  Parsing macros/jinja_helpers/pretty_time.sql
2022-12-25 17:57:32.271506 (MainThread): 17:57:32  Parsing macros/jinja_helpers/_is_relation.sql
2022-12-25 17:57:32.272573 (MainThread): 17:57:32  Parsing macros/jinja_helpers/slugify.sql
2022-12-25 17:57:32.274056 (MainThread): 17:57:32  Parsing macros/jinja_helpers/_is_ephemeral.sql
2022-12-25 17:57:32.275956 (MainThread): 17:57:32  Parsing macros/jinja_helpers/log_info.sql
2022-12-25 17:57:32.277028 (MainThread): 17:57:32  Parsing macros/jinja_helpers/pretty_log_format.sql
2022-12-25 17:57:32.278159 (MainThread): 17:57:32  Parsing macros/web/get_url_parameter.sql
2022-12-25 17:57:32.279652 (MainThread): 17:57:32  Parsing macros/web/get_url_path.sql
2022-12-25 17:57:32.282191 (MainThread): 17:57:32  Parsing macros/web/get_url_host.sql
2022-12-25 17:57:32.284132 (MainThread): 17:57:32  Parsing macros/generic_tests/expression_is_true.sql
2022-12-25 17:57:32.286022 (MainThread): 17:57:32  Parsing macros/generic_tests/not_constant.sql
2022-12-25 17:57:32.288109 (MainThread): 17:57:32  Parsing macros/generic_tests/sequential_values.sql
2022-12-25 17:57:32.291955 (MainThread): 17:57:32  Parsing macros/generic_tests/not_null_proportion.sql
2022-12-25 17:57:32.295086 (MainThread): 17:57:32  Parsing macros/generic_tests/at_least_one.sql
2022-12-25 17:57:32.297249 (MainThread): 17:57:32  Parsing macros/generic_tests/equality.sql
2022-12-25 17:57:32.300873 (MainThread): 17:57:32  Parsing macros/generic_tests/equal_rowcount.sql
2022-12-25 17:57:32.304987 (MainThread): 17:57:32  Parsing macros/generic_tests/not_accepted_values.sql
2022-12-25 17:57:32.307115 (MainThread): 17:57:32  Parsing macros/generic_tests/mutually_exclusive_ranges.sql
2022-12-25 17:57:32.315939 (MainThread): 17:57:32  Parsing macros/generic_tests/relationships_where.sql
2022-12-25 17:57:32.318078 (MainThread): 17:57:32  Parsing macros/generic_tests/not_empty_string.sql
2022-12-25 17:57:32.319829 (MainThread): 17:57:32  Parsing macros/generic_tests/accepted_range.sql
2022-12-25 17:57:32.322276 (MainThread): 17:57:32  Parsing macros/generic_tests/fewer_rows_than.sql
2022-12-25 17:57:32.326517 (MainThread): 17:57:32  Parsing macros/generic_tests/unique_combination_of_columns.sql
2022-12-25 17:57:32.329194 (MainThread): 17:57:32  Parsing macros/generic_tests/recency.sql
2022-12-25 17:57:32.332599 (MainThread): 17:57:32  Parsing macros/generic_tests/cardinality_equality.sql
2022-12-25 17:57:32.781758 (MainThread): 17:57:32  1699: static parser successfully parsed mart/fct_top_tracks.sql
2022-12-25 17:57:32.793602 (MainThread): 17:57:32  1699: static parser successfully parsed mart/fct_songplays.sql
2022-12-25 17:57:32.796323 (MainThread): 17:57:32  1699: static parser successfully parsed mart/fct_top_artists.sql
2022-12-25 17:57:32.799060 (MainThread): 17:57:32  1603: static parser failed on mart/dim_artists.sql
2022-12-25 17:57:32.803818 (MainThread): 17:57:32  1602: parser fallback to jinja rendering on mart/dim_artists.sql
2022-12-25 17:57:32.805236 (MainThread): 17:57:32  1603: static parser failed on mart/dim_albums.sql
2022-12-25 17:57:32.810308 (MainThread): 17:57:32  1602: parser fallback to jinja rendering on mart/dim_albums.sql
2022-12-25 17:57:32.811576 (MainThread): 17:57:32  1603: static parser failed on mart/dim_tracks.sql
2022-12-25 17:57:32.816237 (MainThread): 17:57:32  1602: parser fallback to jinja rendering on mart/dim_tracks.sql
2022-12-25 17:57:32.817523 (MainThread): 17:57:32  1699: static parser successfully parsed staging/stg_top_tracks.sql
2022-12-25 17:57:32.820282 (MainThread): 17:57:32  1699: static parser successfully parsed staging/stg_songplays.sql
2022-12-25 17:57:32.822977 (MainThread): 17:57:32  1699: static parser successfully parsed staging/stg_top_artists.sql
2022-12-25 17:57:32.826373 (MainThread): 17:57:32  1699: static parser successfully parsed view/vw_top_track_genres.sql
2022-12-25 17:57:32.829228 (MainThread): 17:57:32  1699: static parser successfully parsed view/vw_top_artist_genres.sql
2022-12-25 17:57:32.832267 (MainThread): 17:57:32  1699: static parser successfully parsed view/vw_songplays_genres.sql
2022-12-25 17:57:32.835309 (MainThread): 17:57:32  1699: static parser successfully parsed view/vw_songplays_albums.sql
2022-12-25 17:57:32.968673 (Thread-264): handling poll request
2022-12-25 17:57:32.969067 (Thread-264): 17:57:32  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe00c3610>]}
2022-12-25 17:57:32.971429 (Thread-264): sending response (<Response 47772 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:57:33.103751 (MainThread): 17:57:33  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07f0356e-bfa8-41da-bd29-3c53af78eec8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faedc0e1370>]}
2022-12-25 17:57:33.133821 (MainThread): 17:57:33  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07f0356e-bfa8-41da-bd29-3c53af78eec8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faedf6a0be0>]}
2022-12-25 17:57:33.134188 (MainThread): 17:57:33  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 431 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 17:57:33.134311 (MainThread): 17:57:33  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07f0356e-bfa8-41da-bd29-3c53af78eec8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faefc1fb670>]}
2022-12-25 17:57:33.136254 (MainThread): 17:57:33  
2022-12-25 17:57:33.136661 (MainThread): 17:57:33  Acquiring new bigquery connection "master"
2022-12-25 17:57:33.138191 (ThreadPoolExecutor-0_0): 17:57:33  Acquiring new bigquery connection "list_dbt-demo-data-372717"
2022-12-25 17:57:33.138342 (ThreadPoolExecutor-0_0): 17:57:33  Opening a new connection, currently in state init
2022-12-25 17:57:33.353134 (ThreadPoolExecutor-1_0): 17:57:33  Acquiring new bigquery connection "list_dbt-demo-data-372717_dbt_ddemo"
2022-12-25 17:57:33.353281 (ThreadPoolExecutor-1_0): 17:57:33  Opening a new connection, currently in state closed
2022-12-25 17:57:33.539944 (MainThread): 17:57:33  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07f0356e-bfa8-41da-bd29-3c53af78eec8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faedf7d1bb0>]}
2022-12-25 17:57:33.540567 (MainThread): 17:57:33  Concurrency: 4 threads (target='default')
2022-12-25 17:57:33.540678 (MainThread): 17:57:33  
2022-12-25 17:57:33.543336 (Thread-1): 17:57:33  Began running node model.spotify.stg_songplays
2022-12-25 17:57:33.543636 (Thread-1): 17:57:33  1 of 13 START sql view model dbt_ddemo.stg_songplays ........................... [RUN]
2022-12-25 17:57:33.544025 (Thread-1): 17:57:33  Acquiring new bigquery connection "model.spotify.stg_songplays"
2022-12-25 17:57:33.544134 (Thread-1): 17:57:33  Began compiling node model.spotify.stg_songplays
2022-12-25 17:57:33.544230 (Thread-1): 17:57:33  Compiling model.spotify.stg_songplays
2022-12-25 17:57:33.546242 (Thread-2): 17:57:33  Began running node model.spotify.stg_top_artists
2022-12-25 17:57:33.546517 (Thread-2): 17:57:33  2 of 13 START sql view model dbt_ddemo.stg_top_artists ......................... [RUN]
2022-12-25 17:57:33.546937 (Thread-2): 17:57:33  Acquiring new bigquery connection "model.spotify.stg_top_artists"
2022-12-25 17:57:33.547035 (Thread-2): 17:57:33  Began compiling node model.spotify.stg_top_artists
2022-12-25 17:57:33.547116 (Thread-2): 17:57:33  Compiling model.spotify.stg_top_artists
2022-12-25 17:57:33.550106 (Thread-2): 17:57:33  Writing injected SQL for node "model.spotify.stg_top_artists"
2022-12-25 17:57:33.550466 (Thread-3): 17:57:33  Began running node model.spotify.stg_top_tracks
2022-12-25 17:57:33.550692 (Thread-3): 17:57:33  3 of 13 START sql view model dbt_ddemo.stg_top_tracks .......................... [RUN]
2022-12-25 17:57:33.551095 (Thread-3): 17:57:33  Acquiring new bigquery connection "model.spotify.stg_top_tracks"
2022-12-25 17:57:33.551204 (Thread-3): 17:57:33  Began compiling node model.spotify.stg_top_tracks
2022-12-25 17:57:33.551285 (Thread-3): 17:57:33  Compiling model.spotify.stg_top_tracks
2022-12-25 17:57:33.554088 (Thread-3): 17:57:33  Writing injected SQL for node "model.spotify.stg_top_tracks"
2022-12-25 17:57:33.558693 (Thread-1): 17:57:33  Writing injected SQL for node "model.spotify.stg_songplays"
2022-12-25 17:57:33.565537 (Thread-2): 17:57:33  finished collecting timing info
2022-12-25 17:57:33.565704 (Thread-2): 17:57:33  Began executing node model.spotify.stg_top_artists
2022-12-25 17:57:33.571106 (Thread-3): 17:57:33  finished collecting timing info
2022-12-25 17:57:33.571251 (Thread-3): 17:57:33  Began executing node model.spotify.stg_top_tracks
2022-12-25 17:57:33.617606 (Thread-2): 17:57:33  Writing runtime sql for node "model.spotify.stg_top_artists"
2022-12-25 17:57:33.618047 (Thread-3): 17:57:33  Writing runtime sql for node "model.spotify.stg_top_tracks"
2022-12-25 17:57:33.618350 (Thread-1): 17:57:33  finished collecting timing info
2022-12-25 17:57:33.618494 (Thread-1): 17:57:33  Began executing node model.spotify.stg_songplays
2022-12-25 17:57:33.621004 (Thread-1): 17:57:33  Writing runtime sql for node "model.spotify.stg_songplays"
2022-12-25 17:57:33.629650 (Thread-2): 17:57:33  Opening a new connection, currently in state init
2022-12-25 17:57:33.633830 (Thread-3): 17:57:33  Opening a new connection, currently in state init
2022-12-25 17:57:33.634054 (Thread-1): 17:57:33  Opening a new connection, currently in state closed
2022-12-25 17:57:33.634451 (Thread-2): 17:57:33  On model.spotify.stg_top_artists: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "user", "target_name": "default", "node_id": "model.spotify.stg_top_artists"} */


  create or replace view `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_artists`
  OPTIONS()
  as -- stage_top_artists
with source as (
    select
        *
    from `dbt-demo-data-372717`.`dbt_ddemo`.`current_user_top_artists`
),

stage_top_artists as (
    select
        artist_rank,
        artist_id,
        artist_name,
        artist_popularity,
        artist_followers,
        artist_genre,
        artist_genre_others
    from source
)
select
    *
from stage_top_artists;


2022-12-25 17:57:33.638791 (Thread-1): 17:57:33  On model.spotify.stg_songplays: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "user", "target_name": "default", "node_id": "model.spotify.stg_songplays"} */


  create or replace view `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`
  OPTIONS()
  as -- stage_songplays
with source as (
    select 
        *
    from `dbt-demo-data-372717`.`dbt_ddemo`.`current_user_recently_played`
),

stage_songplays as (
    select
        songplays_id,
        track_id,
    	track_name,
        track_duration,
        track_is_explicit,
        track_popularity,
        track_played_at,
        album_id,
        album_name,
        album_release_year,
        album_type,
        artist_name,
        artist_name_others,
        artist_id,
        artist_id_others,
        track_danceability,
        track_energy,
        track_key,
        track_loudness,
        track_mode,
        track_speechiness,
        track_acousticness,
        track_instrumentalness,
        track_liveness,
        track_valence,
        artist_popularity,
        artist_followers,
        artist_genre,
        artist_genre_others
    from source
)
select
    *
from stage_songplays;


2022-12-25 17:57:33.639996 (Thread-3): 17:57:33  On model.spotify.stg_top_tracks: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "user", "target_name": "default", "node_id": "model.spotify.stg_top_tracks"} */


  create or replace view `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`
  OPTIONS()
  as -- stage_top_tracks
with source as (
    select
        *
    from `dbt-demo-data-372717`.`dbt_ddemo`.`current_user_top_tracks`
),

stage_top_tracks as (
    select
        track_rank,
        track_id,
    	track_name,
        track_duration,
        track_is_explicit,
        track_popularity,
        album_id,
        album_name,
        album_release_year,
        album_type,
        artist_name,
        artist_name_others,
        artist_id,
        artist_id_others,
        track_danceability,
        track_energy,
        track_key,
        track_loudness,
        track_mode,
        track_speechiness,
        track_acousticness,
        track_instrumentalness,
        track_liveness,
        track_valence,
        artist_popularity,
        artist_followers,
        artist_genre,
        artist_genre_others
    from source
)
select
    *
from stage_top_tracks;


2022-12-25 17:57:34.171859 (Thread-265): handling poll request
2022-12-25 17:57:34.172298 (Thread-265): 17:57:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb107d75e0>]}
2022-12-25 17:57:34.173308 (Thread-265): sending response (<Response 21043 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:57:34.201988 (Thread-1): 17:57:34  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:b1ee21d4-e824-41af-993d-49161832cd41:US&page=queryresults
2022-12-25 17:57:34.218809 (Thread-1): 17:57:34  finished collecting timing info
2022-12-25 17:57:34.219404 (Thread-1): 17:57:34  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07f0356e-bfa8-41da-bd29-3c53af78eec8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7c36a670>]}
2022-12-25 17:57:34.219881 (Thread-1): 17:57:34  1 of 13 OK created sql view model dbt_ddemo.stg_songplays ...................... [CREATE VIEW (0 processed) in 0.68s]
2022-12-25 17:57:34.220122 (Thread-1): 17:57:34  Finished running node model.spotify.stg_songplays
2022-12-25 17:57:34.220747 (Thread-4): 17:57:34  Began running node model.spotify.fct_songplays
2022-12-25 17:57:34.221005 (Thread-4): 17:57:34  4 of 13 START sql table model dbt_ddemo.fct_songplays .......................... [RUN]
2022-12-25 17:57:34.221427 (Thread-4): 17:57:34  Acquiring new bigquery connection "model.spotify.fct_songplays"
2022-12-25 17:57:34.221527 (Thread-4): 17:57:34  Began compiling node model.spotify.fct_songplays
2022-12-25 17:57:34.221611 (Thread-4): 17:57:34  Compiling model.spotify.fct_songplays
2022-12-25 17:57:34.225808 (Thread-4): 17:57:34  Writing injected SQL for node "model.spotify.fct_songplays"
2022-12-25 17:57:34.231200 (Thread-2): 17:57:34  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:bddb1857-c3a3-4e44-a7e0-0ee9b7e465ed:US&page=queryresults
2022-12-25 17:57:34.232371 (Thread-2): 17:57:34  finished collecting timing info
2022-12-25 17:57:34.232854 (Thread-2): 17:57:34  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07f0356e-bfa8-41da-bd29-3c53af78eec8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7c2ce8b0>]}
2022-12-25 17:57:34.233149 (Thread-2): 17:57:34  2 of 13 OK created sql view model dbt_ddemo.stg_top_artists .................... [CREATE VIEW (0 processed) in 0.69s]
2022-12-25 17:57:34.233341 (Thread-2): 17:57:34  Finished running node model.spotify.stg_top_artists
2022-12-25 17:57:34.233852 (Thread-1): 17:57:34  Began running node model.spotify.fct_top_artists
2022-12-25 17:57:34.234051 (Thread-1): 17:57:34  5 of 13 START sql table model dbt_ddemo.fct_top_artists ........................ [RUN]
2022-12-25 17:57:34.234399 (Thread-1): 17:57:34  Acquiring new bigquery connection "model.spotify.fct_top_artists"
2022-12-25 17:57:34.234494 (Thread-1): 17:57:34  Began compiling node model.spotify.fct_top_artists
2022-12-25 17:57:34.234576 (Thread-1): 17:57:34  Compiling model.spotify.fct_top_artists
2022-12-25 17:57:34.237219 (Thread-1): 17:57:34  Writing injected SQL for node "model.spotify.fct_top_artists"
2022-12-25 17:57:34.241785 (Thread-4): 17:57:34  finished collecting timing info
2022-12-25 17:57:34.241931 (Thread-4): 17:57:34  Began executing node model.spotify.fct_songplays
2022-12-25 17:57:34.252981 (Thread-4): 17:57:34  Opening a new connection, currently in state init
2022-12-25 17:57:34.259413 (Thread-1): 17:57:34  finished collecting timing info
2022-12-25 17:57:34.259564 (Thread-1): 17:57:34  Began executing node model.spotify.fct_top_artists
2022-12-25 17:57:34.261525 (Thread-1): 17:57:34  Opening a new connection, currently in state closed
2022-12-25 17:57:34.457549 (Thread-4): 17:57:34  Writing runtime sql for node "model.spotify.fct_songplays"
2022-12-25 17:57:34.459333 (Thread-3): 17:57:34  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:b557f80f-667d-4d7c-9433-c806ff2cdfe0:US&page=queryresults
2022-12-25 17:57:34.460701 (Thread-3): 17:57:34  finished collecting timing info
2022-12-25 17:57:34.461256 (Thread-3): 17:57:34  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07f0356e-bfa8-41da-bd29-3c53af78eec8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7c3a9280>]}
2022-12-25 17:57:34.461690 (Thread-3): 17:57:34  3 of 13 OK created sql view model dbt_ddemo.stg_top_tracks ..................... [CREATE VIEW (0 processed) in 0.91s]
2022-12-25 17:57:34.461930 (Thread-3): 17:57:34  Finished running node model.spotify.stg_top_tracks
2022-12-25 17:57:34.463950 (Thread-1): 17:57:34  Writing runtime sql for node "model.spotify.fct_top_artists"
2022-12-25 17:57:34.464201 (Thread-2): 17:57:34  Began running node model.spotify.dim_albums
2022-12-25 17:57:34.464438 (Thread-2): 17:57:34  6 of 13 START sql table model dbt_ddemo.dim_albums ............................. [RUN]
2022-12-25 17:57:34.464826 (Thread-2): 17:57:34  Acquiring new bigquery connection "model.spotify.dim_albums"
2022-12-25 17:57:34.464927 (Thread-2): 17:57:34  Began compiling node model.spotify.dim_albums
2022-12-25 17:57:34.465014 (Thread-2): 17:57:34  Compiling model.spotify.dim_albums
2022-12-25 17:57:34.468715 (Thread-2): 17:57:34  Writing injected SQL for node "model.spotify.dim_albums"
2022-12-25 17:57:34.469151 (Thread-3): 17:57:34  Began running node model.spotify.dim_artists
2022-12-25 17:57:34.469358 (Thread-3): 17:57:34  7 of 13 START sql table model dbt_ddemo.dim_artists ............................ [RUN]
2022-12-25 17:57:34.469745 (Thread-3): 17:57:34  Acquiring new bigquery connection "model.spotify.dim_artists"
2022-12-25 17:57:34.469844 (Thread-3): 17:57:34  Began compiling node model.spotify.dim_artists
2022-12-25 17:57:34.469923 (Thread-3): 17:57:34  Compiling model.spotify.dim_artists
2022-12-25 17:57:34.473585 (Thread-3): 17:57:34  Writing injected SQL for node "model.spotify.dim_artists"
2022-12-25 17:57:34.479093 (Thread-4): 17:57:34  On model.spotify.fct_songplays: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "user", "target_name": "default", "node_id": "model.spotify.fct_songplays"} */

  
    

    create or replace table `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays`
    
    
    OPTIONS()
    as (
      -- songplays table
with source as (
    select
        *
    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`
),
fact_songplays as (
    select
        songplays_id,
        track_id,
        track_played_at,
        album_id,
        artist_id,
        artist_id_others,
        artist_name_others
    from source
)
select
    *
from fact_songplays
    );
  
2022-12-25 17:57:34.486496 (Thread-2): 17:57:34  finished collecting timing info
2022-12-25 17:57:34.486650 (Thread-2): 17:57:34  Began executing node model.spotify.dim_albums
2022-12-25 17:57:34.490620 (Thread-2): 17:57:34  Writing runtime sql for node "model.spotify.dim_albums"
2022-12-25 17:57:34.490810 (Thread-3): 17:57:34  finished collecting timing info
2022-12-25 17:57:34.490952 (Thread-3): 17:57:34  Began executing node model.spotify.dim_artists
2022-12-25 17:57:34.493385 (Thread-3): 17:57:34  Writing runtime sql for node "model.spotify.dim_artists"
2022-12-25 17:57:34.493653 (Thread-1): 17:57:34  On model.spotify.fct_top_artists: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "user", "target_name": "default", "node_id": "model.spotify.fct_top_artists"} */

  
    

    create or replace table `dbt-demo-data-372717`.`dbt_ddemo`.`fct_top_artists`
    
    
    OPTIONS()
    as (
      -- top_artists table
with source as (
    select
        *
    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_artists`
),
fact_top_artists as (
    select
        artist_rank,
        artist_id
    from source
)
select
    *
from fact_top_artists
    );
  
2022-12-25 17:57:34.505562 (Thread-2): 17:57:34  Opening a new connection, currently in state closed
2022-12-25 17:57:34.506113 (Thread-3): 17:57:34  Opening a new connection, currently in state closed
2022-12-25 17:57:34.510463 (Thread-3): 17:57:34  On model.spotify.dim_artists: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "user", "target_name": "default", "node_id": "model.spotify.dim_artists"} */

  
    

    create or replace table `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists`
    
    
    OPTIONS()
    as (
      -- artists table



    select distinct
        artist_id,
        artist_name,
        artist_popularity,
        artist_followers,
        artist_genre,
        artist_genre_others                                     
    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`
    union

    select distinct
        artist_id,
        artist_name,
        artist_popularity,
        artist_followers,
        artist_genre,
        artist_genre_others                                     
    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_artists`
    union

    select distinct
        artist_id,
        artist_name,
        artist_popularity,
        artist_followers,
        artist_genre,
        artist_genre_others                                     
    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`
    

    );
  
2022-12-25 17:57:34.511206 (Thread-2): 17:57:34  On model.spotify.dim_albums: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "user", "target_name": "default", "node_id": "model.spotify.dim_albums"} */

  
    

    create or replace table `dbt-demo-data-372717`.`dbt_ddemo`.`dim_albums`
    
    
    OPTIONS()
    as (
      -- albums table



    select distinct
        album_id,
        album_name,
        album_release_year,
        album_type                                   
    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`
    union

    select distinct
        album_id,
        album_name,
        album_release_year,
        album_type                                   
    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`
    

    );
  
2022-12-25 17:57:34.692920 (Thread-2): 17:57:34  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [23:5]')
2022-12-25 17:57:34.711135 (Thread-3): 17:57:34  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [25:5]')
2022-12-25 17:57:35.108501 (Thread-3): 17:57:35  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:US:b08a91bb-ce8d-4522-82d8-e5e900889873&page=queryresults
2022-12-25 17:57:35.108751 (Thread-3): 17:57:35  finished collecting timing info
2022-12-25 17:57:35.109327 (Thread-3): 17:57:35  Database Error in model dim_artists (models/mart/dim_artists.sql)
  Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [25:5]
  compiled Code at target/run/spotify/models/mart/dim_artists.sql
2022-12-25 17:57:35.109535 (Thread-3): 17:57:35  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07f0356e-bfa8-41da-bd29-3c53af78eec8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7c20a820>]}
2022-12-25 17:57:35.109927 (Thread-3): 17:57:35  7 of 13 ERROR creating sql table model dbt_ddemo.dim_artists ................... [ERROR in 0.64s]
2022-12-25 17:57:35.110211 (Thread-3): 17:57:35  Finished running node model.spotify.dim_artists
2022-12-25 17:57:35.110384 (Thread-3): 17:57:35  Began running node model.spotify.dim_tracks
2022-12-25 17:57:35.110638 (Thread-3): 17:57:35  8 of 13 START sql table model dbt_ddemo.dim_tracks ............................. [RUN]
2022-12-25 17:57:35.111073 (Thread-3): 17:57:35  Acquiring new bigquery connection "model.spotify.dim_tracks"
2022-12-25 17:57:35.111185 (Thread-3): 17:57:35  Began compiling node model.spotify.dim_tracks
2022-12-25 17:57:35.111279 (Thread-3): 17:57:35  Compiling model.spotify.dim_tracks
2022-12-25 17:57:35.115910 (Thread-3): 17:57:35  Writing injected SQL for node "model.spotify.dim_tracks"
2022-12-25 17:57:35.127085 (Thread-3): 17:57:35  finished collecting timing info
2022-12-25 17:57:35.127246 (Thread-3): 17:57:35  Began executing node model.spotify.dim_tracks
2022-12-25 17:57:35.130018 (Thread-3): 17:57:35  Writing runtime sql for node "model.spotify.dim_tracks"
2022-12-25 17:57:35.142704 (Thread-3): 17:57:35  Opening a new connection, currently in state closed
2022-12-25 17:57:35.147076 (Thread-3): 17:57:35  On model.spotify.dim_tracks: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "user", "target_name": "default", "node_id": "model.spotify.dim_tracks"} */

  
    

    create or replace table `dbt-demo-data-372717`.`dbt_ddemo`.`dim_tracks`
    
    
    OPTIONS()
    as (
      -- tracks table



    select distinct
        track_id,
        track_name,
        track_duration,
        track_is_explicit,
        track_popularity,
        track_danceability,
        track_energy,
        track_key,
        track_loudness,
        track_mode,
        track_speechiness,
        track_acousticness,
        track_instrumentalness,
        track_liveness,
        track_valence
    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`
    union

    select distinct
        track_id,
        track_name,
        track_duration,
        track_is_explicit,
        track_popularity,
        track_danceability,
        track_energy,
        track_key,
        track_loudness,
        track_mode,
        track_speechiness,
        track_acousticness,
        track_instrumentalness,
        track_liveness,
        track_valence
    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`
    

    );
  
2022-12-25 17:57:35.356442 (Thread-3): 17:57:35  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [34:5]')
2022-12-25 17:57:35.363952 (Thread-266): handling poll request
2022-12-25 17:57:35.364307 (Thread-266): 17:57:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb107cd1c0>]}
2022-12-25 17:57:35.365675 (Thread-266): sending response (<Response 37352 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:57:35.596622 (Thread-2): 17:57:35  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:US:4bc8941d-8f33-46fb-a70b-8052343114b1&page=queryresults
2022-12-25 17:57:35.596856 (Thread-2): 17:57:35  finished collecting timing info
2022-12-25 17:57:35.597442 (Thread-2): 17:57:35  Database Error in model dim_albums (models/mart/dim_albums.sql)
  Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [23:5]
  compiled Code at target/run/spotify/models/mart/dim_albums.sql
2022-12-25 17:57:35.597730 (Thread-2): 17:57:35  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07f0356e-bfa8-41da-bd29-3c53af78eec8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7c25d850>]}
2022-12-25 17:57:35.598101 (Thread-2): 17:57:35  6 of 13 ERROR creating sql table model dbt_ddemo.dim_albums .................... [ERROR in 1.13s]
2022-12-25 17:57:35.598334 (Thread-2): 17:57:35  Finished running node model.spotify.dim_albums
2022-12-25 17:57:35.598490 (Thread-2): 17:57:35  Began running node model.spotify.fct_top_tracks
2022-12-25 17:57:35.598699 (Thread-2): 17:57:35  9 of 13 START sql table model dbt_ddemo.fct_top_tracks ......................... [RUN]
2022-12-25 17:57:35.599103 (Thread-2): 17:57:35  Acquiring new bigquery connection "model.spotify.fct_top_tracks"
2022-12-25 17:57:35.599220 (Thread-2): 17:57:35  Began compiling node model.spotify.fct_top_tracks
2022-12-25 17:57:35.599312 (Thread-2): 17:57:35  Compiling model.spotify.fct_top_tracks
2022-12-25 17:57:35.602567 (Thread-2): 17:57:35  Writing injected SQL for node "model.spotify.fct_top_tracks"
2022-12-25 17:57:35.615866 (Thread-2): 17:57:35  finished collecting timing info
2022-12-25 17:57:35.616013 (Thread-2): 17:57:35  Began executing node model.spotify.fct_top_tracks
2022-12-25 17:57:35.618068 (Thread-2): 17:57:35  Opening a new connection, currently in state closed
2022-12-25 17:57:35.833461 (Thread-2): 17:57:35  Writing runtime sql for node "model.spotify.fct_top_tracks"
2022-12-25 17:57:35.845665 (Thread-2): 17:57:35  On model.spotify.fct_top_tracks: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "user", "target_name": "default", "node_id": "model.spotify.fct_top_tracks"} */

  
    

    create or replace table `dbt-demo-data-372717`.`dbt_ddemo`.`fct_top_tracks`
    
    
    OPTIONS()
    as (
      -- top_tracks table
with source as (
    select
        *
    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`
),
fact_top_tracks as (
    select
        track_rank,
        track_id,
        album_id,
        artist_name_others,
        artist_id,
        artist_id_others
    from source
)
select
    *
from fact_top_tracks
    );
  
2022-12-25 17:57:35.961795 (Thread-3): 17:57:35  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:US:44c87337-a506-4888-a9b8-843b9dd4b9a1&page=queryresults
2022-12-25 17:57:35.961998 (Thread-3): 17:57:35  finished collecting timing info
2022-12-25 17:57:35.962516 (Thread-3): 17:57:35  Database Error in model dim_tracks (models/mart/dim_tracks.sql)
  Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [34:5]
  compiled Code at target/run/spotify/models/mart/dim_tracks.sql
2022-12-25 17:57:35.962706 (Thread-3): 17:57:35  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07f0356e-bfa8-41da-bd29-3c53af78eec8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7c1f41f0>]}
2022-12-25 17:57:35.963032 (Thread-3): 17:57:35  8 of 13 ERROR creating sql table model dbt_ddemo.dim_tracks .................... [ERROR in 0.85s]
2022-12-25 17:57:35.963294 (Thread-3): 17:57:35  Finished running node model.spotify.dim_tracks
2022-12-25 17:57:36.462490 (Thread-4): 17:57:36  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:f90add30-497e-4856-aabc-6989a7c28a0a:US&page=queryresults
2022-12-25 17:57:36.463819 (Thread-4): 17:57:36  finished collecting timing info
2022-12-25 17:57:36.464369 (Thread-4): 17:57:36  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07f0356e-bfa8-41da-bd29-3c53af78eec8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7c36a670>]}
2022-12-25 17:57:36.464718 (Thread-4): 17:57:36  4 of 13 OK created sql table model dbt_ddemo.fct_songplays ..................... [CREATE TABLE (50.0 rows, 4.5 KB processed) in 2.24s]
2022-12-25 17:57:36.464964 (Thread-4): 17:57:36  Finished running node model.spotify.fct_songplays
2022-12-25 17:57:36.465746 (Thread-3): 17:57:36  Began running node model.spotify.vw_songplays_albums
2022-12-25 17:57:36.465919 (Thread-3): 17:57:36  10 of 13 SKIP relation dbt_ddemo.vw_songplays_albums ........................... [SKIP]
2022-12-25 17:57:36.466125 (Thread-3): 17:57:36  Finished running node model.spotify.vw_songplays_albums
2022-12-25 17:57:36.466251 (Thread-3): 17:57:36  Began running node model.spotify.vw_songplays_genres
2022-12-25 17:57:36.466366 (Thread-3): 17:57:36  11 of 13 SKIP relation dbt_ddemo.vw_songplays_genres ........................... [SKIP]
2022-12-25 17:57:36.466517 (Thread-3): 17:57:36  Finished running node model.spotify.vw_songplays_genres
2022-12-25 17:57:36.501097 (Thread-1): 17:57:36  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:2f45c227-ef6a-4641-b96e-7190c7a5e881:US&page=queryresults
2022-12-25 17:57:36.502267 (Thread-1): 17:57:36  finished collecting timing info
2022-12-25 17:57:36.502754 (Thread-1): 17:57:36  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07f0356e-bfa8-41da-bd29-3c53af78eec8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7c36da30>]}
2022-12-25 17:57:36.503065 (Thread-1): 17:57:36  5 of 13 OK created sql table model dbt_ddemo.fct_top_artists ................... [CREATE TABLE (50.0 rows, 1.6 KB processed) in 2.27s]
2022-12-25 17:57:36.503279 (Thread-1): 17:57:36  Finished running node model.spotify.fct_top_artists
2022-12-25 17:57:36.503823 (Thread-3): 17:57:36  Began running node model.spotify.vw_top_artist_genres
2022-12-25 17:57:36.503965 (Thread-3): 17:57:36  12 of 13 SKIP relation dbt_ddemo.vw_top_artist_genres .......................... [SKIP]
2022-12-25 17:57:36.504127 (Thread-3): 17:57:36  Finished running node model.spotify.vw_top_artist_genres
2022-12-25 17:57:36.559120 (Thread-267): handling poll request
2022-12-25 17:57:36.559510 (Thread-267): 17:57:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb104a8430>]}
2022-12-25 17:57:36.560458 (Thread-267): sending response (<Response 20681 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:57:37.738645 (Thread-2): 17:57:37  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:bb788312-18bf-47bf-9c3a-9b2c4cdc7d30:US&page=queryresults
2022-12-25 17:57:37.740175 (Thread-2): 17:57:37  finished collecting timing info
2022-12-25 17:57:37.740826 (Thread-2): 17:57:37  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07f0356e-bfa8-41da-bd29-3c53af78eec8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fae7c26a1c0>]}
2022-12-25 17:57:37.741215 (Thread-2): 17:57:37  9 of 13 OK created sql table model dbt_ddemo.fct_top_tracks .................... [CREATE TABLE (50.0 rows, 4.4 KB processed) in 2.14s]
2022-12-25 17:57:37.741478 (Thread-2): 17:57:37  Finished running node model.spotify.fct_top_tracks
2022-12-25 17:57:37.742562 (Thread-1): 17:57:37  Began running node model.spotify.vw_top_track_genres
2022-12-25 17:57:37.742740 (Thread-1): 17:57:37  13 of 13 SKIP relation dbt_ddemo.vw_top_track_genres ........................... [SKIP]
2022-12-25 17:57:37.742930 (Thread-1): 17:57:37  Finished running node model.spotify.vw_top_track_genres
2022-12-25 17:57:37.744524 (MainThread): 17:57:37  Acquiring new bigquery connection "master"
2022-12-25 17:57:37.760102 (Thread-268): handling poll request
2022-12-25 17:57:37.760420 (Thread-268): 17:57:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb104a8df0>]}
2022-12-25 17:57:37.761003 (Thread-268): sending response (<Response 4509 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:57:37.745283 (MainThread): 17:57:37  
2022-12-25 17:57:37.745442 (MainThread): 17:57:37  Finished running 7 view models, 6 table models in 0 hours 0 minutes and 4.61 seconds (4.61s).
2022-12-25 17:57:37.745575 (MainThread): 17:57:37  Connection 'master' was properly closed.
2022-12-25 17:57:37.745747 (MainThread): 17:57:37  Connection 'model.spotify.fct_top_artists' was properly closed.
2022-12-25 17:57:37.745861 (MainThread): 17:57:37  Connection 'model.spotify.fct_top_tracks' was properly closed.
2022-12-25 17:57:37.745969 (MainThread): 17:57:37  Connection 'model.spotify.dim_tracks' was properly closed.
2022-12-25 17:57:37.746074 (MainThread): 17:57:37  Connection 'model.spotify.fct_songplays' was properly closed.
2022-12-25 17:57:37.820921 (MainThread): 17:57:37  
2022-12-25 17:57:37.821079 (MainThread): 17:57:37  Completed with 3 errors and 0 warnings:
2022-12-25 17:57:37.821166 (MainThread): 17:57:37  
2022-12-25 17:57:37.821250 (MainThread): 17:57:37  Database Error in model dim_artists (models/mart/dim_artists.sql)
2022-12-25 17:57:37.821324 (MainThread): 17:57:37    Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [25:5]
2022-12-25 17:57:37.821388 (MainThread): 17:57:37    compiled Code at target/run/spotify/models/mart/dim_artists.sql
2022-12-25 17:57:37.821455 (MainThread): 17:57:37  
2022-12-25 17:57:37.821527 (MainThread): 17:57:37  Database Error in model dim_albums (models/mart/dim_albums.sql)
2022-12-25 17:57:37.821593 (MainThread): 17:57:37    Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [23:5]
2022-12-25 17:57:37.821690 (MainThread): 17:57:37    compiled Code at target/run/spotify/models/mart/dim_albums.sql
2022-12-25 17:57:37.821761 (MainThread): 17:57:37  
2022-12-25 17:57:37.821833 (MainThread): 17:57:37  Database Error in model dim_tracks (models/mart/dim_tracks.sql)
2022-12-25 17:57:37.821898 (MainThread): 17:57:37    Syntax error: Expected keyword ALL or keyword DISTINCT but got keyword SELECT at [34:5]
2022-12-25 17:57:37.821959 (MainThread): 17:57:37    compiled Code at target/run/spotify/models/mart/dim_tracks.sql
2022-12-25 17:57:37.822041 (MainThread): 17:57:37  
2022-12-25 17:57:37.822118 (MainThread): 17:57:37  Done. PASS=6 WARN=0 ERROR=3 SKIP=4 TOTAL=13
2022-12-25 17:57:38.948606 (Thread-269): handling poll request
2022-12-25 17:57:38.949017 (Thread-269): 17:57:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb107ec3d0>]}
2022-12-25 17:57:38.951565 (Thread-269): sending response (<Response 56181 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:57:39.479527 (Thread-270): handling status request
2022-12-25 17:57:39.479941 (Thread-270): 17:57:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb107ecb80>]}
2022-12-25 17:57:39.480425 (Thread-270): sending response (<Response 1895 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:57:39.515796 (Thread-271): handling status request
2022-12-25 17:57:39.516146 (Thread-271): 17:57:39  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1071ad90>]}
2022-12-25 17:57:39.516610 (Thread-271): sending response (<Response 1895 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:58:43.000594 (Thread-272): handling status request
2022-12-25 17:58:43.001531 (Thread-272): 17:58:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1071abb0>]}
2022-12-25 17:58:43.002046 (Thread-272): sending response (<Response 1895 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:58:43.181095 (Thread-273): handling run_sql request
2022-12-25 17:58:43.181528 (Thread-273): 17:58:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1071a3a0>]}
2022-12-25 17:58:45.786241 (Thread-273): sending response (<Response 140 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:58:45.820960 (MainThread): 17:58:45  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e46b7ed2-c127-4e12-9f94-16fb82e1585e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd4d06f0220>]}
2022-12-25 17:58:45.821500 (MainThread): 17:58:45  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 431 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 17:58:45.822109 (Thread-1): 17:58:45  Acquiring new bigquery connection "rpc.spotify.request"
2022-12-25 17:58:45.822249 (Thread-1): 17:58:45  Began compiling node rpc.spotify.request
2022-12-25 17:58:45.822340 (Thread-1): 17:58:45  Compiling rpc.spotify.request
2022-12-25 17:58:45.826094 (Thread-1): 17:58:45  finished collecting timing info
2022-12-25 17:58:45.826230 (Thread-1): 17:58:45  Began executing node rpc.spotify.request
2022-12-25 17:58:45.826338 (Thread-1): 17:58:45  Opening a new connection, currently in state init
2022-12-25 17:58:45.830877 (Thread-1): 17:58:45  On rpc.spotify.request: -- artists table



    select distinct
        artist_id,
        artist_name,
        artist_popularity,
        artist_followers,
        artist_genre,
        artist_genre_others                                     
    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`
    union distinct

    select distinct
        artist_id,
        artist_name,
        artist_popularity,
        artist_followers,
        artist_genre,
        artist_genre_others                                     
    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_artists`
    union distinct

    select distinct
        artist_id,
        artist_name,
        artist_popularity,
        artist_followers,
        artist_genre,
        artist_genre_others                                     
    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`
    

limit 500
/* limit added automatically by dbt cloud */
2022-12-25 17:58:46.072003 (Thread-274): handling poll request
2022-12-25 17:58:46.072457 (Thread-274): 17:58:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1077ef70>]}
2022-12-25 17:58:46.073347 (Thread-274): sending response (<Response 4350 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:58:47.136878 (Thread-1): 17:58:47  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:2ce2b773-ce2c-4824-b7bc-3a330363f8f9:US&page=queryresults
2022-12-25 17:58:47.137232 (Thread-1): 17:58:47  finished collecting timing info
2022-12-25 17:58:47.273881 (Thread-275): handling poll request
2022-12-25 17:58:47.274304 (Thread-275): 17:58:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb10730850>]}
2022-12-25 17:58:47.274842 (Thread-275): sending response (<Response 1222 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:58:48.476780 (Thread-276): handling poll request
2022-12-25 17:58:48.477192 (Thread-276): 17:58:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb10730910>]}
2022-12-25 17:58:48.480436 (Thread-276): sending response (<Response 17551 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:58:55.357554 (Thread-277): 17:58:55  Unable to do partial parsing because config vars, config profile, or config target have changed
2022-12-25 17:58:55.357960 (Thread-277): 17:58:55  Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1049d250>]}
2022-12-25 17:58:55.506058 (Thread-277): 17:58:55  Parsing macros/etc.sql
2022-12-25 17:58:55.508286 (Thread-277): 17:58:55  Parsing macros/catalog.sql
2022-12-25 17:58:55.513813 (Thread-277): 17:58:55  Parsing macros/adapters.sql
2022-12-25 17:58:55.533405 (Thread-277): 17:58:55  Parsing macros/adapters/apply_grants.sql
2022-12-25 17:58:55.535954 (Thread-277): 17:58:55  Parsing macros/materializations/seed.sql
2022-12-25 17:58:55.538328 (Thread-277): 17:58:55  Parsing macros/materializations/incremental.sql
2022-12-25 17:58:55.554931 (Thread-277): 17:58:55  Parsing macros/materializations/snapshot.sql
2022-12-25 17:58:55.556544 (Thread-277): 17:58:55  Parsing macros/materializations/table.sql
2022-12-25 17:58:55.563245 (Thread-277): 17:58:55  Parsing macros/materializations/copy.sql
2022-12-25 17:58:55.566029 (Thread-277): 17:58:55  Parsing macros/materializations/view.sql
2022-12-25 17:58:55.568705 (Thread-277): 17:58:55  Parsing macros/utils/intersect.sql
2022-12-25 17:58:55.574346 (Thread-277): 17:58:55  Parsing macros/utils/position.sql
2022-12-25 17:58:55.574906 (Thread-277): 17:58:55  Parsing macros/utils/escape_single_quotes.sql
2022-12-25 17:58:55.575494 (Thread-277): 17:58:55  Parsing macros/utils/safe_cast.sql
2022-12-25 17:58:55.576030 (Thread-277): 17:58:55  Parsing macros/utils/array_construct.sql
2022-12-25 17:58:55.576848 (Thread-277): 17:58:55  Parsing macros/utils/datediff.sql
2022-12-25 17:58:55.578060 (Thread-277): 17:58:55  Parsing macros/utils/timestamps.sql
2022-12-25 17:58:55.579147 (Thread-277): 17:58:55  Parsing macros/utils/array_concat.sql
2022-12-25 17:58:55.579710 (Thread-277): 17:58:55  Parsing macros/utils/right.sql
2022-12-25 17:58:55.586481 (Thread-277): 17:58:55  Parsing macros/utils/array_append.sql
2022-12-25 17:58:55.587272 (Thread-277): 17:58:55  Parsing macros/utils/split_part.sql
2022-12-25 17:58:55.588544 (Thread-277): 17:58:55  Parsing macros/utils/date_trunc.sql
2022-12-25 17:58:55.589106 (Thread-277): 17:58:55  Parsing macros/utils/hash.sql
2022-12-25 17:58:55.589663 (Thread-277): 17:58:55  Parsing macros/utils/except.sql
2022-12-25 17:58:55.595561 (Thread-277): 17:58:55  Parsing macros/utils/bool_or.sql
2022-12-25 17:58:55.596033 (Thread-277): 17:58:55  Parsing macros/utils/dateadd.sql
2022-12-25 17:58:55.596668 (Thread-277): 17:58:55  Parsing macros/utils/listagg.sql
2022-12-25 17:58:55.597670 (Thread-277): 17:58:55  Parsing macros/etc/statement.sql
2022-12-25 17:58:55.602500 (Thread-277): 17:58:55  Parsing macros/etc/datetime.sql
2022-12-25 17:58:55.610287 (Thread-277): 17:58:55  Parsing macros/adapters/apply_grants.sql
2022-12-25 17:58:55.622987 (Thread-277): 17:58:55  Parsing macros/adapters/freshness.sql
2022-12-25 17:58:55.624866 (Thread-277): 17:58:55  Parsing macros/adapters/columns.sql
2022-12-25 17:58:55.633713 (Thread-277): 17:58:55  Parsing macros/adapters/timestamps.sql
2022-12-25 17:58:55.636888 (Thread-277): 17:58:55  Parsing macros/adapters/relation.sql
2022-12-25 17:58:55.650449 (Thread-277): 17:58:55  Parsing macros/adapters/schema.sql
2022-12-25 17:58:55.652582 (Thread-277): 17:58:55  Parsing macros/adapters/persist_docs.sql
2022-12-25 17:58:55.656871 (Thread-277): 17:58:55  Parsing macros/adapters/metadata.sql
2022-12-25 17:58:55.663550 (Thread-277): 17:58:55  Parsing macros/adapters/indexes.sql
2022-12-25 17:58:55.666100 (Thread-277): 17:58:55  Parsing macros/get_custom_name/get_custom_database.sql
2022-12-25 17:58:55.667617 (Thread-277): 17:58:55  Parsing macros/get_custom_name/get_custom_schema.sql
2022-12-25 17:58:55.669942 (Thread-277): 17:58:55  Parsing macros/get_custom_name/get_custom_alias.sql
2022-12-25 17:58:55.671526 (Thread-277): 17:58:55  Parsing macros/python_model/python.sql
2022-12-25 17:58:55.677163 (Thread-277): 17:58:55  Parsing macros/materializations/hooks.sql
2022-12-25 17:58:55.680796 (Thread-277): 17:58:55  Parsing macros/materializations/configs.sql
2022-12-25 17:58:55.683008 (Thread-277): 17:58:55  Parsing macros/materializations/seeds/seed.sql
2022-12-25 17:58:55.689969 (Thread-277): 17:58:55  Parsing macros/materializations/seeds/helpers.sql
2022-12-25 17:58:55.706707 (Thread-277): 17:58:55  Parsing macros/materializations/tests/test.sql
2022-12-25 17:58:55.710823 (Thread-277): 17:58:55  Parsing macros/materializations/tests/helpers.sql
2022-12-25 17:58:55.712488 (Thread-277): 17:58:55  Parsing macros/materializations/tests/where_subquery.sql
2022-12-25 17:58:55.714224 (Thread-277): 17:58:55  Parsing macros/materializations/models/view/helpers.sql
2022-12-25 17:58:55.715482 (Thread-277): 17:58:55  Parsing macros/materializations/models/view/create_or_replace_view.sql
2022-12-25 17:58:55.718536 (Thread-277): 17:58:55  Parsing macros/materializations/models/view/create_view_as.sql
2022-12-25 17:58:55.720722 (Thread-277): 17:58:55  Parsing macros/materializations/models/view/view.sql
2022-12-25 17:58:55.725907 (Thread-277): 17:58:55  Parsing macros/materializations/models/incremental/strategies.sql
2022-12-25 17:58:55.732279 (Thread-277): 17:58:55  Parsing macros/materializations/models/incremental/column_helpers.sql
2022-12-25 17:58:55.739668 (Thread-277): 17:58:55  Parsing macros/materializations/models/incremental/incremental.sql
2022-12-25 17:58:55.749199 (Thread-277): 17:58:55  Parsing macros/materializations/models/incremental/on_schema_change.sql
2022-12-25 17:58:55.764647 (Thread-277): 17:58:55  Parsing macros/materializations/models/incremental/is_incremental.sql
2022-12-25 17:58:55.766121 (Thread-277): 17:58:55  Parsing macros/materializations/models/incremental/merge.sql
2022-12-25 17:58:55.780706 (Thread-277): 17:58:55  Parsing macros/materializations/models/table/create_table_as.sql
2022-12-25 17:58:55.784135 (Thread-277): 17:58:55  Parsing macros/materializations/models/table/table.sql
2022-12-25 17:58:55.789199 (Thread-277): 17:58:55  Parsing macros/materializations/snapshots/strategies.sql
2022-12-25 17:58:55.803910 (Thread-277): 17:58:55  Parsing macros/materializations/snapshots/snapshot_merge.sql
2022-12-25 17:58:55.805515 (Thread-277): 17:58:55  Parsing macros/materializations/snapshots/snapshot.sql
2022-12-25 17:58:55.816616 (Thread-277): 17:58:55  Parsing macros/materializations/snapshots/helpers.sql
2022-12-25 17:58:55.822532 (Thread-278): handling status request
2022-12-25 17:58:55.829877 (Thread-277): 17:58:55  Parsing macros/generic_test_sql/not_null.sql
2022-12-25 17:58:55.830229 (Thread-278): 17:58:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb106f6cd0>]}
2022-12-25 17:58:55.831076 (Thread-277): 17:58:55  Parsing macros/generic_test_sql/relationships.sql
2022-12-25 17:58:55.831579 (Thread-278): sending response (<Response 187 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:58:55.832498 (Thread-277): 17:58:55  Parsing macros/generic_test_sql/unique.sql
2022-12-25 17:58:55.833573 (Thread-277): 17:58:55  Parsing macros/generic_test_sql/accepted_values.sql
2022-12-25 17:58:55.834943 (Thread-277): 17:58:55  Parsing macros/utils/intersect.sql
2022-12-25 17:58:55.835867 (Thread-277): 17:58:55  Parsing macros/utils/position.sql
2022-12-25 17:58:55.836984 (Thread-277): 17:58:55  Parsing macros/utils/escape_single_quotes.sql
2022-12-25 17:58:55.838279 (Thread-277): 17:58:55  Parsing macros/utils/safe_cast.sql
2022-12-25 17:58:55.839370 (Thread-277): 17:58:55  Parsing macros/utils/array_construct.sql
2022-12-25 17:58:55.840813 (Thread-277): 17:58:55  Parsing macros/utils/cast_bool_to_text.sql
2022-12-25 17:58:55.841885 (Thread-277): 17:58:55  Parsing macros/utils/datediff.sql
2022-12-25 17:58:55.843092 (Thread-277): 17:58:55  Parsing macros/utils/concat.sql
2022-12-25 17:58:55.844076 (Thread-277): 17:58:55  Parsing macros/utils/length.sql
2022-12-25 17:58:55.845017 (Thread-277): 17:58:55  Parsing macros/utils/any_value.sql
2022-12-25 17:58:55.845981 (Thread-277): 17:58:55  Parsing macros/utils/data_types.sql
2022-12-25 17:58:55.852440 (Thread-277): 17:58:55  Parsing macros/utils/array_concat.sql
2022-12-25 17:58:55.853487 (Thread-277): 17:58:55  Parsing macros/utils/right.sql
2022-12-25 17:58:55.854598 (Thread-277): 17:58:55  Parsing macros/utils/array_append.sql
2022-12-25 17:58:55.855666 (Thread-277): 17:58:55  Parsing macros/utils/last_day.sql
2022-12-25 17:58:55.857388 (Thread-277): 17:58:55  Parsing macros/utils/split_part.sql
2022-12-25 17:58:55.859406 (Thread-277): 17:58:55  Parsing macros/utils/date_trunc.sql
2022-12-25 17:58:55.860445 (Thread-277): 17:58:55  Parsing macros/utils/literal.sql
2022-12-25 17:58:55.861366 (Thread-277): 17:58:55  Parsing macros/utils/hash.sql
2022-12-25 17:58:55.862900 (Thread-277): 17:58:55  Parsing macros/utils/except.sql
2022-12-25 17:58:55.863420 (Thread-279): handling status request
2022-12-25 17:58:55.864328 (Thread-277): 17:58:55  Parsing macros/utils/bool_or.sql
2022-12-25 17:58:55.864663 (Thread-279): 17:58:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb104855e0>]}
2022-12-25 17:58:55.865652 (Thread-277): 17:58:55  Parsing macros/utils/replace.sql
2022-12-25 17:58:55.866116 (Thread-279): sending response (<Response 187 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:58:55.867393 (Thread-277): 17:58:55  Parsing macros/utils/dateadd.sql
2022-12-25 17:58:55.869018 (Thread-277): 17:58:55  Parsing macros/utils/listagg.sql
2022-12-25 17:58:55.871334 (Thread-277): 17:58:55  Parsing tests/generic/builtin.sql
2022-12-25 17:58:55.874217 (Thread-277): 17:58:55  Parsing macros/sql/pivot.sql
2022-12-25 17:58:55.878278 (Thread-277): 17:58:55  Parsing macros/sql/star.sql
2022-12-25 17:58:55.883473 (Thread-277): 17:58:55  Parsing macros/sql/get_table_types_sql.sql
2022-12-25 17:58:55.884966 (Thread-277): 17:58:55  Parsing macros/sql/generate_surrogate_key.sql
2022-12-25 17:58:55.887390 (Thread-277): 17:58:55  Parsing macros/sql/deduplicate.sql
2022-12-25 17:58:55.890836 (Thread-277): 17:58:55  Parsing macros/sql/surrogate_key.sql
2022-12-25 17:58:55.892294 (Thread-277): 17:58:55  Parsing macros/sql/get_query_results_as_dict.sql
2022-12-25 17:58:55.894506 (Thread-277): 17:58:55  Parsing macros/sql/date_spine.sql
2022-12-25 17:58:55.898563 (Thread-277): 17:58:55  Parsing macros/sql/get_column_values.sql
2022-12-25 17:58:55.903703 (Thread-277): 17:58:55  Parsing macros/sql/groupby.sql
2022-12-25 17:58:55.905004 (Thread-277): 17:58:55  Parsing macros/sql/get_tables_by_pattern_sql.sql
2022-12-25 17:58:55.911134 (Thread-277): 17:58:55  Parsing macros/sql/nullcheck_table.sql
2022-12-25 17:58:55.912680 (Thread-277): 17:58:55  Parsing macros/sql/get_tables_by_prefix_sql.sql
2022-12-25 17:58:55.914269 (Thread-277): 17:58:55  Parsing macros/sql/safe_divide.sql
2022-12-25 17:58:55.915339 (Thread-277): 17:58:55  Parsing macros/sql/get_relations_by_pattern.sql
2022-12-25 17:58:55.918495 (Thread-277): 17:58:55  Parsing macros/sql/get_relations_by_prefix.sql
2022-12-25 17:58:55.922951 (Thread-277): 17:58:55  Parsing macros/sql/safe_add.sql
2022-12-25 17:58:55.925099 (Thread-277): 17:58:55  Parsing macros/sql/haversine_distance.sql
2022-12-25 17:58:55.930579 (Thread-277): 17:58:55  Parsing macros/sql/unpivot.sql
2022-12-25 17:58:55.936700 (Thread-277): 17:58:55  Parsing macros/sql/generate_series.sql
2022-12-25 17:58:55.940813 (Thread-277): 17:58:55  Parsing macros/sql/get_single_value.sql
2022-12-25 17:58:55.943530 (Thread-277): 17:58:55  Parsing macros/sql/width_bucket.sql
2022-12-25 17:58:55.948291 (Thread-277): 17:58:55  Parsing macros/sql/nullcheck.sql
2022-12-25 17:58:55.949891 (Thread-277): 17:58:55  Parsing macros/sql/union.sql
2022-12-25 17:58:55.961887 (Thread-277): 17:58:55  Parsing macros/sql/get_filtered_columns_in_relation.sql
2022-12-25 17:58:55.965497 (Thread-277): 17:58:55  Parsing macros/jinja_helpers/pretty_time.sql
2022-12-25 17:58:55.971435 (Thread-277): 17:58:55  Parsing macros/jinja_helpers/_is_relation.sql
2022-12-25 17:58:55.972520 (Thread-277): 17:58:55  Parsing macros/jinja_helpers/slugify.sql
2022-12-25 17:58:55.979154 (Thread-277): 17:58:55  Parsing macros/jinja_helpers/_is_ephemeral.sql
2022-12-25 17:58:55.986993 (Thread-277): 17:58:55  Parsing macros/jinja_helpers/log_info.sql
2022-12-25 17:58:55.992749 (Thread-277): 17:58:55  Parsing macros/jinja_helpers/pretty_log_format.sql
2022-12-25 17:58:55.993869 (Thread-277): 17:58:55  Parsing macros/web/get_url_parameter.sql
2022-12-25 17:58:55.995370 (Thread-277): 17:58:55  Parsing macros/web/get_url_path.sql
2022-12-25 17:58:55.997884 (Thread-277): 17:58:55  Parsing macros/web/get_url_host.sql
2022-12-25 17:58:56.010542 (Thread-277): 17:58:56  Parsing macros/generic_tests/expression_is_true.sql
2022-12-25 17:58:56.012472 (Thread-277): 17:58:56  Parsing macros/generic_tests/not_constant.sql
2022-12-25 17:58:56.014487 (Thread-277): 17:58:56  Parsing macros/generic_tests/sequential_values.sql
2022-12-25 17:58:56.018087 (Thread-277): 17:58:56  Parsing macros/generic_tests/not_null_proportion.sql
2022-12-25 17:58:56.025199 (Thread-277): 17:58:56  Parsing macros/generic_tests/at_least_one.sql
2022-12-25 17:58:56.027252 (Thread-277): 17:58:56  Parsing macros/generic_tests/equality.sql
2022-12-25 17:58:56.035404 (Thread-277): 17:58:56  Parsing macros/generic_tests/equal_rowcount.sql
2022-12-25 17:58:56.044162 (Thread-277): 17:58:56  Parsing macros/generic_tests/not_accepted_values.sql
2022-12-25 17:58:56.046184 (Thread-277): 17:58:56  Parsing macros/generic_tests/mutually_exclusive_ranges.sql
2022-12-25 17:58:56.054670 (Thread-277): 17:58:56  Parsing macros/generic_tests/relationships_where.sql
2022-12-25 17:58:56.056721 (Thread-277): 17:58:56  Parsing macros/generic_tests/not_empty_string.sql
2022-12-25 17:58:56.058473 (Thread-277): 17:58:56  Parsing macros/generic_tests/accepted_range.sql
2022-12-25 17:58:56.060745 (Thread-277): 17:58:56  Parsing macros/generic_tests/fewer_rows_than.sql
2022-12-25 17:58:56.064847 (Thread-277): 17:58:56  Parsing macros/generic_tests/unique_combination_of_columns.sql
2022-12-25 17:58:56.067544 (Thread-277): 17:58:56  Parsing macros/generic_tests/recency.sql
2022-12-25 17:58:56.070780 (Thread-277): 17:58:56  Parsing macros/generic_tests/cardinality_equality.sql
2022-12-25 17:58:56.431124 (Thread-277): 17:58:56  1699: static parser successfully parsed mart/fct_top_tracks.sql
2022-12-25 17:58:56.434198 (Thread-277): 17:58:56  1699: static parser successfully parsed mart/fct_songplays.sql
2022-12-25 17:58:56.436736 (Thread-277): 17:58:56  1699: static parser successfully parsed mart/fct_top_artists.sql
2022-12-25 17:58:56.439302 (Thread-277): 17:58:56  1603: static parser failed on mart/dim_artists.sql
2022-12-25 17:58:56.444609 (Thread-277): 17:58:56  1602: parser fallback to jinja rendering on mart/dim_artists.sql
2022-12-25 17:58:56.445883 (Thread-277): 17:58:56  1603: static parser failed on mart/dim_albums.sql
2022-12-25 17:58:56.451086 (Thread-277): 17:58:56  1602: parser fallback to jinja rendering on mart/dim_albums.sql
2022-12-25 17:58:56.452358 (Thread-277): 17:58:56  1603: static parser failed on mart/dim_tracks.sql
2022-12-25 17:58:56.457106 (Thread-277): 17:58:56  1602: parser fallback to jinja rendering on mart/dim_tracks.sql
2022-12-25 17:58:56.458431 (Thread-277): 17:58:56  1699: static parser successfully parsed staging/stg_top_tracks.sql
2022-12-25 17:58:56.461028 (Thread-277): 17:58:56  1699: static parser successfully parsed staging/stg_songplays.sql
2022-12-25 17:58:56.463879 (Thread-277): 17:58:56  1699: static parser successfully parsed staging/stg_top_artists.sql
2022-12-25 17:58:56.466791 (Thread-277): 17:58:56  1699: static parser successfully parsed view/vw_top_track_genres.sql
2022-12-25 17:58:56.469790 (Thread-277): 17:58:56  1699: static parser successfully parsed view/vw_top_artist_genres.sql
2022-12-25 17:58:56.472689 (Thread-277): 17:58:56  1699: static parser successfully parsed view/vw_songplays_genres.sql
2022-12-25 17:58:56.475890 (Thread-277): 17:58:56  1699: static parser successfully parsed view/vw_songplays_albums.sql
2022-12-25 17:58:56.716980 (Thread-277): 17:58:56  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34c9efd0>]}
2022-12-25 17:58:57.089239 (Thread-280): handling status request
2022-12-25 17:58:57.089675 (Thread-280): 17:58:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec350176d0>]}
2022-12-25 17:58:57.091330 (Thread-280): sending response (<Response 48610 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:58:57.098915 (Thread-281): handling status request
2022-12-25 17:58:57.099193 (Thread-281): 17:58:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec28503340>]}
2022-12-25 17:58:57.100606 (Thread-281): sending response (<Response 48610 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:59:12.083341 (Thread-282): 17:59:12  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-12-25 17:59:12.083897 (Thread-282): 17:59:12  Partial parsing: updated file: spotify://models/mart/dim_albums.sql
2022-12-25 17:59:12.089769 (Thread-282): 17:59:12  1603: static parser failed on mart/dim_albums.sql
2022-12-25 17:59:12.094869 (Thread-282): 17:59:12  1602: parser fallback to jinja rendering on mart/dim_albums.sql
2022-12-25 17:59:12.158672 (Thread-282): 17:59:12  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb10198550>]}
2022-12-25 17:59:12.449064 (Thread-283): handling status request
2022-12-25 17:59:12.449481 (Thread-283): 17:59:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febf416fb50>]}
2022-12-25 17:59:12.450004 (Thread-283): sending response (<Response 1895 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:59:12.475933 (Thread-284): handling status request
2022-12-25 17:59:12.476204 (Thread-284): 17:59:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb106f22b0>]}
2022-12-25 17:59:12.498598 (Thread-284): sending response (<Response 1895 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:59:15.764691 (Thread-285): 17:59:15  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-12-25 17:59:15.765252 (Thread-285): 17:59:15  Partial parsing: updated file: spotify://models/mart/dim_tracks.sql
2022-12-25 17:59:15.771208 (Thread-285): 17:59:15  1603: static parser failed on mart/dim_tracks.sql
2022-12-25 17:59:15.776466 (Thread-285): 17:59:15  1602: parser fallback to jinja rendering on mart/dim_tracks.sql
2022-12-25 17:59:15.842176 (Thread-285): 17:59:15  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed77ea90>]}
2022-12-25 17:59:16.097162 (Thread-286): handling status request
2022-12-25 17:59:16.097601 (Thread-286): 17:59:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed749910>]}
2022-12-25 17:59:16.098147 (Thread-286): sending response (<Response 1895 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:59:16.141573 (Thread-287): handling status request
2022-12-25 17:59:16.141890 (Thread-287): 17:59:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed749d90>]}
2022-12-25 17:59:16.142322 (Thread-287): sending response (<Response 1895 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:59:34.810027 (Thread-288): handling status request
2022-12-25 17:59:34.810433 (Thread-288): 17:59:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed74c7c0>]}
2022-12-25 17:59:34.810921 (Thread-288): sending response (<Response 1895 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:59:37.128509 (Thread-289): 17:59:37  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-12-25 17:59:37.128744 (Thread-289): 17:59:37  Partial parsing enabled, no changes found, skipping parsing
2022-12-25 17:59:37.136459 (Thread-289): 17:59:37  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed5e34c0>]}
2022-12-25 17:59:37.460426 (Thread-290): handling status request
2022-12-25 17:59:37.460848 (Thread-290): 17:59:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed6ab1f0>]}
2022-12-25 17:59:37.461317 (Thread-290): sending response (<Response 1273 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:59:37.521310 (Thread-291): handling status request
2022-12-25 17:59:37.521678 (Thread-291): 17:59:37  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed6ab070>]}
2022-12-25 17:59:37.522115 (Thread-291): sending response (<Response 1273 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:59:50.583973 (Thread-292): handling status request
2022-12-25 17:59:50.584398 (Thread-292): 17:59:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed77f910>]}
2022-12-25 17:59:50.584876 (Thread-292): sending response (<Response 1273 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:59:50.833456 (Thread-293): handling status request
2022-12-25 17:59:50.833899 (Thread-293): 17:59:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed77f820>]}
2022-12-25 17:59:50.834368 (Thread-293): sending response (<Response 1273 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:59:50.840875 (Thread-294): handling cli_args request
2022-12-25 17:59:50.841139 (Thread-294): 17:59:50  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34fb3310>]}
2022-12-25 17:59:53.472127 (Thread-294): sending response (<Response 140 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:59:53.547571 (MainThread): 17:59:53  Unable to do partial parsing because config vars, config profile, or config target have changed
2022-12-25 17:59:53.547959 (MainThread): 17:59:53  Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '26a2b86d-cbed-48ca-bccf-ae25b49c28dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd443c4940>]}
2022-12-25 17:59:53.666061 (MainThread): 17:59:53  Parsing macros/etc.sql
2022-12-25 17:59:53.668454 (MainThread): 17:59:53  Parsing macros/catalog.sql
2022-12-25 17:59:53.674009 (MainThread): 17:59:53  Parsing macros/adapters.sql
2022-12-25 17:59:53.694200 (MainThread): 17:59:53  Parsing macros/adapters/apply_grants.sql
2022-12-25 17:59:53.696614 (MainThread): 17:59:53  Parsing macros/materializations/seed.sql
2022-12-25 17:59:53.699054 (MainThread): 17:59:53  Parsing macros/materializations/incremental.sql
2022-12-25 17:59:53.715798 (MainThread): 17:59:53  Parsing macros/materializations/snapshot.sql
2022-12-25 17:59:53.717342 (MainThread): 17:59:53  Parsing macros/materializations/table.sql
2022-12-25 17:59:53.724037 (MainThread): 17:59:53  Parsing macros/materializations/copy.sql
2022-12-25 17:59:53.726637 (MainThread): 17:59:53  Parsing macros/materializations/view.sql
2022-12-25 17:59:53.729210 (MainThread): 17:59:53  Parsing macros/utils/intersect.sql
2022-12-25 17:59:53.729581 (MainThread): 17:59:53  Parsing macros/utils/position.sql
2022-12-25 17:59:53.730130 (MainThread): 17:59:53  Parsing macros/utils/escape_single_quotes.sql
2022-12-25 17:59:53.755605 (Thread-295): handling poll request
2022-12-25 17:59:53.756034 (Thread-295): 17:59:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb101b5b50>]}
2022-12-25 17:59:53.756948 (Thread-295): sending response (<Response 4863 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:59:53.730649 (MainThread): 17:59:53  Parsing macros/utils/safe_cast.sql
2022-12-25 17:59:53.731130 (MainThread): 17:59:53  Parsing macros/utils/array_construct.sql
2022-12-25 17:59:53.732005 (MainThread): 17:59:53  Parsing macros/utils/datediff.sql
2022-12-25 17:59:53.733129 (MainThread): 17:59:53  Parsing macros/utils/timestamps.sql
2022-12-25 17:59:53.734197 (MainThread): 17:59:53  Parsing macros/utils/array_concat.sql
2022-12-25 17:59:53.734689 (MainThread): 17:59:53  Parsing macros/utils/right.sql
2022-12-25 17:59:53.735285 (MainThread): 17:59:53  Parsing macros/utils/array_append.sql
2022-12-25 17:59:53.735968 (MainThread): 17:59:53  Parsing macros/utils/split_part.sql
2022-12-25 17:59:53.737270 (MainThread): 17:59:53  Parsing macros/utils/date_trunc.sql
2022-12-25 17:59:53.737811 (MainThread): 17:59:53  Parsing macros/utils/hash.sql
2022-12-25 17:59:53.738291 (MainThread): 17:59:53  Parsing macros/utils/except.sql
2022-12-25 17:59:53.738633 (MainThread): 17:59:53  Parsing macros/utils/bool_or.sql
2022-12-25 17:59:53.739041 (MainThread): 17:59:53  Parsing macros/utils/dateadd.sql
2022-12-25 17:59:53.739639 (MainThread): 17:59:53  Parsing macros/utils/listagg.sql
2022-12-25 17:59:53.740555 (MainThread): 17:59:53  Parsing macros/etc/statement.sql
2022-12-25 17:59:53.745360 (MainThread): 17:59:53  Parsing macros/etc/datetime.sql
2022-12-25 17:59:53.753262 (MainThread): 17:59:53  Parsing macros/adapters/apply_grants.sql
2022-12-25 17:59:53.766193 (MainThread): 17:59:53  Parsing macros/adapters/freshness.sql
2022-12-25 17:59:53.768120 (MainThread): 17:59:53  Parsing macros/adapters/columns.sql
2022-12-25 17:59:53.777033 (MainThread): 17:59:53  Parsing macros/adapters/timestamps.sql
2022-12-25 17:59:53.780304 (MainThread): 17:59:53  Parsing macros/adapters/relation.sql
2022-12-25 17:59:53.794125 (MainThread): 17:59:53  Parsing macros/adapters/schema.sql
2022-12-25 17:59:53.796160 (MainThread): 17:59:53  Parsing macros/adapters/persist_docs.sql
2022-12-25 17:59:53.800465 (MainThread): 17:59:53  Parsing macros/adapters/metadata.sql
2022-12-25 17:59:53.807174 (MainThread): 17:59:53  Parsing macros/adapters/indexes.sql
2022-12-25 17:59:53.809794 (MainThread): 17:59:53  Parsing macros/get_custom_name/get_custom_database.sql
2022-12-25 17:59:53.811245 (MainThread): 17:59:53  Parsing macros/get_custom_name/get_custom_schema.sql
2022-12-25 17:59:53.813587 (MainThread): 17:59:53  Parsing macros/get_custom_name/get_custom_alias.sql
2022-12-25 17:59:53.815120 (MainThread): 17:59:53  Parsing macros/python_model/python.sql
2022-12-25 17:59:53.820752 (MainThread): 17:59:53  Parsing macros/materializations/hooks.sql
2022-12-25 17:59:53.824463 (MainThread): 17:59:53  Parsing macros/materializations/configs.sql
2022-12-25 17:59:53.826646 (MainThread): 17:59:53  Parsing macros/materializations/seeds/seed.sql
2022-12-25 17:59:53.833330 (MainThread): 17:59:53  Parsing macros/materializations/seeds/helpers.sql
2022-12-25 17:59:53.850267 (MainThread): 17:59:53  Parsing macros/materializations/tests/test.sql
2022-12-25 17:59:53.854516 (MainThread): 17:59:53  Parsing macros/materializations/tests/helpers.sql
2022-12-25 17:59:53.856152 (MainThread): 17:59:53  Parsing macros/materializations/tests/where_subquery.sql
2022-12-25 17:59:53.857843 (MainThread): 17:59:53  Parsing macros/materializations/models/view/helpers.sql
2022-12-25 17:59:53.859042 (MainThread): 17:59:53  Parsing macros/materializations/models/view/create_or_replace_view.sql
2022-12-25 17:59:53.862144 (MainThread): 17:59:53  Parsing macros/materializations/models/view/create_view_as.sql
2022-12-25 17:59:53.864288 (MainThread): 17:59:53  Parsing macros/materializations/models/view/view.sql
2022-12-25 17:59:53.869319 (MainThread): 17:59:53  Parsing macros/materializations/models/incremental/strategies.sql
2022-12-25 17:59:53.875882 (MainThread): 17:59:53  Parsing macros/materializations/models/incremental/column_helpers.sql
2022-12-25 17:59:53.883551 (MainThread): 17:59:53  Parsing macros/materializations/models/incremental/incremental.sql
2022-12-25 17:59:53.893071 (MainThread): 17:59:53  Parsing macros/materializations/models/incremental/on_schema_change.sql
2022-12-25 17:59:53.908294 (MainThread): 17:59:53  Parsing macros/materializations/models/incremental/is_incremental.sql
2022-12-25 17:59:53.909690 (MainThread): 17:59:53  Parsing macros/materializations/models/incremental/merge.sql
2022-12-25 17:59:53.923694 (MainThread): 17:59:53  Parsing macros/materializations/models/table/create_table_as.sql
2022-12-25 17:59:53.927030 (MainThread): 17:59:53  Parsing macros/materializations/models/table/table.sql
2022-12-25 17:59:53.932140 (MainThread): 17:59:53  Parsing macros/materializations/snapshots/strategies.sql
2022-12-25 17:59:53.947091 (MainThread): 17:59:53  Parsing macros/materializations/snapshots/snapshot_merge.sql
2022-12-25 17:59:53.948624 (MainThread): 17:59:53  Parsing macros/materializations/snapshots/snapshot.sql
2022-12-25 17:59:53.959224 (MainThread): 17:59:53  Parsing macros/materializations/snapshots/helpers.sql
2022-12-25 17:59:53.971132 (MainThread): 17:59:53  Parsing macros/generic_test_sql/not_null.sql
2022-12-25 17:59:53.971904 (MainThread): 17:59:53  Parsing macros/generic_test_sql/relationships.sql
2022-12-25 17:59:53.972769 (MainThread): 17:59:53  Parsing macros/generic_test_sql/unique.sql
2022-12-25 17:59:53.973402 (MainThread): 17:59:53  Parsing macros/generic_test_sql/accepted_values.sql
2022-12-25 17:59:53.974660 (MainThread): 17:59:53  Parsing macros/utils/intersect.sql
2022-12-25 17:59:53.975507 (MainThread): 17:59:53  Parsing macros/utils/position.sql
2022-12-25 17:59:53.976525 (MainThread): 17:59:53  Parsing macros/utils/escape_single_quotes.sql
2022-12-25 17:59:53.977573 (MainThread): 17:59:53  Parsing macros/utils/safe_cast.sql
2022-12-25 17:59:53.978785 (MainThread): 17:59:53  Parsing macros/utils/array_construct.sql
2022-12-25 17:59:53.980210 (MainThread): 17:59:53  Parsing macros/utils/cast_bool_to_text.sql
2022-12-25 17:59:53.981195 (MainThread): 17:59:53  Parsing macros/utils/datediff.sql
2022-12-25 17:59:53.982385 (MainThread): 17:59:53  Parsing macros/utils/concat.sql
2022-12-25 17:59:53.983417 (MainThread): 17:59:53  Parsing macros/utils/length.sql
2022-12-25 17:59:53.984317 (MainThread): 17:59:53  Parsing macros/utils/any_value.sql
2022-12-25 17:59:53.985202 (MainThread): 17:59:53  Parsing macros/utils/data_types.sql
2022-12-25 17:59:53.991825 (MainThread): 17:59:53  Parsing macros/utils/array_concat.sql
2022-12-25 17:59:53.992821 (MainThread): 17:59:53  Parsing macros/utils/right.sql
2022-12-25 17:59:53.993960 (MainThread): 17:59:53  Parsing macros/utils/array_append.sql
2022-12-25 17:59:53.994960 (MainThread): 17:59:53  Parsing macros/utils/last_day.sql
2022-12-25 17:59:53.996680 (MainThread): 17:59:53  Parsing macros/utils/split_part.sql
2022-12-25 17:59:53.998692 (MainThread): 17:59:53  Parsing macros/utils/date_trunc.sql
2022-12-25 17:59:53.999696 (MainThread): 17:59:53  Parsing macros/utils/literal.sql
2022-12-25 17:59:54.000576 (MainThread): 17:59:54  Parsing macros/utils/hash.sql
2022-12-25 17:59:54.001764 (MainThread): 17:59:54  Parsing macros/utils/except.sql
2022-12-25 17:59:54.002544 (MainThread): 17:59:54  Parsing macros/utils/bool_or.sql
2022-12-25 17:59:54.003510 (MainThread): 17:59:54  Parsing macros/utils/replace.sql
2022-12-25 17:59:54.004658 (MainThread): 17:59:54  Parsing macros/utils/dateadd.sql
2022-12-25 17:59:54.005846 (MainThread): 17:59:54  Parsing macros/utils/listagg.sql
2022-12-25 17:59:54.007987 (MainThread): 17:59:54  Parsing tests/generic/builtin.sql
2022-12-25 17:59:54.010880 (MainThread): 17:59:54  Parsing macros/sql/pivot.sql
2022-12-25 17:59:54.014839 (MainThread): 17:59:54  Parsing macros/sql/star.sql
2022-12-25 17:59:54.020047 (MainThread): 17:59:54  Parsing macros/sql/get_table_types_sql.sql
2022-12-25 17:59:54.021494 (MainThread): 17:59:54  Parsing macros/sql/generate_surrogate_key.sql
2022-12-25 17:59:54.023947 (MainThread): 17:59:54  Parsing macros/sql/deduplicate.sql
2022-12-25 17:59:54.027417 (MainThread): 17:59:54  Parsing macros/sql/surrogate_key.sql
2022-12-25 17:59:54.028887 (MainThread): 17:59:54  Parsing macros/sql/get_query_results_as_dict.sql
2022-12-25 17:59:54.031029 (MainThread): 17:59:54  Parsing macros/sql/date_spine.sql
2022-12-25 17:59:54.035098 (MainThread): 17:59:54  Parsing macros/sql/get_column_values.sql
2022-12-25 17:59:54.040266 (MainThread): 17:59:54  Parsing macros/sql/groupby.sql
2022-12-25 17:59:54.041509 (MainThread): 17:59:54  Parsing macros/sql/get_tables_by_pattern_sql.sql
2022-12-25 17:59:54.047704 (MainThread): 17:59:54  Parsing macros/sql/nullcheck_table.sql
2022-12-25 17:59:54.049183 (MainThread): 17:59:54  Parsing macros/sql/get_tables_by_prefix_sql.sql
2022-12-25 17:59:54.050806 (MainThread): 17:59:54  Parsing macros/sql/safe_divide.sql
2022-12-25 17:59:54.051829 (MainThread): 17:59:54  Parsing macros/sql/get_relations_by_pattern.sql
2022-12-25 17:59:54.054962 (MainThread): 17:59:54  Parsing macros/sql/get_relations_by_prefix.sql
2022-12-25 17:59:54.058385 (MainThread): 17:59:54  Parsing macros/sql/safe_add.sql
2022-12-25 17:59:54.060481 (MainThread): 17:59:54  Parsing macros/sql/haversine_distance.sql
2022-12-25 17:59:54.065931 (MainThread): 17:59:54  Parsing macros/sql/unpivot.sql
2022-12-25 17:59:54.071651 (MainThread): 17:59:54  Parsing macros/sql/generate_series.sql
2022-12-25 17:59:54.075725 (MainThread): 17:59:54  Parsing macros/sql/get_single_value.sql
2022-12-25 17:59:54.078353 (MainThread): 17:59:54  Parsing macros/sql/width_bucket.sql
2022-12-25 17:59:54.083142 (MainThread): 17:59:54  Parsing macros/sql/nullcheck.sql
2022-12-25 17:59:54.084835 (MainThread): 17:59:54  Parsing macros/sql/union.sql
2022-12-25 17:59:54.096872 (MainThread): 17:59:54  Parsing macros/sql/get_filtered_columns_in_relation.sql
2022-12-25 17:59:54.099445 (MainThread): 17:59:54  Parsing macros/jinja_helpers/pretty_time.sql
2022-12-25 17:59:54.100646 (MainThread): 17:59:54  Parsing macros/jinja_helpers/_is_relation.sql
2022-12-25 17:59:54.101714 (MainThread): 17:59:54  Parsing macros/jinja_helpers/slugify.sql
2022-12-25 17:59:54.103089 (MainThread): 17:59:54  Parsing macros/jinja_helpers/_is_ephemeral.sql
2022-12-25 17:59:54.104835 (MainThread): 17:59:54  Parsing macros/jinja_helpers/log_info.sql
2022-12-25 17:59:54.105980 (MainThread): 17:59:54  Parsing macros/jinja_helpers/pretty_log_format.sql
2022-12-25 17:59:54.107020 (MainThread): 17:59:54  Parsing macros/web/get_url_parameter.sql
2022-12-25 17:59:54.108475 (MainThread): 17:59:54  Parsing macros/web/get_url_path.sql
2022-12-25 17:59:54.110809 (MainThread): 17:59:54  Parsing macros/web/get_url_host.sql
2022-12-25 17:59:54.112780 (MainThread): 17:59:54  Parsing macros/generic_tests/expression_is_true.sql
2022-12-25 17:59:54.114499 (MainThread): 17:59:54  Parsing macros/generic_tests/not_constant.sql
2022-12-25 17:59:54.116557 (MainThread): 17:59:54  Parsing macros/generic_tests/sequential_values.sql
2022-12-25 17:59:54.120136 (MainThread): 17:59:54  Parsing macros/generic_tests/not_null_proportion.sql
2022-12-25 17:59:54.123209 (MainThread): 17:59:54  Parsing macros/generic_tests/at_least_one.sql
2022-12-25 17:59:54.125194 (MainThread): 17:59:54  Parsing macros/generic_tests/equality.sql
2022-12-25 17:59:54.128644 (MainThread): 17:59:54  Parsing macros/generic_tests/equal_rowcount.sql
2022-12-25 17:59:54.132617 (MainThread): 17:59:54  Parsing macros/generic_tests/not_accepted_values.sql
2022-12-25 17:59:54.134581 (MainThread): 17:59:54  Parsing macros/generic_tests/mutually_exclusive_ranges.sql
2022-12-25 17:59:54.143175 (MainThread): 17:59:54  Parsing macros/generic_tests/relationships_where.sql
2022-12-25 17:59:54.145196 (MainThread): 17:59:54  Parsing macros/generic_tests/not_empty_string.sql
2022-12-25 17:59:54.146973 (MainThread): 17:59:54  Parsing macros/generic_tests/accepted_range.sql
2022-12-25 17:59:54.149192 (MainThread): 17:59:54  Parsing macros/generic_tests/fewer_rows_than.sql
2022-12-25 17:59:54.153253 (MainThread): 17:59:54  Parsing macros/generic_tests/unique_combination_of_columns.sql
2022-12-25 17:59:54.155860 (MainThread): 17:59:54  Parsing macros/generic_tests/recency.sql
2022-12-25 17:59:54.159102 (MainThread): 17:59:54  Parsing macros/generic_tests/cardinality_equality.sql
2022-12-25 17:59:54.591537 (MainThread): 17:59:54  1699: static parser successfully parsed mart/fct_top_tracks.sql
2022-12-25 17:59:54.603200 (MainThread): 17:59:54  1699: static parser successfully parsed mart/fct_songplays.sql
2022-12-25 17:59:54.605862 (MainThread): 17:59:54  1699: static parser successfully parsed mart/fct_top_artists.sql
2022-12-25 17:59:54.608468 (MainThread): 17:59:54  1603: static parser failed on mart/dim_artists.sql
2022-12-25 17:59:54.613118 (MainThread): 17:59:54  1602: parser fallback to jinja rendering on mart/dim_artists.sql
2022-12-25 17:59:54.614453 (MainThread): 17:59:54  1603: static parser failed on mart/dim_albums.sql
2022-12-25 17:59:54.619435 (MainThread): 17:59:54  1602: parser fallback to jinja rendering on mart/dim_albums.sql
2022-12-25 17:59:54.620643 (MainThread): 17:59:54  1603: static parser failed on mart/dim_tracks.sql
2022-12-25 17:59:54.625207 (MainThread): 17:59:54  1602: parser fallback to jinja rendering on mart/dim_tracks.sql
2022-12-25 17:59:54.626497 (MainThread): 17:59:54  1699: static parser successfully parsed staging/stg_top_tracks.sql
2022-12-25 17:59:54.629125 (MainThread): 17:59:54  1699: static parser successfully parsed staging/stg_songplays.sql
2022-12-25 17:59:54.631756 (MainThread): 17:59:54  1699: static parser successfully parsed staging/stg_top_artists.sql
2022-12-25 17:59:54.634900 (MainThread): 17:59:54  1699: static parser successfully parsed view/vw_top_track_genres.sql
2022-12-25 17:59:54.637800 (MainThread): 17:59:54  1699: static parser successfully parsed view/vw_top_artist_genres.sql
2022-12-25 17:59:54.640742 (MainThread): 17:59:54  1699: static parser successfully parsed view/vw_songplays_genres.sql
2022-12-25 17:59:54.643565 (MainThread): 17:59:54  1699: static parser successfully parsed view/vw_songplays_albums.sql
2022-12-25 17:59:54.908827 (MainThread): 17:59:54  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26a2b86d-cbed-48ca-bccf-ae25b49c28dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd440f6220>]}
2022-12-25 17:59:54.936828 (MainThread): 17:59:54  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26a2b86d-cbed-48ca-bccf-ae25b49c28dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd446392e0>]}
2022-12-25 17:59:54.937084 (MainThread): 17:59:54  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 431 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 17:59:54.937181 (MainThread): 17:59:54  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26a2b86d-cbed-48ca-bccf-ae25b49c28dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd445bb670>]}
2022-12-25 17:59:54.939095 (MainThread): 17:59:54  
2022-12-25 17:59:54.939497 (MainThread): 17:59:54  Acquiring new bigquery connection "master"
2022-12-25 17:59:54.940928 (ThreadPoolExecutor-0_0): 17:59:54  Acquiring new bigquery connection "list_dbt-demo-data-372717"
2022-12-25 17:59:54.941073 (ThreadPoolExecutor-0_0): 17:59:54  Opening a new connection, currently in state init
2022-12-25 17:59:54.955071 (Thread-296): handling poll request
2022-12-25 17:59:54.955467 (Thread-296): 17:59:54  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb10123fa0>]}
2022-12-25 17:59:54.957386 (Thread-296): sending response (<Response 46984 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:59:55.141504 (ThreadPoolExecutor-1_0): 17:59:55  Acquiring new bigquery connection "list_dbt-demo-data-372717_dbt_ddemo"
2022-12-25 17:59:55.141696 (ThreadPoolExecutor-1_0): 17:59:55  Opening a new connection, currently in state closed
2022-12-25 17:59:55.302271 (MainThread): 17:59:55  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26a2b86d-cbed-48ca-bccf-ae25b49c28dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd443ca9a0>]}
2022-12-25 17:59:55.302902 (MainThread): 17:59:55  Concurrency: 4 threads (target='default')
2022-12-25 17:59:55.303013 (MainThread): 17:59:55  
2022-12-25 17:59:55.305717 (Thread-1): 17:59:55  Began running node model.spotify.stg_songplays
2022-12-25 17:59:55.306010 (Thread-1): 17:59:55  1 of 13 START sql view model dbt_ddemo.stg_songplays ........................... [RUN]
2022-12-25 17:59:55.306393 (Thread-1): 17:59:55  Acquiring new bigquery connection "model.spotify.stg_songplays"
2022-12-25 17:59:55.306499 (Thread-1): 17:59:55  Began compiling node model.spotify.stg_songplays
2022-12-25 17:59:55.306595 (Thread-1): 17:59:55  Compiling model.spotify.stg_songplays
2022-12-25 17:59:55.308598 (Thread-2): 17:59:55  Began running node model.spotify.stg_top_artists
2022-12-25 17:59:55.308837 (Thread-2): 17:59:55  2 of 13 START sql view model dbt_ddemo.stg_top_artists ......................... [RUN]
2022-12-25 17:59:55.309257 (Thread-2): 17:59:55  Acquiring new bigquery connection "model.spotify.stg_top_artists"
2022-12-25 17:59:55.309354 (Thread-2): 17:59:55  Began compiling node model.spotify.stg_top_artists
2022-12-25 17:59:55.309444 (Thread-2): 17:59:55  Compiling model.spotify.stg_top_artists
2022-12-25 17:59:55.312452 (Thread-2): 17:59:55  Writing injected SQL for node "model.spotify.stg_top_artists"
2022-12-25 17:59:55.312813 (Thread-3): 17:59:55  Began running node model.spotify.stg_top_tracks
2022-12-25 17:59:55.313055 (Thread-3): 17:59:55  3 of 13 START sql view model dbt_ddemo.stg_top_tracks .......................... [RUN]
2022-12-25 17:59:55.313473 (Thread-3): 17:59:55  Acquiring new bigquery connection "model.spotify.stg_top_tracks"
2022-12-25 17:59:55.313571 (Thread-3): 17:59:55  Began compiling node model.spotify.stg_top_tracks
2022-12-25 17:59:55.313710 (Thread-3): 17:59:55  Compiling model.spotify.stg_top_tracks
2022-12-25 17:59:55.316605 (Thread-3): 17:59:55  Writing injected SQL for node "model.spotify.stg_top_tracks"
2022-12-25 17:59:55.321241 (Thread-1): 17:59:55  Writing injected SQL for node "model.spotify.stg_songplays"
2022-12-25 17:59:55.328067 (Thread-3): 17:59:55  finished collecting timing info
2022-12-25 17:59:55.328221 (Thread-3): 17:59:55  Began executing node model.spotify.stg_top_tracks
2022-12-25 17:59:55.338978 (Thread-2): 17:59:55  finished collecting timing info
2022-12-25 17:59:55.339115 (Thread-2): 17:59:55  Began executing node model.spotify.stg_top_artists
2022-12-25 17:59:55.375413 (Thread-2): 17:59:55  Writing runtime sql for node "model.spotify.stg_top_artists"
2022-12-25 17:59:55.375938 (Thread-3): 17:59:55  Writing runtime sql for node "model.spotify.stg_top_tracks"
2022-12-25 17:59:55.381216 (Thread-1): 17:59:55  finished collecting timing info
2022-12-25 17:59:55.381357 (Thread-1): 17:59:55  Began executing node model.spotify.stg_songplays
2022-12-25 17:59:55.384077 (Thread-1): 17:59:55  Writing runtime sql for node "model.spotify.stg_songplays"
2022-12-25 17:59:55.389195 (Thread-3): 17:59:55  Opening a new connection, currently in state init
2022-12-25 17:59:55.389508 (Thread-2): 17:59:55  Opening a new connection, currently in state init
2022-12-25 17:59:55.393817 (Thread-3): 17:59:55  On model.spotify.stg_top_tracks: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "user", "target_name": "default", "node_id": "model.spotify.stg_top_tracks"} */


  create or replace view `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`
  OPTIONS()
  as -- stage_top_tracks
with source as (
    select
        *
    from `dbt-demo-data-372717`.`dbt_ddemo`.`current_user_top_tracks`
),

stage_top_tracks as (
    select
        track_rank,
        track_id,
    	track_name,
        track_duration,
        track_is_explicit,
        track_popularity,
        album_id,
        album_name,
        album_release_year,
        album_type,
        artist_name,
        artist_name_others,
        artist_id,
        artist_id_others,
        track_danceability,
        track_energy,
        track_key,
        track_loudness,
        track_mode,
        track_speechiness,
        track_acousticness,
        track_instrumentalness,
        track_liveness,
        track_valence,
        artist_popularity,
        artist_followers,
        artist_genre,
        artist_genre_others
    from source
)
select
    *
from stage_top_tracks;


2022-12-25 17:59:55.394756 (Thread-2): 17:59:55  On model.spotify.stg_top_artists: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "user", "target_name": "default", "node_id": "model.spotify.stg_top_artists"} */


  create or replace view `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_artists`
  OPTIONS()
  as -- stage_top_artists
with source as (
    select
        *
    from `dbt-demo-data-372717`.`dbt_ddemo`.`current_user_top_artists`
),

stage_top_artists as (
    select
        artist_rank,
        artist_id,
        artist_name,
        artist_popularity,
        artist_followers,
        artist_genre,
        artist_genre_others
    from source
)
select
    *
from stage_top_artists;


2022-12-25 17:59:55.395660 (Thread-1): 17:59:55  Opening a new connection, currently in state closed
2022-12-25 17:59:55.399863 (Thread-1): 17:59:55  On model.spotify.stg_songplays: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "user", "target_name": "default", "node_id": "model.spotify.stg_songplays"} */


  create or replace view `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`
  OPTIONS()
  as -- stage_songplays
with source as (
    select 
        *
    from `dbt-demo-data-372717`.`dbt_ddemo`.`current_user_recently_played`
),

stage_songplays as (
    select
        songplays_id,
        track_id,
    	track_name,
        track_duration,
        track_is_explicit,
        track_popularity,
        track_played_at,
        album_id,
        album_name,
        album_release_year,
        album_type,
        artist_name,
        artist_name_others,
        artist_id,
        artist_id_others,
        track_danceability,
        track_energy,
        track_key,
        track_loudness,
        track_mode,
        track_speechiness,
        track_acousticness,
        track_instrumentalness,
        track_liveness,
        track_valence,
        artist_popularity,
        artist_followers,
        artist_genre,
        artist_genre_others
    from source
)
select
    *
from stage_songplays;


2022-12-25 17:59:56.058280 (Thread-3): 17:59:56  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:4bf67f07-da3d-41dc-9bbc-69e69ad6dc56:US&page=queryresults
2022-12-25 17:59:56.075850 (Thread-3): 17:59:56  finished collecting timing info
2022-12-25 17:59:56.076425 (Thread-3): 17:59:56  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26a2b86d-cbed-48ca-bccf-ae25b49c28dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd2417d700>]}
2022-12-25 17:59:56.076772 (Thread-3): 17:59:56  3 of 13 OK created sql view model dbt_ddemo.stg_top_tracks ..................... [CREATE VIEW (0 processed) in 0.76s]
2022-12-25 17:59:56.076998 (Thread-3): 17:59:56  Finished running node model.spotify.stg_top_tracks
2022-12-25 17:59:56.078252 (Thread-4): 17:59:56  Began running node model.spotify.fct_top_tracks
2022-12-25 17:59:56.078526 (Thread-4): 17:59:56  4 of 13 START sql table model dbt_ddemo.fct_top_tracks ......................... [RUN]
2022-12-25 17:59:56.078950 (Thread-4): 17:59:56  Acquiring new bigquery connection "model.spotify.fct_top_tracks"
2022-12-25 17:59:56.079044 (Thread-4): 17:59:56  Began compiling node model.spotify.fct_top_tracks
2022-12-25 17:59:56.079125 (Thread-4): 17:59:56  Compiling model.spotify.fct_top_tracks
2022-12-25 17:59:56.083137 (Thread-4): 17:59:56  Writing injected SQL for node "model.spotify.fct_top_tracks"
2022-12-25 17:59:56.084349 (Thread-2): 17:59:56  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:d91ca768-fa47-4b53-8f25-76e052778199:US&page=queryresults
2022-12-25 17:59:56.085561 (Thread-2): 17:59:56  finished collecting timing info
2022-12-25 17:59:56.086069 (Thread-2): 17:59:56  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26a2b86d-cbed-48ca-bccf-ae25b49c28dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd24103610>]}
2022-12-25 17:59:56.086387 (Thread-2): 17:59:56  2 of 13 OK created sql view model dbt_ddemo.stg_top_artists .................... [CREATE VIEW (0 processed) in 0.78s]
2022-12-25 17:59:56.086578 (Thread-2): 17:59:56  Finished running node model.spotify.stg_top_artists
2022-12-25 17:59:56.087224 (Thread-3): 17:59:56  Began running node model.spotify.fct_top_artists
2022-12-25 17:59:56.087445 (Thread-3): 17:59:56  5 of 13 START sql table model dbt_ddemo.fct_top_artists ........................ [RUN]
2022-12-25 17:59:56.087794 (Thread-3): 17:59:56  Acquiring new bigquery connection "model.spotify.fct_top_artists"
2022-12-25 17:59:56.087885 (Thread-3): 17:59:56  Began compiling node model.spotify.fct_top_artists
2022-12-25 17:59:56.087967 (Thread-3): 17:59:56  Compiling model.spotify.fct_top_artists
2022-12-25 17:59:56.090733 (Thread-3): 17:59:56  Writing injected SQL for node "model.spotify.fct_top_artists"
2022-12-25 17:59:56.096474 (Thread-4): 17:59:56  finished collecting timing info
2022-12-25 17:59:56.096621 (Thread-4): 17:59:56  Began executing node model.spotify.fct_top_tracks
2022-12-25 17:59:56.107984 (Thread-4): 17:59:56  Opening a new connection, currently in state init
2022-12-25 17:59:56.114028 (Thread-3): 17:59:56  finished collecting timing info
2022-12-25 17:59:56.114180 (Thread-3): 17:59:56  Began executing node model.spotify.fct_top_artists
2022-12-25 17:59:56.116093 (Thread-3): 17:59:56  Opening a new connection, currently in state closed
2022-12-25 17:59:56.160296 (Thread-297): handling poll request
2022-12-25 17:59:56.160628 (Thread-297): 17:59:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed5e8400>]}
2022-12-25 17:59:56.161834 (Thread-297): sending response (<Response 29899 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:59:56.202771 (Thread-1): 17:59:56  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:e9c97368-a599-493e-b381-1adef672a1f0:US&page=queryresults
2022-12-25 17:59:56.204160 (Thread-1): 17:59:56  finished collecting timing info
2022-12-25 17:59:56.204687 (Thread-1): 17:59:56  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26a2b86d-cbed-48ca-bccf-ae25b49c28dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd2414bdf0>]}
2022-12-25 17:59:56.205139 (Thread-1): 17:59:56  1 of 13 OK created sql view model dbt_ddemo.stg_songplays ...................... [CREATE VIEW (0 processed) in 0.90s]
2022-12-25 17:59:56.205358 (Thread-1): 17:59:56  Finished running node model.spotify.stg_songplays
2022-12-25 17:59:56.205980 (Thread-2): 17:59:56  Began running node model.spotify.dim_albums
2022-12-25 17:59:56.206215 (Thread-2): 17:59:56  6 of 13 START sql table model dbt_ddemo.dim_albums ............................. [RUN]
2022-12-25 17:59:56.206589 (Thread-2): 17:59:56  Acquiring new bigquery connection "model.spotify.dim_albums"
2022-12-25 17:59:56.206684 (Thread-2): 17:59:56  Began compiling node model.spotify.dim_albums
2022-12-25 17:59:56.206765 (Thread-2): 17:59:56  Compiling model.spotify.dim_albums
2022-12-25 17:59:56.207225 (Thread-1): 17:59:56  Began running node model.spotify.dim_artists
2022-12-25 17:59:56.207427 (Thread-1): 17:59:56  7 of 13 START sql table model dbt_ddemo.dim_artists ............................ [RUN]
2022-12-25 17:59:56.207815 (Thread-1): 17:59:56  Acquiring new bigquery connection "model.spotify.dim_artists"
2022-12-25 17:59:56.207911 (Thread-1): 17:59:56  Began compiling node model.spotify.dim_artists
2022-12-25 17:59:56.207988 (Thread-1): 17:59:56  Compiling model.spotify.dim_artists
2022-12-25 17:59:56.211907 (Thread-1): 17:59:56  Writing injected SQL for node "model.spotify.dim_artists"
2022-12-25 17:59:56.215630 (Thread-2): 17:59:56  Writing injected SQL for node "model.spotify.dim_albums"
2022-12-25 17:59:56.226985 (Thread-1): 17:59:56  finished collecting timing info
2022-12-25 17:59:56.227124 (Thread-1): 17:59:56  Began executing node model.spotify.dim_artists
2022-12-25 17:59:56.232323 (Thread-2): 17:59:56  finished collecting timing info
2022-12-25 17:59:56.232453 (Thread-2): 17:59:56  Began executing node model.spotify.dim_albums
2022-12-25 17:59:56.256380 (Thread-2): 17:59:56  Writing runtime sql for node "model.spotify.dim_albums"
2022-12-25 17:59:56.256793 (Thread-1): 17:59:56  Writing runtime sql for node "model.spotify.dim_artists"
2022-12-25 17:59:56.268967 (Thread-2): 17:59:56  Opening a new connection, currently in state closed
2022-12-25 17:59:56.269796 (Thread-1): 17:59:56  Opening a new connection, currently in state closed
2022-12-25 17:59:56.273513 (Thread-2): 17:59:56  On model.spotify.dim_albums: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "user", "target_name": "default", "node_id": "model.spotify.dim_albums"} */

  
    

    create or replace table `dbt-demo-data-372717`.`dbt_ddemo`.`dim_albums`
    
    
    OPTIONS()
    as (
      -- albums table



    select distinct
        album_id,
        album_name,
        album_release_year,
        album_type                                   
    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`
    union distinct

    select distinct
        album_id,
        album_name,
        album_release_year,
        album_type                                   
    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`
    

    );
  
2022-12-25 17:59:56.274810 (Thread-1): 17:59:56  On model.spotify.dim_artists: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "user", "target_name": "default", "node_id": "model.spotify.dim_artists"} */

  
    

    create or replace table `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists`
    
    
    OPTIONS()
    as (
      -- artists table



    select distinct
        artist_id,
        artist_name,
        artist_popularity,
        artist_followers,
        artist_genre,
        artist_genre_others                                     
    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`
    union distinct

    select distinct
        artist_id,
        artist_name,
        artist_popularity,
        artist_followers,
        artist_genre,
        artist_genre_others                                     
    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_artists`
    union distinct

    select distinct
        artist_id,
        artist_name,
        artist_popularity,
        artist_followers,
        artist_genre,
        artist_genre_others                                     
    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`
    

    );
  
2022-12-25 17:59:56.291978 (Thread-4): 17:59:56  Writing runtime sql for node "model.spotify.fct_top_tracks"
2022-12-25 17:59:56.303400 (Thread-4): 17:59:56  On model.spotify.fct_top_tracks: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "user", "target_name": "default", "node_id": "model.spotify.fct_top_tracks"} */

  
    

    create or replace table `dbt-demo-data-372717`.`dbt_ddemo`.`fct_top_tracks`
    
    
    OPTIONS()
    as (
      -- top_tracks table
with source as (
    select
        *
    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`
),
fact_top_tracks as (
    select
        track_rank,
        track_id,
        album_id,
        artist_name_others,
        artist_id,
        artist_id_others
    from source
)
select
    *
from fact_top_tracks
    );
  
2022-12-25 17:59:56.327736 (Thread-3): 17:59:56  Writing runtime sql for node "model.spotify.fct_top_artists"
2022-12-25 17:59:56.338654 (Thread-3): 17:59:56  On model.spotify.fct_top_artists: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "user", "target_name": "default", "node_id": "model.spotify.fct_top_artists"} */

  
    

    create or replace table `dbt-demo-data-372717`.`dbt_ddemo`.`fct_top_artists`
    
    
    OPTIONS()
    as (
      -- top_artists table
with source as (
    select
        *
    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_artists`
),
fact_top_artists as (
    select
        artist_rank,
        artist_id
    from source
)
select
    *
from fact_top_artists
    );
  
2022-12-25 17:59:57.345803 (Thread-298): handling poll request
2022-12-25 17:59:57.346213 (Thread-298): 17:59:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed5ef190>]}
2022-12-25 17:59:57.347053 (Thread-298): sending response (<Response 15695 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:59:58.230137 (Thread-4): 17:59:58  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:71b4a029-b8bf-44cd-97d2-631ba97b2fd0:US&page=queryresults
2022-12-25 17:59:58.231550 (Thread-4): 17:59:58  finished collecting timing info
2022-12-25 17:59:58.232121 (Thread-4): 17:59:58  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26a2b86d-cbed-48ca-bccf-ae25b49c28dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcbc5b9f40>]}
2022-12-25 17:59:58.232477 (Thread-4): 17:59:58  4 of 13 OK created sql table model dbt_ddemo.fct_top_tracks .................... [CREATE TABLE (50.0 rows, 4.4 KB processed) in 2.15s]
2022-12-25 17:59:58.232719 (Thread-4): 17:59:58  Finished running node model.spotify.fct_top_tracks
2022-12-25 17:59:58.232870 (Thread-4): 17:59:58  Began running node model.spotify.dim_tracks
2022-12-25 17:59:58.233060 (Thread-4): 17:59:58  8 of 13 START sql table model dbt_ddemo.dim_tracks ............................. [RUN]
2022-12-25 17:59:58.233448 (Thread-4): 17:59:58  Acquiring new bigquery connection "model.spotify.dim_tracks"
2022-12-25 17:59:58.233541 (Thread-4): 17:59:58  Began compiling node model.spotify.dim_tracks
2022-12-25 17:59:58.233647 (Thread-4): 17:59:58  Compiling model.spotify.dim_tracks
2022-12-25 17:59:58.238362 (Thread-4): 17:59:58  Writing injected SQL for node "model.spotify.dim_tracks"
2022-12-25 17:59:58.249578 (Thread-4): 17:59:58  finished collecting timing info
2022-12-25 17:59:58.249743 (Thread-4): 17:59:58  Began executing node model.spotify.dim_tracks
2022-12-25 17:59:58.252359 (Thread-4): 17:59:58  Writing runtime sql for node "model.spotify.dim_tracks"
2022-12-25 17:59:58.263746 (Thread-4): 17:59:58  Opening a new connection, currently in state closed
2022-12-25 17:59:58.268018 (Thread-4): 17:59:58  On model.spotify.dim_tracks: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "user", "target_name": "default", "node_id": "model.spotify.dim_tracks"} */

  
    

    create or replace table `dbt-demo-data-372717`.`dbt_ddemo`.`dim_tracks`
    
    
    OPTIONS()
    as (
      -- tracks table



    select distinct
        track_id,
        track_name,
        track_duration,
        track_is_explicit,
        track_popularity,
        track_danceability,
        track_energy,
        track_key,
        track_loudness,
        track_mode,
        track_speechiness,
        track_acousticness,
        track_instrumentalness,
        track_liveness,
        track_valence
    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`
    union distinct

    select distinct
        track_id,
        track_name,
        track_duration,
        track_is_explicit,
        track_popularity,
        track_danceability,
        track_energy,
        track_key,
        track_loudness,
        track_mode,
        track_speechiness,
        track_acousticness,
        track_instrumentalness,
        track_liveness,
        track_valence
    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_top_tracks`
    

    );
  
2022-12-25 17:59:58.487926 (Thread-3): 17:59:58  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:cb81c546-de4f-4910-8aff-9726e93e9e2d:US&page=queryresults
2022-12-25 17:59:58.489224 (Thread-3): 17:59:58  finished collecting timing info
2022-12-25 17:59:58.489816 (Thread-3): 17:59:58  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26a2b86d-cbed-48ca-bccf-ae25b49c28dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd241d4c10>]}
2022-12-25 17:59:58.490164 (Thread-3): 17:59:58  5 of 13 OK created sql table model dbt_ddemo.fct_top_artists ................... [CREATE TABLE (50.0 rows, 1.6 KB processed) in 2.40s]
2022-12-25 17:59:58.490379 (Thread-3): 17:59:58  Finished running node model.spotify.fct_top_artists
2022-12-25 17:59:58.490529 (Thread-3): 17:59:58  Began running node model.spotify.fct_songplays
2022-12-25 17:59:58.490707 (Thread-3): 17:59:58  9 of 13 START sql table model dbt_ddemo.fct_songplays .......................... [RUN]
2022-12-25 17:59:58.491092 (Thread-3): 17:59:58  Acquiring new bigquery connection "model.spotify.fct_songplays"
2022-12-25 17:59:58.491197 (Thread-3): 17:59:58  Began compiling node model.spotify.fct_songplays
2022-12-25 17:59:58.491285 (Thread-3): 17:59:58  Compiling model.spotify.fct_songplays
2022-12-25 17:59:58.494525 (Thread-3): 17:59:58  Writing injected SQL for node "model.spotify.fct_songplays"
2022-12-25 17:59:58.507536 (Thread-3): 17:59:58  finished collecting timing info
2022-12-25 17:59:58.507684 (Thread-3): 17:59:58  Began executing node model.spotify.fct_songplays
2022-12-25 17:59:58.509726 (Thread-3): 17:59:58  Opening a new connection, currently in state closed
2022-12-25 17:59:58.539115 (Thread-299): handling poll request
2022-12-25 17:59:58.539449 (Thread-299): 17:59:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed5efe50>]}
2022-12-25 17:59:58.540256 (Thread-299): sending response (<Response 14017 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:59:58.546004 (Thread-1): 17:59:58  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:b3528234-9683-4c32-b6af-2821e9b94855:US&page=queryresults
2022-12-25 17:59:58.547021 (Thread-1): 17:59:58  finished collecting timing info
2022-12-25 17:59:58.547533 (Thread-1): 17:59:58  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26a2b86d-cbed-48ca-bccf-ae25b49c28dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd24076190>]}
2022-12-25 17:59:58.547845 (Thread-1): 17:59:58  7 of 13 OK created sql table model dbt_ddemo.dim_artists ....................... [CREATE TABLE (112.0 rows, 14.3 KB processed) in 2.34s]
2022-12-25 17:59:58.548048 (Thread-1): 17:59:58  Finished running node model.spotify.dim_artists
2022-12-25 17:59:58.548769 (Thread-1): 17:59:58  Began running node model.spotify.vw_top_artist_genres
2022-12-25 17:59:58.548980 (Thread-1): 17:59:58  10 of 13 START sql view model dbt_ddemo.vw_top_artist_genres ................... [RUN]
2022-12-25 17:59:58.549367 (Thread-1): 17:59:58  Acquiring new bigquery connection "model.spotify.vw_top_artist_genres"
2022-12-25 17:59:58.549461 (Thread-1): 17:59:58  Began compiling node model.spotify.vw_top_artist_genres
2022-12-25 17:59:58.549541 (Thread-1): 17:59:58  Compiling model.spotify.vw_top_artist_genres
2022-12-25 17:59:58.555481 (Thread-1): 17:59:58  Writing injected SQL for node "model.spotify.vw_top_artist_genres"
2022-12-25 17:59:58.571619 (Thread-1): 17:59:58  finished collecting timing info
2022-12-25 17:59:58.571766 (Thread-1): 17:59:58  Began executing node model.spotify.vw_top_artist_genres
2022-12-25 17:59:58.574559 (Thread-1): 17:59:58  Writing runtime sql for node "model.spotify.vw_top_artist_genres"
2022-12-25 17:59:58.588245 (Thread-1): 17:59:58  Opening a new connection, currently in state closed
2022-12-25 17:59:58.592496 (Thread-1): 17:59:58  On model.spotify.vw_top_artist_genres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "user", "target_name": "default", "node_id": "model.spotify.vw_top_artist_genres"} */


  create or replace view `dbt-demo-data-372717`.`dbt_ddemo`.`vw_top_artist_genres`
  OPTIONS()
  as -- top_artist_genres table
with artist_genres as (
    select
        a.artist_genre
    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_top_artists` f
    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)
    union all
    select
        unnest(string_to_array(a.artist_genre_others, ', ')) as artist_genre
    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_top_artists` f
    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)
)
select
    *,
    count(*) as count
from artist_genres
where artist_genre is not null
group by artist_genre       
order by count desc;


2022-12-25 17:59:58.698175 (Thread-3): 17:59:58  Writing runtime sql for node "model.spotify.fct_songplays"
2022-12-25 17:59:58.710455 (Thread-3): 17:59:58  On model.spotify.fct_songplays: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "user", "target_name": "default", "node_id": "model.spotify.fct_songplays"} */

  
    

    create or replace table `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays`
    
    
    OPTIONS()
    as (
      -- songplays table
with source as (
    select
        *
    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`
),
fact_songplays as (
    select
        songplays_id,
        track_id,
        track_played_at,
        album_id,
        artist_id,
        artist_id_others,
        artist_name_others
    from source
)
select
    *
from fact_songplays
    );
  
2022-12-25 17:59:58.716185 (Thread-2): 17:59:58  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:c428049c-adb4-4045-b8a0-d0865c267dcc:US&page=queryresults
2022-12-25 17:59:58.717601 (Thread-2): 17:59:58  finished collecting timing info
2022-12-25 17:59:58.718188 (Thread-2): 17:59:58  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26a2b86d-cbed-48ca-bccf-ae25b49c28dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd240dd8b0>]}
2022-12-25 17:59:58.718538 (Thread-2): 17:59:58  6 of 13 OK created sql table model dbt_ddemo.dim_albums ........................ [CREATE TABLE (90.0 rows, 5.6 KB processed) in 2.51s]
2022-12-25 17:59:58.718774 (Thread-2): 17:59:58  Finished running node model.spotify.dim_albums
2022-12-25 17:59:58.718923 (Thread-2): 17:59:58  Began running node model.spotify.vw_top_track_genres
2022-12-25 17:59:58.719105 (Thread-2): 17:59:58  11 of 13 START sql view model dbt_ddemo.vw_top_track_genres .................... [RUN]
2022-12-25 17:59:58.719522 (Thread-2): 17:59:58  Acquiring new bigquery connection "model.spotify.vw_top_track_genres"
2022-12-25 17:59:58.719619 (Thread-2): 17:59:58  Began compiling node model.spotify.vw_top_track_genres
2022-12-25 17:59:58.719702 (Thread-2): 17:59:58  Compiling model.spotify.vw_top_track_genres
2022-12-25 17:59:58.723593 (Thread-2): 17:59:58  Writing injected SQL for node "model.spotify.vw_top_track_genres"
2022-12-25 17:59:58.732500 (Thread-2): 17:59:58  finished collecting timing info
2022-12-25 17:59:58.732650 (Thread-2): 17:59:58  Began executing node model.spotify.vw_top_track_genres
2022-12-25 17:59:58.735530 (Thread-2): 17:59:58  Writing runtime sql for node "model.spotify.vw_top_track_genres"
2022-12-25 17:59:58.743858 (Thread-2): 17:59:58  Opening a new connection, currently in state closed
2022-12-25 17:59:58.748154 (Thread-2): 17:59:58  On model.spotify.vw_top_track_genres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "user", "target_name": "default", "node_id": "model.spotify.vw_top_track_genres"} */


  create or replace view `dbt-demo-data-372717`.`dbt_ddemo`.`vw_top_track_genres`
  OPTIONS()
  as -- top_track_genres table
with track_genres as (
    select
        a.artist_genre
    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_top_tracks` f
    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)
    union all
    select
        unnest(string_to_array(a.artist_genre_others, ', ')) as artist_genre
    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_top_tracks` f
    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)
)
select
    *,
    count(*) as count
from track_genres
where artist_genre is not null
group by artist_genre       
order by count desc;


2022-12-25 17:59:58.771034 (Thread-1): 17:59:58  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword UNNEST at [14:9]')
2022-12-25 17:59:58.938597 (Thread-2): 17:59:58  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword UNNEST at [14:9]')
2022-12-25 17:59:59.737480 (Thread-300): handling poll request
2022-12-25 17:59:59.737914 (Thread-300): 17:59:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed5fad60>]}
2022-12-25 17:59:59.738811 (Thread-300): sending response (<Response 17900 bytes [200 OK]>) to 10.0.192.137
2022-12-25 17:59:59.840203 (Thread-1): 17:59:59  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:US:8a10d143-7753-439c-b092-5590789cc0ea&page=queryresults
2022-12-25 17:59:59.840470 (Thread-1): 17:59:59  finished collecting timing info
2022-12-25 17:59:59.841026 (Thread-1): 17:59:59  Database Error in model vw_top_artist_genres (models/view/vw_top_artist_genres.sql)
  Syntax error: Unexpected keyword UNNEST at [14:9]
  compiled Code at target/run/spotify/models/view/vw_top_artist_genres.sql
2022-12-25 17:59:59.841227 (Thread-1): 17:59:59  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26a2b86d-cbed-48ca-bccf-ae25b49c28dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcbc4bbb20>]}
2022-12-25 17:59:59.841581 (Thread-1): 17:59:59  10 of 13 ERROR creating sql view model dbt_ddemo.vw_top_artist_genres .......... [ERROR in 1.29s]
2022-12-25 17:59:59.841840 (Thread-1): 17:59:59  Finished running node model.spotify.vw_top_artist_genres
2022-12-25 17:59:59.856484 (Thread-2): 17:59:59  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:US:bdf8f446-acb8-46a4-b918-f3b5be12dcd8&page=queryresults
2022-12-25 17:59:59.856699 (Thread-2): 17:59:59  finished collecting timing info
2022-12-25 17:59:59.857192 (Thread-2): 17:59:59  Database Error in model vw_top_track_genres (models/view/vw_top_track_genres.sql)
  Syntax error: Unexpected keyword UNNEST at [14:9]
  compiled Code at target/run/spotify/models/view/vw_top_track_genres.sql
2022-12-25 17:59:59.857363 (Thread-2): 17:59:59  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26a2b86d-cbed-48ca-bccf-ae25b49c28dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcbc4b6bb0>]}
2022-12-25 17:59:59.857710 (Thread-2): 17:59:59  11 of 13 ERROR creating sql view model dbt_ddemo.vw_top_track_genres ........... [ERROR in 1.14s]
2022-12-25 17:59:59.857916 (Thread-2): 17:59:59  Finished running node model.spotify.vw_top_track_genres
2022-12-25 18:00:00.566599 (Thread-4): 18:00:00  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:b18cde33-4d6d-4b01-8489-521ae0bfb42e:US&page=queryresults
2022-12-25 18:00:00.567816 (Thread-4): 18:00:00  finished collecting timing info
2022-12-25 18:00:00.568391 (Thread-4): 18:00:00  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26a2b86d-cbed-48ca-bccf-ae25b49c28dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd24051a00>]}
2022-12-25 18:00:00.568873 (Thread-4): 18:00:00  8 of 13 OK created sql table model dbt_ddemo.dim_tracks ........................ [CREATE TABLE (91.0 rows, 13.5 KB processed) in 2.34s]
2022-12-25 18:00:00.569138 (Thread-4): 18:00:00  Finished running node model.spotify.dim_tracks
2022-12-25 18:00:00.672984 (Thread-3): 18:00:00  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:77e30d4b-964c-4ba4-b085-893448b580b2:US&page=queryresults
2022-12-25 18:00:00.674241 (Thread-3): 18:00:00  finished collecting timing info
2022-12-25 18:00:00.674779 (Thread-3): 18:00:00  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26a2b86d-cbed-48ca-bccf-ae25b49c28dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdd240661f0>]}
2022-12-25 18:00:00.675114 (Thread-3): 18:00:00  9 of 13 OK created sql table model dbt_ddemo.fct_songplays ..................... [CREATE TABLE (50.0 rows, 4.5 KB processed) in 2.18s]
2022-12-25 18:00:00.675361 (Thread-3): 18:00:00  Finished running node model.spotify.fct_songplays
2022-12-25 18:00:00.676443 (Thread-1): 18:00:00  Began running node model.spotify.vw_songplays_albums
2022-12-25 18:00:00.676699 (Thread-1): 18:00:00  12 of 13 START sql view model dbt_ddemo.vw_songplays_albums .................... [RUN]
2022-12-25 18:00:00.677107 (Thread-1): 18:00:00  Acquiring new bigquery connection "model.spotify.vw_songplays_albums"
2022-12-25 18:00:00.677205 (Thread-1): 18:00:00  Began compiling node model.spotify.vw_songplays_albums
2022-12-25 18:00:00.677292 (Thread-1): 18:00:00  Compiling model.spotify.vw_songplays_albums
2022-12-25 18:00:00.681293 (Thread-1): 18:00:00  Writing injected SQL for node "model.spotify.vw_songplays_albums"
2022-12-25 18:00:00.681605 (Thread-2): 18:00:00  Began running node model.spotify.vw_songplays_genres
2022-12-25 18:00:00.681850 (Thread-2): 18:00:00  13 of 13 START sql view model dbt_ddemo.vw_songplays_genres .................... [RUN]
2022-12-25 18:00:00.682215 (Thread-2): 18:00:00  Acquiring new bigquery connection "model.spotify.vw_songplays_genres"
2022-12-25 18:00:00.682335 (Thread-2): 18:00:00  Began compiling node model.spotify.vw_songplays_genres
2022-12-25 18:00:00.682429 (Thread-2): 18:00:00  Compiling model.spotify.vw_songplays_genres
2022-12-25 18:00:00.689779 (Thread-2): 18:00:00  Writing injected SQL for node "model.spotify.vw_songplays_genres"
2022-12-25 18:00:00.695278 (Thread-1): 18:00:00  finished collecting timing info
2022-12-25 18:00:00.695432 (Thread-1): 18:00:00  Began executing node model.spotify.vw_songplays_albums
2022-12-25 18:00:00.698173 (Thread-1): 18:00:00  Writing runtime sql for node "model.spotify.vw_songplays_albums"
2022-12-25 18:00:00.702909 (Thread-2): 18:00:00  finished collecting timing info
2022-12-25 18:00:00.703057 (Thread-2): 18:00:00  Began executing node model.spotify.vw_songplays_genres
2022-12-25 18:00:00.705794 (Thread-2): 18:00:00  Writing runtime sql for node "model.spotify.vw_songplays_genres"
2022-12-25 18:00:00.710697 (Thread-1): 18:00:00  Opening a new connection, currently in state closed
2022-12-25 18:00:00.714982 (Thread-1): 18:00:00  On model.spotify.vw_songplays_albums: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "user", "target_name": "default", "node_id": "model.spotify.vw_songplays_albums"} */


  create or replace view `dbt-demo-data-372717`.`dbt_ddemo`.`vw_songplays_albums`
  OPTIONS()
  as -- songplays_albums table
with songplay_albums as (
    select
        f.*,
        a.album_name,
        a.album_release_year,
        a.album_type,
        t.track_name,
        track_popularity,
        track_danceability,
        track_speechiness
    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f
    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_tracks` t using (track_id)
    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_albums` a using (album_id)
)
select
    *
from songplay_albums;


2022-12-25 18:00:00.715891 (Thread-2): 18:00:00  Opening a new connection, currently in state closed
2022-12-25 18:00:00.720065 (Thread-2): 18:00:00  On model.spotify.vw_songplays_genres: /* {"app": "dbt", "dbt_version": "1.3.1", "profile_name": "user", "target_name": "default", "node_id": "model.spotify.vw_songplays_genres"} */


  create or replace view `dbt-demo-data-372717`.`dbt_ddemo`.`vw_songplays_genres`
  OPTIONS()
  as -- songplays_genres table
with artist_genres as (
    select
        a.artist_genre
    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f
    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)
    union all
    select
        unnest(string_to_array(a.artist_genre_others, ', ')) as artist_genre
    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f
    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)
)
select
    *,
    count(*) as count
from artist_genres
where artist_genre is not null
group by artist_genre       
order by count desc;


2022-12-25 18:00:00.878934 (Thread-2): 18:00:00  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword UNNEST at [14:9]')
2022-12-25 18:00:00.930040 (Thread-301): handling poll request
2022-12-25 18:00:00.930402 (Thread-301): 18:00:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed57db50>]}
2022-12-25 18:00:00.931349 (Thread-301): sending response (<Response 22004 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:00:01.151123 (Thread-2): 18:00:01  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:US:9b0f50dc-5d2f-4559-9aaf-a171d68d911e&page=queryresults
2022-12-25 18:00:01.151376 (Thread-2): 18:00:01  finished collecting timing info
2022-12-25 18:00:01.151918 (Thread-2): 18:00:01  Database Error in model vw_songplays_genres (models/view/vw_songplays_genres.sql)
  Syntax error: Unexpected keyword UNNEST at [14:9]
  compiled Code at target/run/spotify/models/view/vw_songplays_genres.sql
2022-12-25 18:00:01.152116 (Thread-2): 18:00:01  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26a2b86d-cbed-48ca-bccf-ae25b49c28dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcbc4351c0>]}
2022-12-25 18:00:01.152451 (Thread-2): 18:00:01  13 of 13 ERROR creating sql view model dbt_ddemo.vw_songplays_genres ........... [ERROR in 0.47s]
2022-12-25 18:00:01.152663 (Thread-2): 18:00:01  Finished running node model.spotify.vw_songplays_genres
2022-12-25 18:00:01.197351 (Thread-1): 18:00:01  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:20ea097c-18c2-4f37-8dc3-b273e5c92845:US&page=queryresults
2022-12-25 18:00:01.198553 (Thread-1): 18:00:01  finished collecting timing info
2022-12-25 18:00:01.199070 (Thread-1): 18:00:01  Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26a2b86d-cbed-48ca-bccf-ae25b49c28dc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdcbc4c3a30>]}
2022-12-25 18:00:01.199401 (Thread-1): 18:00:01  12 of 13 OK created sql view model dbt_ddemo.vw_songplays_albums ............... [CREATE VIEW (0 processed) in 0.52s]
2022-12-25 18:00:01.199610 (Thread-1): 18:00:01  Finished running node model.spotify.vw_songplays_albums
2022-12-25 18:00:01.201237 (MainThread): 18:00:01  Acquiring new bigquery connection "master"
2022-12-25 18:00:01.201747 (MainThread): 18:00:01  
2022-12-25 18:00:01.201848 (MainThread): 18:00:01  Finished running 7 view models, 6 table models in 0 hours 0 minutes and 6.26 seconds (6.26s).
2022-12-25 18:00:01.201928 (MainThread): 18:00:01  Connection 'master' was properly closed.
2022-12-25 18:00:01.201992 (MainThread): 18:00:01  Connection 'model.spotify.vw_songplays_albums' was properly closed.
2022-12-25 18:00:01.202055 (MainThread): 18:00:01  Connection 'model.spotify.vw_songplays_genres' was properly closed.
2022-12-25 18:00:01.202116 (MainThread): 18:00:01  Connection 'model.spotify.fct_songplays' was properly closed.
2022-12-25 18:00:01.202174 (MainThread): 18:00:01  Connection 'model.spotify.dim_tracks' was properly closed.
2022-12-25 18:00:01.278623 (MainThread): 18:00:01  
2022-12-25 18:00:01.278786 (MainThread): 18:00:01  Completed with 3 errors and 0 warnings:
2022-12-25 18:00:01.278874 (MainThread): 18:00:01  
2022-12-25 18:00:01.278959 (MainThread): 18:00:01  Database Error in model vw_top_artist_genres (models/view/vw_top_artist_genres.sql)
2022-12-25 18:00:01.279032 (MainThread): 18:00:01    Syntax error: Unexpected keyword UNNEST at [14:9]
2022-12-25 18:00:01.279098 (MainThread): 18:00:01    compiled Code at target/run/spotify/models/view/vw_top_artist_genres.sql
2022-12-25 18:00:01.279166 (MainThread): 18:00:01  
2022-12-25 18:00:01.279250 (MainThread): 18:00:01  Database Error in model vw_top_track_genres (models/view/vw_top_track_genres.sql)
2022-12-25 18:00:01.279315 (MainThread): 18:00:01    Syntax error: Unexpected keyword UNNEST at [14:9]
2022-12-25 18:00:01.279375 (MainThread): 18:00:01    compiled Code at target/run/spotify/models/view/vw_top_track_genres.sql
2022-12-25 18:00:01.279440 (MainThread): 18:00:01  
2022-12-25 18:00:01.279509 (MainThread): 18:00:01  Database Error in model vw_songplays_genres (models/view/vw_songplays_genres.sql)
2022-12-25 18:00:01.279572 (MainThread): 18:00:01    Syntax error: Unexpected keyword UNNEST at [14:9]
2022-12-25 18:00:01.279632 (MainThread): 18:00:01    compiled Code at target/run/spotify/models/view/vw_songplays_genres.sql
2022-12-25 18:00:01.279716 (MainThread): 18:00:01  
2022-12-25 18:00:01.279790 (MainThread): 18:00:01  Done. PASS=10 WARN=0 ERROR=3 SKIP=0 TOTAL=13
2022-12-25 18:00:02.150186 (Thread-302): handling poll request
2022-12-25 18:00:02.150593 (Thread-302): 18:00:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed59d520>]}
2022-12-25 18:00:02.153227 (Thread-302): sending response (<Response 67372 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:00:02.761802 (Thread-303): handling status request
2022-12-25 18:00:02.762216 (Thread-303): 18:00:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed5a6700>]}
2022-12-25 18:00:02.762736 (Thread-303): sending response (<Response 1273 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:00:02.913382 (Thread-304): handling status request
2022-12-25 18:00:02.913814 (Thread-304): 18:00:02  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed5b1430>]}
2022-12-25 18:00:02.914284 (Thread-304): sending response (<Response 1273 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:00:56.056101 (Thread-305): handling status request
2022-12-25 18:00:56.056558 (Thread-305): 18:00:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed58d8e0>]}
2022-12-25 18:00:56.057020 (Thread-305): sending response (<Response 1273 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:00:56.240146 (Thread-306): handling run_sql request
2022-12-25 18:00:56.240522 (Thread-306): 18:00:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed5b1640>]}
2022-12-25 18:00:58.827324 (Thread-306): sending response (<Response 140 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:00:58.859136 (MainThread): 18:00:58  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7fd9aa36-9750-4f7f-bb26-016007b3e8cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31a0331c40>]}
2022-12-25 18:00:58.859657 (MainThread): 18:00:58  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 431 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 18:00:58.860220 (Thread-1): 18:00:58  Acquiring new bigquery connection "rpc.spotify.request"
2022-12-25 18:00:58.860360 (Thread-1): 18:00:58  Began compiling node rpc.spotify.request
2022-12-25 18:00:58.860450 (Thread-1): 18:00:58  Compiling rpc.spotify.request
2022-12-25 18:00:58.863566 (Thread-1): 18:00:58  finished collecting timing info
2022-12-25 18:00:58.863700 (Thread-1): 18:00:58  Began executing node rpc.spotify.request
2022-12-25 18:00:58.863805 (Thread-1): 18:00:58  Opening a new connection, currently in state init
2022-12-25 18:00:58.868415 (Thread-1): 18:00:58  On rpc.spotify.request: -- songplays_albums table
with songplay_albums as (
    select
        f.*,
        a.album_name,
        a.album_release_year,
        a.album_type,
        t.track_name,
        track_popularity,
        track_danceability,
        track_speechiness
    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f
    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_tracks` t using (track_id)
    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_albums` a using (album_id)
)
select
    *
from songplay_albums
limit 500
/* limit added automatically by dbt cloud */
2022-12-25 18:00:59.099803 (Thread-307): handling poll request
2022-12-25 18:00:59.100245 (Thread-307): 18:00:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed5b95b0>]}
2022-12-25 18:00:59.101093 (Thread-307): sending response (<Response 4005 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:00:59.943484 (Thread-1): 18:00:59  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:099b9075-72c3-40b6-b296-f78526902bb4:US&page=queryresults
2022-12-25 18:00:59.943785 (Thread-1): 18:00:59  finished collecting timing info
2022-12-25 18:01:00.309082 (Thread-308): handling poll request
2022-12-25 18:01:00.309496 (Thread-308): 18:01:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed5b9e80>]}
2022-12-25 18:01:00.310938 (Thread-308): sending response (<Response 15795 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:01:07.730265 (Thread-309): handling status request
2022-12-25 18:01:07.730683 (Thread-309): 18:01:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed54b160>]}
2022-12-25 18:01:07.731206 (Thread-309): sending response (<Response 1273 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:01:07.914097 (Thread-310): handling run_sql request
2022-12-25 18:01:07.914461 (Thread-310): 18:01:07  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed54b340>]}
2022-12-25 18:01:10.513800 (Thread-310): sending response (<Response 140 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:01:10.546972 (MainThread): 18:01:10  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1fc476a-2ff0-4d78-9257-89d05e0a6367', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96d0097bb0>]}
2022-12-25 18:01:10.547489 (MainThread): 18:01:10  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 431 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 18:01:10.548084 (Thread-1): 18:01:10  Acquiring new bigquery connection "rpc.spotify.request"
2022-12-25 18:01:10.548230 (Thread-1): 18:01:10  Began compiling node rpc.spotify.request
2022-12-25 18:01:10.548371 (Thread-1): 18:01:10  Compiling rpc.spotify.request
2022-12-25 18:01:10.551834 (Thread-1): 18:01:10  finished collecting timing info
2022-12-25 18:01:10.551977 (Thread-1): 18:01:10  Began executing node rpc.spotify.request
2022-12-25 18:01:10.552086 (Thread-1): 18:01:10  Opening a new connection, currently in state init
2022-12-25 18:01:10.556703 (Thread-1): 18:01:10  On rpc.spotify.request: -- songplays_genres table
with artist_genres as (
    select
        a.artist_genre
    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f
    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)
    union all
    select
        unnest(string_to_array(a.artist_genre_others, ', ')) as artist_genre
    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f
    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)
)
select
    *,
    count(*) as count
from artist_genres
where artist_genre is not null
group by artist_genre       
order by count desc
limit 500
/* limit added automatically by dbt cloud */
2022-12-25 18:01:10.755052 (Thread-1): 18:01:10  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword UNNEST at [9:9]')
2022-12-25 18:01:10.765970 (Thread-311): handling poll request
2022-12-25 18:01:10.766431 (Thread-311): 18:01:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed557730>]}
2022-12-25 18:01:10.767350 (Thread-311): sending response (<Response 4473 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:01:11.401214 (Thread-1): 18:01:11  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:US:8a33918e-a21f-40c3-aaaa-d5df2df64a22&page=queryresults
2022-12-25 18:01:11.401434 (Thread-1): 18:01:11  finished collecting timing info
2022-12-25 18:01:11.401568 (Thread-1): Got an exception: Database Error
  Syntax error: Unexpected keyword UNNEST at [9:9]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 207, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 646, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 429, in fn
    return self._query_and_results(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 631, in _query_and_results
    iterator = query_job.result(timeout=job_execution_timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1303, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 679, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Syntax error: Unexpected keyword UNNEST at [9:9]

(job ID: 8a33918e-a21f-40c3-aaaa-d5df2df64a22)

                            -----Query Job SQL Follows-----                            

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:-- songplays_genres table
   2:with artist_genres as (
   3:    select
   4:        a.artist_genre
   5:    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f
   6:    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)
   7:    union all
   8:    select
   9:        unnest(string_to_array(a.artist_genre_others, ', ')) as artist_genre
  10:    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f
  11:    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)
  12:)
  13:select
  14:    *,
  15:    count(*) as count
  16:from artist_genres
  17:where artist_genre is not null
  18:group by artist_genre       
  19:order by count desc
  20:limit 500
  21:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 385, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 338, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 429, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 108, in execute
    _, execute_result = self.adapter.execute(compiled_sql, fetch=True)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 278, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 446, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 437, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 646, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 211, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 199, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  Syntax error: Unexpected keyword UNNEST at [9:9]
2022-12-25 18:01:11.403794 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system.sql)\n  Syntax error: Unexpected keyword UNNEST at [9:9]', 'raw_code': "-- songplays_genres table\r\nwith artist_genres as (\r\n    select\r\n        a.artist_genre\r\n    from {{ ref('fct_songplays') }} f\r\n    left join {{ ref('dim_artists') }} a using (artist_id)\r\n    union all\r\n    select\r\n        unnest(string_to_array(a.artist_genre_others, ', ')) as artist_genre\r\n    from {{ ref('fct_songplays') }} f\r\n    left join {{ ref('dim_artists') }} a using (artist_id)\r\n)\r\nselect\r\n    *,\r\n    count(*) as count\r\nfrom artist_genres\r\nwhere artist_genre is not null\r\ngroup by artist_genre       \r\norder by count desc\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_code': "-- songplays_genres table\nwith artist_genres as (\n    select\n        a.artist_genre\n    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f\n    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)\n    union all\n    select\n        unnest(string_to_array(a.artist_genre_others, ', ')) as artist_genre\n    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f\n    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)\n)\nselect\n    *,\n    count(*) as count\nfrom artist_genres\nwhere artist_genre is not null\ngroup by artist_genre       \norder by count desc\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 148, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 68, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system.sql)\n  Syntax error: Unexpected keyword UNNEST at [9:9]', 'raw_code': "-- songplays_genres table\r\nwith artist_genres as (\r\n    select\r\n        a.artist_genre\r\n    from {{ ref('fct_songplays') }} f\r\n    left join {{ ref('dim_artists') }} a using (artist_id)\r\n    union all\r\n    select\r\n        unnest(string_to_array(a.artist_genre_others, ', ')) as artist_genre\r\n    from {{ ref('fct_songplays') }} f\r\n    left join {{ ref('dim_artists') }} a using (artist_id)\r\n)\r\nselect\r\n    *,\r\n    count(*) as count\r\nfrom artist_genres\r\nwhere artist_genre is not null\r\ngroup by artist_genre       \r\norder by count desc\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_code': "-- songplays_genres table\nwith artist_genres as (\n    select\n        a.artist_genre\n    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f\n    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)\n    union all\n    select\n        unnest(string_to_array(a.artist_genre_others, ', ')) as artist_genre\n    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f\n    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)\n)\nselect\n    *,\n    count(*) as count\nfrom artist_genres\nwhere artist_genre is not null\ngroup by artist_genre       \norder by count desc\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-12-25 18:01:11.965272 (Thread-312): handling poll request
2022-12-25 18:01:11.965705 (Thread-312): 18:01:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed557880>]}
2022-12-25 18:01:11.966345 (Thread-312): sending response (<Response 15242 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:02:48.238571 (Thread-313): handling status request
2022-12-25 18:02:48.240205 (Thread-313): 18:02:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed557d60>]}
2022-12-25 18:02:48.240726 (Thread-313): sending response (<Response 1273 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:02:48.428315 (Thread-314): handling run_sql request
2022-12-25 18:02:48.428683 (Thread-314): 18:02:48  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed557ee0>]}
2022-12-25 18:02:51.049485 (Thread-314): sending response (<Response 140 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:02:51.082607 (MainThread): 18:02:51  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6db96b03-fc35-4ce1-b68b-f643865aa3d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e1c497df0>]}
2022-12-25 18:02:51.083120 (MainThread): 18:02:51  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 431 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 18:02:51.083702 (Thread-1): 18:02:51  Acquiring new bigquery connection "rpc.spotify.request"
2022-12-25 18:02:51.083839 (Thread-1): 18:02:51  Began compiling node rpc.spotify.request
2022-12-25 18:02:51.083938 (Thread-1): 18:02:51  Compiling rpc.spotify.request
2022-12-25 18:02:51.087248 (Thread-1): 18:02:51  finished collecting timing info
2022-12-25 18:02:51.087383 (Thread-1): 18:02:51  Began executing node rpc.spotify.request
2022-12-25 18:02:51.087487 (Thread-1): 18:02:51  Opening a new connection, currently in state init
2022-12-25 18:02:51.091888 (Thread-1): 18:02:51  On rpc.spotify.request: -- songplays_genres table
with artist_genres as (
    select
        a.artist_genre
    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f
    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)
    union all
    select
        string_to_array(a.artist_genre_others, ', ') as artist_genre
    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f
    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)
)
select
    *,
    count(*) as count
from artist_genres
where artist_genre is not null
group by artist_genre       
order by count desc
limit 500
/* limit added automatically by dbt cloud */
2022-12-25 18:02:51.234235 (Thread-315): handling poll request
2022-12-25 18:02:51.234677 (Thread-315): 18:02:51  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed5603d0>]}
2022-12-25 18:02:51.235565 (Thread-315): sending response (<Response 4099 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:02:51.399472 (Thread-1): 18:02:51  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Function not found: string_to_array at [9:9]')
2022-12-25 18:02:52.340709 (Thread-1): 18:02:52  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:US:d7f6d74c-403d-4e3a-bca2-838ab3447dce&page=queryresults
2022-12-25 18:02:52.341054 (Thread-1): 18:02:52  finished collecting timing info
2022-12-25 18:02:52.341270 (Thread-1): Got an exception: Database Error
  Function not found: string_to_array at [9:9]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 207, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 646, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 429, in fn
    return self._query_and_results(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 631, in _query_and_results
    iterator = query_job.result(timeout=job_execution_timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1303, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 679, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Function not found: string_to_array at [9:9]

(job ID: d7f6d74c-403d-4e3a-bca2-838ab3447dce)

                            -----Query Job SQL Follows-----                            

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:-- songplays_genres table
   2:with artist_genres as (
   3:    select
   4:        a.artist_genre
   5:    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f
   6:    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)
   7:    union all
   8:    select
   9:        string_to_array(a.artist_genre_others, ', ') as artist_genre
  10:    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f
  11:    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)
  12:)
  13:select
  14:    *,
  15:    count(*) as count
  16:from artist_genres
  17:where artist_genre is not null
  18:group by artist_genre       
  19:order by count desc
  20:limit 500
  21:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 385, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 338, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 429, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 108, in execute
    _, execute_result = self.adapter.execute(compiled_sql, fetch=True)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 278, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 446, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 437, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 646, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 211, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 199, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  Function not found: string_to_array at [9:9]
2022-12-25 18:02:52.344313 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system.sql)\n  Function not found: string_to_array at [9:9]', 'raw_code': "-- songplays_genres table\r\nwith artist_genres as (\r\n    select\r\n        a.artist_genre\r\n    from {{ ref('fct_songplays') }} f\r\n    left join {{ ref('dim_artists') }} a using (artist_id)\r\n    union all\r\n    select\r\n        string_to_array(a.artist_genre_others, ', ') as artist_genre\r\n    from {{ ref('fct_songplays') }} f\r\n    left join {{ ref('dim_artists') }} a using (artist_id)\r\n)\r\nselect\r\n    *,\r\n    count(*) as count\r\nfrom artist_genres\r\nwhere artist_genre is not null\r\ngroup by artist_genre       \r\norder by count desc\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_code': "-- songplays_genres table\nwith artist_genres as (\n    select\n        a.artist_genre\n    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f\n    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)\n    union all\n    select\n        string_to_array(a.artist_genre_others, ', ') as artist_genre\n    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f\n    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)\n)\nselect\n    *,\n    count(*) as count\nfrom artist_genres\nwhere artist_genre is not null\ngroup by artist_genre       \norder by count desc\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 148, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 68, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system.sql)\n  Function not found: string_to_array at [9:9]', 'raw_code': "-- songplays_genres table\r\nwith artist_genres as (\r\n    select\r\n        a.artist_genre\r\n    from {{ ref('fct_songplays') }} f\r\n    left join {{ ref('dim_artists') }} a using (artist_id)\r\n    union all\r\n    select\r\n        string_to_array(a.artist_genre_others, ', ') as artist_genre\r\n    from {{ ref('fct_songplays') }} f\r\n    left join {{ ref('dim_artists') }} a using (artist_id)\r\n)\r\nselect\r\n    *,\r\n    count(*) as count\r\nfrom artist_genres\r\nwhere artist_genre is not null\r\ngroup by artist_genre       \r\norder by count desc\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_code': "-- songplays_genres table\nwith artist_genres as (\n    select\n        a.artist_genre\n    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f\n    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)\n    union all\n    select\n        string_to_array(a.artist_genre_others, ', ') as artist_genre\n    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f\n    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)\n)\nselect\n    *,\n    count(*) as count\nfrom artist_genres\nwhere artist_genre is not null\ngroup by artist_genre       \norder by count desc\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-12-25 18:02:52.429778 (Thread-316): handling poll request
2022-12-25 18:02:52.430209 (Thread-316): 18:02:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed560a60>]}
2022-12-25 18:02:52.430811 (Thread-316): sending response (<Response 10224 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:02:53.632217 (Thread-317): handling poll request
2022-12-25 18:02:53.632627 (Thread-317): 18:02:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed560fa0>]}
2022-12-25 18:02:53.633276 (Thread-317): sending response (<Response 15150 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:04:10.256735 (Thread-318): handling status request
2022-12-25 18:04:10.257611 (Thread-319): handling status request
2022-12-25 18:04:10.258371 (Thread-318): 18:04:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed563310>]}
2022-12-25 18:04:10.258665 (Thread-319): 18:04:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed563ca0>]}
2022-12-25 18:04:10.259234 (Thread-318): sending response (<Response 1249 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:04:10.259703 (Thread-319): sending response (<Response 1249 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:04:10.264083 (Thread-320): handling list request
2022-12-25 18:04:10.264746 (Thread-321): handling list request
2022-12-25 18:04:10.264942 (Thread-320): 18:04:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed563610>]}
2022-12-25 18:04:10.265225 (Thread-321): 18:04:10  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed5639d0>]}
2022-12-25 18:04:10.308076 (Thread-321): 18:04:10  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1010e4c0>]}
2022-12-25 18:04:10.308473 (Thread-320): 18:04:10  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 431 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 18:04:10.317814 (Thread-320): sending response (<Response 19311 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:04:10.308753 (Thread-321): 18:04:10  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 431 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 18:04:10.309071 (Thread-320): 18:04:10  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec350c8d90>]}
2022-12-25 18:04:10.309329 (Thread-321): 18:04:10  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1010e910>]}
2022-12-25 18:04:10.319335 (Thread-321): sending response (<Response 4814 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:04:13.824097 (Thread-322): handling status request
2022-12-25 18:04:13.824524 (Thread-322): 18:04:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed5e5940>]}
2022-12-25 18:04:13.825027 (Thread-322): sending response (<Response 1249 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:04:13.829303 (Thread-323): handling list request
2022-12-25 18:04:13.829589 (Thread-323): 18:04:13  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed5e55e0>]}
2022-12-25 18:04:13.862561 (Thread-323): 18:04:13  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb10123c10>]}
2022-12-25 18:04:13.862989 (Thread-323): 18:04:13  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 431 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 18:04:13.863280 (Thread-323): 18:04:13  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec14134be0>]}
2022-12-25 18:04:13.868145 (Thread-323): sending response (<Response 11843 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:04:16.466343 (Thread-324): handling status request
2022-12-25 18:04:16.466766 (Thread-324): 18:04:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed5e5760>]}
2022-12-25 18:04:16.467247 (Thread-324): sending response (<Response 1273 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:04:16.647882 (Thread-325): handling run_sql request
2022-12-25 18:04:16.648262 (Thread-325): 18:04:16  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed5e5b80>]}
2022-12-25 18:04:19.273032 (Thread-325): sending response (<Response 140 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:04:19.304528 (MainThread): 18:04:19  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '60eeb207-9935-466f-9c62-2563617fce59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67d4330220>]}
2022-12-25 18:04:19.305058 (MainThread): 18:04:19  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 431 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 18:04:19.305648 (Thread-1): 18:04:19  Acquiring new bigquery connection "rpc.spotify.request"
2022-12-25 18:04:19.305787 (Thread-1): 18:04:19  Began compiling node rpc.spotify.request
2022-12-25 18:04:19.305886 (Thread-1): 18:04:19  Compiling rpc.spotify.request
2022-12-25 18:04:19.308520 (Thread-1): 18:04:19  finished collecting timing info
2022-12-25 18:04:19.308655 (Thread-1): 18:04:19  Began executing node rpc.spotify.request
2022-12-25 18:04:19.308762 (Thread-1): 18:04:19  Opening a new connection, currently in state init
2022-12-25 18:04:19.313274 (Thread-1): 18:04:19  On rpc.spotify.request: -- songplays table
with source as (
    select
        *
    from `dbt-demo-data-372717`.`dbt_ddemo`.`stg_songplays`
),
fact_songplays as (
    select
        songplays_id,
        track_id,
        track_played_at,
        album_id,
        artist_id,
        artist_id_others,
        artist_name_others
    from source
)
select
    *
from fact_songplays
limit 500
/* limit added automatically by dbt cloud */
2022-12-25 18:04:19.466729 (Thread-326): handling poll request
2022-12-25 18:04:19.467206 (Thread-326): 18:04:19  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed563f70>]}
2022-12-25 18:04:19.468100 (Thread-326): sending response (<Response 3846 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:04:20.654710 (Thread-327): handling poll request
2022-12-25 18:04:20.655117 (Thread-327): 18:04:20  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed563640>]}
2022-12-25 18:04:20.655611 (Thread-327): sending response (<Response 391 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:04:20.836730 (Thread-1): 18:04:20  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:53f3ee89-cb12-4cb7-8045-3c37c0411e78:US&page=queryresults
2022-12-25 18:04:20.837030 (Thread-1): 18:04:20  finished collecting timing info
2022-12-25 18:04:21.866011 (Thread-328): handling poll request
2022-12-25 18:04:21.866449 (Thread-328): 18:04:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed560f40>]}
2022-12-25 18:04:21.867610 (Thread-328): sending response (<Response 11242 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:08:08.226987 (Thread-329): handling status request
2022-12-25 18:08:08.228675 (Thread-329): 18:08:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed58da00>]}
2022-12-25 18:08:08.229180 (Thread-329): sending response (<Response 1273 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:08:08.412696 (Thread-330): handling run_sql request
2022-12-25 18:08:08.413102 (Thread-330): 18:08:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed560370>]}
2022-12-25 18:08:11.039596 (Thread-330): sending response (<Response 140 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:08:11.072898 (MainThread): 18:08:11  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78579019-1b8a-42fa-a531-547d6f77af46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f022018a3a0>]}
2022-12-25 18:08:11.073426 (MainThread): 18:08:11  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 431 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 18:08:11.074019 (Thread-1): 18:08:11  Acquiring new bigquery connection "rpc.spotify.request"
2022-12-25 18:08:11.074158 (Thread-1): 18:08:11  Began compiling node rpc.spotify.request
2022-12-25 18:08:11.074249 (Thread-1): 18:08:11  Compiling rpc.spotify.request
2022-12-25 18:08:11.077571 (Thread-1): 18:08:11  finished collecting timing info
2022-12-25 18:08:11.077744 (Thread-1): 18:08:11  Began executing node rpc.spotify.request
2022-12-25 18:08:11.077854 (Thread-1): 18:08:11  Opening a new connection, currently in state init
2022-12-25 18:08:11.082376 (Thread-1): 18:08:11  On rpc.spotify.request: -- songplays_genres table
with artist_genres as (
    select
        a.artist_genre
    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f
    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)
    union all
    select
        unnest(split(a.artist_genre_others, ', ')) as artist_genre
    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f
    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)
)
select
    *,
    count(*) as count
from artist_genres
where artist_genre is not null
group by artist_genre       
order by count desc
limit 500
/* limit added automatically by dbt cloud */
2022-12-25 18:08:11.224891 (Thread-331): handling poll request
2022-12-25 18:08:11.225360 (Thread-331): 18:08:11  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed4dc2b0>]}
2022-12-25 18:08:11.226582 (Thread-331): sending response (<Response 4095 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:08:11.297892 (Thread-1): 18:08:11  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword UNNEST at [9:9]')
2022-12-25 18:08:11.448315 (Thread-1): 18:08:11  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:US:bbbba51c-bb5c-4a19-9e74-186071b28ae9&page=queryresults
2022-12-25 18:08:11.448509 (Thread-1): 18:08:11  finished collecting timing info
2022-12-25 18:08:11.448632 (Thread-1): Got an exception: Database Error
  Syntax error: Unexpected keyword UNNEST at [9:9]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 207, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 646, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 429, in fn
    return self._query_and_results(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 631, in _query_and_results
    iterator = query_job.result(timeout=job_execution_timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1303, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 679, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Syntax error: Unexpected keyword UNNEST at [9:9]

(job ID: bbbba51c-bb5c-4a19-9e74-186071b28ae9)

                            -----Query Job SQL Follows-----                            

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:-- songplays_genres table
   2:with artist_genres as (
   3:    select
   4:        a.artist_genre
   5:    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f
   6:    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)
   7:    union all
   8:    select
   9:        unnest(split(a.artist_genre_others, ', ')) as artist_genre
  10:    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f
  11:    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)
  12:)
  13:select
  14:    *,
  15:    count(*) as count
  16:from artist_genres
  17:where artist_genre is not null
  18:group by artist_genre       
  19:order by count desc
  20:limit 500
  21:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 385, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 338, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 429, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 108, in execute
    _, execute_result = self.adapter.execute(compiled_sql, fetch=True)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 278, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 446, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 437, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 646, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 211, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 199, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  Syntax error: Unexpected keyword UNNEST at [9:9]
2022-12-25 18:08:11.450596 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system.sql)\n  Syntax error: Unexpected keyword UNNEST at [9:9]', 'raw_code': "-- songplays_genres table\r\nwith artist_genres as (\r\n    select\r\n        a.artist_genre\r\n    from {{ ref('fct_songplays') }} f\r\n    left join {{ ref('dim_artists') }} a using (artist_id)\r\n    union all\r\n    select\r\n        unnest(split(a.artist_genre_others, ', ')) as artist_genre\r\n    from {{ ref('fct_songplays') }} f\r\n    left join {{ ref('dim_artists') }} a using (artist_id)\r\n)\r\nselect\r\n    *,\r\n    count(*) as count\r\nfrom artist_genres\r\nwhere artist_genre is not null\r\ngroup by artist_genre       \r\norder by count desc\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_code': "-- songplays_genres table\nwith artist_genres as (\n    select\n        a.artist_genre\n    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f\n    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)\n    union all\n    select\n        unnest(split(a.artist_genre_others, ', ')) as artist_genre\n    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f\n    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)\n)\nselect\n    *,\n    count(*) as count\nfrom artist_genres\nwhere artist_genre is not null\ngroup by artist_genre       \norder by count desc\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 148, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 68, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system.sql)\n  Syntax error: Unexpected keyword UNNEST at [9:9]', 'raw_code': "-- songplays_genres table\r\nwith artist_genres as (\r\n    select\r\n        a.artist_genre\r\n    from {{ ref('fct_songplays') }} f\r\n    left join {{ ref('dim_artists') }} a using (artist_id)\r\n    union all\r\n    select\r\n        unnest(split(a.artist_genre_others, ', ')) as artist_genre\r\n    from {{ ref('fct_songplays') }} f\r\n    left join {{ ref('dim_artists') }} a using (artist_id)\r\n)\r\nselect\r\n    *,\r\n    count(*) as count\r\nfrom artist_genres\r\nwhere artist_genre is not null\r\ngroup by artist_genre       \r\norder by count desc\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_code': "-- songplays_genres table\nwith artist_genres as (\n    select\n        a.artist_genre\n    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f\n    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)\n    union all\n    select\n        unnest(split(a.artist_genre_others, ', ')) as artist_genre\n    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f\n    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)\n)\nselect\n    *,\n    count(*) as count\nfrom artist_genres\nwhere artist_genre is not null\ngroup by artist_genre       \norder by count desc\nlimit 500\n/* limit added automatically by dbt cloud */", 'tags': None}, None)
2022-12-25 18:08:12.435673 (Thread-332): handling poll request
2022-12-25 18:08:12.436086 (Thread-332): 18:08:12  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed563ac0>]}
2022-12-25 18:08:12.436727 (Thread-332): sending response (<Response 15162 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:08:55.942127 (Thread-333): handling status request
2022-12-25 18:08:55.942548 (Thread-333): 18:08:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed4dc2e0>]}
2022-12-25 18:08:55.943072 (Thread-333): sending response (<Response 1273 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:08:56.147065 (Thread-334): handling run_sql request
2022-12-25 18:08:56.147412 (Thread-334): 18:08:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed4dc460>]}
2022-12-25 18:08:58.729874 (Thread-334): sending response (<Response 140 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:08:58.761983 (MainThread): 18:08:58  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f110910-2781-42b7-bd26-5305be472c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f905824b370>]}
2022-12-25 18:08:58.762507 (MainThread): 18:08:58  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 431 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 18:08:58.763081 (Thread-1): 18:08:58  Acquiring new bigquery connection "rpc.spotify.request"
2022-12-25 18:08:58.763234 (Thread-1): 18:08:58  Began compiling node rpc.spotify.request
2022-12-25 18:08:58.763328 (Thread-1): 18:08:58  Compiling rpc.spotify.request
2022-12-25 18:08:58.766669 (Thread-1): 18:08:58  finished collecting timing info
2022-12-25 18:08:58.766808 (Thread-1): 18:08:58  Began executing node rpc.spotify.request
2022-12-25 18:08:58.766916 (Thread-1): 18:08:58  Opening a new connection, currently in state init
2022-12-25 18:08:58.771449 (Thread-1): 18:08:58  On rpc.spotify.request: -- songplays_genres table
with artist_genres as (
    select
        a.artist_genre
    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f
    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)
    union all
    select
        unnest(split(a.artist_genre_others)) as artist_genre
    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f
    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)
)
select
    *,
    count(*) as count
from artist_genres
where artist_genre is not null
group by artist_genre       
order by count desc
limit 500
/* limit added automatically by dbt cloud */
2022-12-25 18:08:58.942949 (Thread-335): handling poll request
2022-12-25 18:08:58.943414 (Thread-335): 18:08:58  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed4d8460>]}
2022-12-25 18:08:58.944292 (Thread-335): sending response (<Response 4091 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:08:58.976405 (Thread-1): 18:08:58  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword UNNEST at [9:9]')
2022-12-25 18:08:59.475785 (Thread-1): 18:08:59  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:US:33deb7aa-9bae-48d0-a067-a3cb989e1ded&page=queryresults
2022-12-25 18:08:59.475985 (Thread-1): 18:08:59  finished collecting timing info
2022-12-25 18:08:59.476108 (Thread-1): Got an exception: Database Error
  Syntax error: Unexpected keyword UNNEST at [9:9]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 207, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 646, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 429, in fn
    return self._query_and_results(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 631, in _query_and_results
    iterator = query_job.result(timeout=job_execution_timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1303, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 679, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Syntax error: Unexpected keyword UNNEST at [9:9]

(job ID: 33deb7aa-9bae-48d0-a067-a3cb989e1ded)

                            -----Query Job SQL Follows-----                            

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:-- songplays_genres table
   2:with artist_genres as (
   3:    select
   4:        a.artist_genre
   5:    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f
   6:    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)
   7:    union all
   8:    select
   9:        unnest(split(a.artist_genre_others)) as artist_genre
  10:    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f
  11:    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)
  12:)
  13:select
  14:    *,
  15:    count(*) as count
  16:from artist_genres
  17:where artist_genre is not null
  18:group by artist_genre       
  19:order by count desc
  20:limit 500
  21:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 385, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 338, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 429, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 108, in execute
    _, execute_result = self.adapter.execute(compiled_sql, fetch=True)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 278, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 446, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 437, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 646, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 211, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 199, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  Syntax error: Unexpected keyword UNNEST at [9:9]
2022-12-25 18:08:59.478058 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system.sql)\n  Syntax error: Unexpected keyword UNNEST at [9:9]', 'raw_code': "-- songplays_genres table\r\nwith artist_genres as (\r\n    select\r\n        a.artist_genre\r\n    from {{ ref('fct_songplays') }} f\r\n    left join {{ ref('dim_artists') }} a using (artist_id)\r\n    union all\r\n    select\r\n        unnest(split(a.artist_genre_others)) as artist_genre\r\n    from {{ ref('fct_songplays') }} f\r\n    left join {{ ref('dim_artists') }} a using (artist_id)\r\n)\r\nselect\r\n    *,\r\n    count(*) as count\r\nfrom artist_genres\r\nwhere artist_genre is not null\r\ngroup by artist_genre       \r\norder by count desc\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_code': '-- songplays_genres table\nwith artist_genres as (\n    select\n        a.artist_genre\n    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f\n    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)\n    union all\n    select\n        unnest(split(a.artist_genre_others)) as artist_genre\n    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f\n    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)\n)\nselect\n    *,\n    count(*) as count\nfrom artist_genres\nwhere artist_genre is not null\ngroup by artist_genre       \norder by count desc\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 148, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 68, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system.sql)\n  Syntax error: Unexpected keyword UNNEST at [9:9]', 'raw_code': "-- songplays_genres table\r\nwith artist_genres as (\r\n    select\r\n        a.artist_genre\r\n    from {{ ref('fct_songplays') }} f\r\n    left join {{ ref('dim_artists') }} a using (artist_id)\r\n    union all\r\n    select\r\n        unnest(split(a.artist_genre_others)) as artist_genre\r\n    from {{ ref('fct_songplays') }} f\r\n    left join {{ ref('dim_artists') }} a using (artist_id)\r\n)\r\nselect\r\n    *,\r\n    count(*) as count\r\nfrom artist_genres\r\nwhere artist_genre is not null\r\ngroup by artist_genre       \r\norder by count desc\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_code': '-- songplays_genres table\nwith artist_genres as (\n    select\n        a.artist_genre\n    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f\n    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)\n    union all\n    select\n        unnest(split(a.artist_genre_others)) as artist_genre\n    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f\n    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)\n)\nselect\n    *,\n    count(*) as count\nfrom artist_genres\nwhere artist_genre is not null\ngroup by artist_genre       \norder by count desc\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2022-12-25 18:09:00.185416 (Thread-336): handling poll request
2022-12-25 18:09:00.185870 (Thread-336): 18:09:00  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed4d8730>]}
2022-12-25 18:09:00.186486 (Thread-336): sending response (<Response 15110 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:09:56.842877 (Thread-337): handling status request
2022-12-25 18:09:56.843303 (Thread-337): 18:09:56  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed4d8b20>]}
2022-12-25 18:09:56.843822 (Thread-337): sending response (<Response 1273 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:09:57.105323 (Thread-338): handling run_sql request
2022-12-25 18:09:57.105754 (Thread-338): 18:09:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed4d8ca0>]}
2022-12-25 18:09:59.765722 (Thread-338): sending response (<Response 140 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:09:59.799481 (MainThread): 18:09:59  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b09f7ad-49f2-4907-b8c4-70293e0f8dc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87e8327eb0>]}
2022-12-25 18:09:59.800014 (MainThread): 18:09:59  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 431 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 18:09:59.800597 (Thread-1): 18:09:59  Acquiring new bigquery connection "rpc.spotify.request"
2022-12-25 18:09:59.800744 (Thread-1): 18:09:59  Began compiling node rpc.spotify.request
2022-12-25 18:09:59.800837 (Thread-1): 18:09:59  Compiling rpc.spotify.request
2022-12-25 18:09:59.804319 (Thread-1): 18:09:59  finished collecting timing info
2022-12-25 18:09:59.804460 (Thread-1): 18:09:59  Began executing node rpc.spotify.request
2022-12-25 18:09:59.804573 (Thread-1): 18:09:59  Opening a new connection, currently in state init
2022-12-25 18:09:59.809145 (Thread-1): 18:09:59  On rpc.spotify.request: -- songplays_genres table
with artist_genres as (
    select
        a.artist_genre
    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f
    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)
    union all
    select
        UNNEST(split(a.artist_genre_others)) as artist_genre
    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f
    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)
)
select
    *,
    count(*) as count
from artist_genres
where artist_genre is not null
group by artist_genre       
order by count desc
limit 500
/* limit added automatically by dbt cloud */
2022-12-25 18:09:59.954023 (Thread-339): handling poll request
2022-12-25 18:09:59.954474 (Thread-339): 18:09:59  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed4c60a0>]}
2022-12-25 18:09:59.955314 (Thread-339): sending response (<Response 4090 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:09:59.987647 (Thread-1): 18:09:59  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Unexpected keyword UNNEST at [9:9]')
2022-12-25 18:10:00.514378 (Thread-1): 18:10:00  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:US:91a54026-98ed-47af-9a51-350ea4b02ad1&page=queryresults
2022-12-25 18:10:00.514587 (Thread-1): 18:10:00  finished collecting timing info
2022-12-25 18:10:00.514713 (Thread-1): Got an exception: Database Error
  Syntax error: Unexpected keyword UNNEST at [9:9]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 207, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 646, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 429, in fn
    return self._query_and_results(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 631, in _query_and_results
    iterator = query_job.result(timeout=job_execution_timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1303, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 679, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Syntax error: Unexpected keyword UNNEST at [9:9]

(job ID: 91a54026-98ed-47af-9a51-350ea4b02ad1)

                            -----Query Job SQL Follows-----                            

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:-- songplays_genres table
   2:with artist_genres as (
   3:    select
   4:        a.artist_genre
   5:    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f
   6:    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)
   7:    union all
   8:    select
   9:        UNNEST(split(a.artist_genre_others)) as artist_genre
  10:    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f
  11:    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)
  12:)
  13:select
  14:    *,
  15:    count(*) as count
  16:from artist_genres
  17:where artist_genre is not null
  18:group by artist_genre       
  19:order by count desc
  20:limit 500
  21:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 385, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 338, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 429, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 108, in execute
    _, execute_result = self.adapter.execute(compiled_sql, fetch=True)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 278, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 446, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 437, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 646, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 211, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 199, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  Syntax error: Unexpected keyword UNNEST at [9:9]
2022-12-25 18:10:00.516774 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system.sql)\n  Syntax error: Unexpected keyword UNNEST at [9:9]', 'raw_code': "-- songplays_genres table\r\nwith artist_genres as (\r\n    select\r\n        a.artist_genre\r\n    from {{ ref('fct_songplays') }} f\r\n    left join {{ ref('dim_artists') }} a using (artist_id)\r\n    union all\r\n    select\r\n        UNNEST(split(a.artist_genre_others)) as artist_genre\r\n    from {{ ref('fct_songplays') }} f\r\n    left join {{ ref('dim_artists') }} a using (artist_id)\r\n)\r\nselect\r\n    *,\r\n    count(*) as count\r\nfrom artist_genres\r\nwhere artist_genre is not null\r\ngroup by artist_genre       \r\norder by count desc\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_code': '-- songplays_genres table\nwith artist_genres as (\n    select\n        a.artist_genre\n    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f\n    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)\n    union all\n    select\n        UNNEST(split(a.artist_genre_others)) as artist_genre\n    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f\n    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)\n)\nselect\n    *,\n    count(*) as count\nfrom artist_genres\nwhere artist_genre is not null\ngroup by artist_genre       \norder by count desc\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 148, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 68, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system.sql)\n  Syntax error: Unexpected keyword UNNEST at [9:9]', 'raw_code': "-- songplays_genres table\r\nwith artist_genres as (\r\n    select\r\n        a.artist_genre\r\n    from {{ ref('fct_songplays') }} f\r\n    left join {{ ref('dim_artists') }} a using (artist_id)\r\n    union all\r\n    select\r\n        UNNEST(split(a.artist_genre_others)) as artist_genre\r\n    from {{ ref('fct_songplays') }} f\r\n    left join {{ ref('dim_artists') }} a using (artist_id)\r\n)\r\nselect\r\n    *,\r\n    count(*) as count\r\nfrom artist_genres\r\nwhere artist_genre is not null\r\ngroup by artist_genre       \r\norder by count desc\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_code': '-- songplays_genres table\nwith artist_genres as (\n    select\n        a.artist_genre\n    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f\n    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)\n    union all\n    select\n        UNNEST(split(a.artist_genre_others)) as artist_genre\n    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f\n    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)\n)\nselect\n    *,\n    count(*) as count\nfrom artist_genres\nwhere artist_genre is not null\ngroup by artist_genre       \norder by count desc\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2022-12-25 18:10:01.153287 (Thread-340): handling poll request
2022-12-25 18:10:01.153723 (Thread-340): 18:10:01  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed4c6370>]}
2022-12-25 18:10:01.154358 (Thread-340): sending response (<Response 15110 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:57:34.817306 (Thread-341): handling status request
2022-12-25 18:57:34.817772 (Thread-341): 18:57:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed4c6a60>]}
2022-12-25 18:57:34.818347 (Thread-341): sending response (<Response 1273 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:57:34.827680 (Thread-342): handling ps request
2022-12-25 18:57:34.827981 (Thread-342): 18:57:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed4c67c0>]}
2022-12-25 18:57:34.829923 (Thread-342): sending response (<Response 18907 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:57:34.973857 (Thread-343): handling status request
2022-12-25 18:57:34.974275 (Thread-343): 18:57:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed4c6cd0>]}
2022-12-25 18:57:34.974748 (Thread-343): sending response (<Response 1273 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:57:34.981120 (Thread-344): handling status request
2022-12-25 18:57:34.981391 (Thread-344): 18:57:34  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed4c6e80>]}
2022-12-25 18:57:34.981783 (Thread-344): sending response (<Response 1273 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:57:35.337070 (Thread-345): handling poll request
2022-12-25 18:57:35.337488 (Thread-345): 18:57:35  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed4c6d30>]}
2022-12-25 18:57:35.343885 (Thread-345): sending response (<Response 216731 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:57:36.661441 (Thread-346): handling status request
2022-12-25 18:57:36.661887 (Thread-346): 18:57:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed4cb340>]}
2022-12-25 18:57:36.662343 (Thread-346): sending response (<Response 1249 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:57:36.668231 (Thread-347): handling list request
2022-12-25 18:57:36.668487 (Thread-347): 18:57:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed4d8370>]}
2022-12-25 18:57:36.707847 (Thread-347): 18:57:36  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed4c69a0>]}
2022-12-25 18:57:36.708325 (Thread-347): 18:57:36  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 431 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 18:57:36.708630 (Thread-347): 18:57:36  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb101233a0>]}
2022-12-25 18:57:36.712750 (Thread-347): sending response (<Response 11843 bytes [200 OK]>) to 10.0.192.137
2022-12-25 18:57:36.782049 (Thread-348): handling status request
2022-12-25 18:57:36.782361 (Thread-348): 18:57:36  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed4c6b20>]}
2022-12-25 18:57:36.782761 (Thread-348): sending response (<Response 1273 bytes [200 OK]>) to 10.0.192.137
2022-12-25 19:50:25.790635 (Thread-349): handling status request
2022-12-25 19:50:25.792344 (Thread-349): 19:50:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed4f83a0>]}
2022-12-25 19:50:25.792823 (Thread-349): sending response (<Response 1249 bytes [200 OK]>) to 10.0.192.137
2022-12-25 19:50:25.797167 (Thread-350): handling list request
2022-12-25 19:50:25.797424 (Thread-350): 19:50:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed4f8520>]}
2022-12-25 19:50:25.831834 (Thread-350): 19:50:25  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed4f8f40>]}
2022-12-25 19:50:25.832312 (Thread-350): 19:50:25  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 431 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 19:50:25.832576 (Thread-350): 19:50:25  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed5e37c0>]}
2022-12-25 19:50:25.841240 (Thread-350): sending response (<Response 13538 bytes [200 OK]>) to 10.0.192.137
2022-12-25 19:50:27.370397 (Thread-351): handling status request
2022-12-25 19:50:27.370812 (Thread-351): 19:50:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed4f8460>]}
2022-12-25 19:50:27.371276 (Thread-351): sending response (<Response 1249 bytes [200 OK]>) to 10.0.192.137
2022-12-25 19:50:27.375603 (Thread-352): handling list request
2022-12-25 19:50:27.375864 (Thread-352): 19:50:27  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed4f81f0>]}
2022-12-25 19:50:27.409566 (Thread-352): 19:50:27  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed4c6fa0>]}
2022-12-25 19:50:27.410104 (Thread-352): 19:50:27  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 431 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 19:50:27.410385 (Thread-352): 19:50:27  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed4c6fd0>]}
2022-12-25 19:50:27.416332 (Thread-352): sending response (<Response 20258 bytes [200 OK]>) to 10.0.192.137
2022-12-25 19:50:28.157329 (Thread-353): handling status request
2022-12-25 19:50:28.157777 (Thread-353): 19:50:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaec49c460>]}
2022-12-25 19:50:28.158253 (Thread-353): sending response (<Response 1249 bytes [200 OK]>) to 10.0.192.137
2022-12-25 19:50:28.162500 (Thread-354): handling list request
2022-12-25 19:50:28.162759 (Thread-354): 19:50:28  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaec49c700>]}
2022-12-25 19:50:28.197529 (Thread-354): 19:50:28  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaec49ccd0>]}
2022-12-25 19:50:28.198027 (Thread-354): 19:50:28  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 431 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 19:50:28.198305 (Thread-354): 19:50:28  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaec49c5b0>]}
2022-12-25 19:50:28.203563 (Thread-354): sending response (<Response 13538 bytes [200 OK]>) to 10.0.192.137
2022-12-25 19:50:29.839949 (Thread-355): handling status request
2022-12-25 19:50:29.840369 (Thread-355): 19:50:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaec3ca160>]}
2022-12-25 19:50:29.840842 (Thread-355): sending response (<Response 1249 bytes [200 OK]>) to 10.0.192.137
2022-12-25 19:50:29.844936 (Thread-356): handling list request
2022-12-25 19:50:29.845198 (Thread-356): 19:50:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaec3ca7f0>]}
2022-12-25 19:50:29.877478 (Thread-356): 19:50:29  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaec3cae20>]}
2022-12-25 19:50:29.878015 (Thread-356): 19:50:29  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 431 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 19:50:29.878285 (Thread-356): 19:50:29  Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaec3ca280>]}
2022-12-25 19:50:29.885139 (Thread-356): sending response (<Response 20918 bytes [200 OK]>) to 10.0.192.137
2022-12-25 20:04:52.815730 (Thread-357): handling status request
2022-12-25 20:04:52.817300 (Thread-357): 20:04:52  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaec3ec7f0>]}
2022-12-25 20:04:52.817809 (Thread-357): sending response (<Response 1273 bytes [200 OK]>) to 10.0.192.137
2022-12-25 20:04:53.010049 (Thread-358): handling run_sql request
2022-12-25 20:04:53.010425 (Thread-358): 20:04:53  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaec3ec820>]}
2022-12-25 20:04:55.620783 (Thread-358): sending response (<Response 140 bytes [200 OK]>) to 10.0.192.137
2022-12-25 20:04:55.654993 (MainThread): 20:04:55  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '742def94-f37c-4cad-b7c2-9052e0f6a816', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa32c758fd0>]}
2022-12-25 20:04:55.655487 (MainThread): 20:04:55  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 431 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 20:04:55.656054 (Thread-1): 20:04:55  Acquiring new bigquery connection "rpc.spotify.request"
2022-12-25 20:04:55.656198 (Thread-1): 20:04:55  Began compiling node rpc.spotify.request
2022-12-25 20:04:55.656302 (Thread-1): 20:04:55  Compiling rpc.spotify.request
2022-12-25 20:04:55.659757 (Thread-1): 20:04:55  finished collecting timing info
2022-12-25 20:04:55.659898 (Thread-1): 20:04:55  Began executing node rpc.spotify.request
2022-12-25 20:04:55.660008 (Thread-1): 20:04:55  Opening a new connection, currently in state init
2022-12-25 20:04:55.664585 (Thread-1): 20:04:55  On rpc.spotify.request: -- songplays_genres table
with other_genres as (
    select split(a.artist_genre_others) as nested_genres
    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f
    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)
)

with artist_genres as (
    select
        a.artist_genre
    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f
    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)
    union all
    select
        unnested
    from other_genres, unnest(nested_genres) as unnested
)
select
    *,
    count(*) as count
from artist_genres
where artist_genre is not null
group by artist_genre       
order by count desc
limit 500
/* limit added automatically by dbt cloud */
2022-12-25 20:04:55.872162 (Thread-1): 20:04:55  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [8:1]')
2022-12-25 20:04:55.907844 (Thread-359): handling poll request
2022-12-25 20:04:55.908268 (Thread-359): 20:04:55  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaec450070>]}
2022-12-25 20:04:55.909124 (Thread-359): sending response (<Response 4595 bytes [200 OK]>) to 10.0.192.137
2022-12-25 20:04:56.034215 (Thread-1): 20:04:56  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:US:72e91bf2-101c-466d-a094-d0ad4b683ff1&page=queryresults
2022-12-25 20:04:56.034423 (Thread-1): 20:04:56  finished collecting timing info
2022-12-25 20:04:56.034547 (Thread-1): Got an exception: Database Error
  Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [8:1]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 207, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 646, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 429, in fn
    return self._query_and_results(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 631, in _query_and_results
    iterator = query_job.result(timeout=job_execution_timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1303, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 679, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [8:1]

(job ID: 72e91bf2-101c-466d-a094-d0ad4b683ff1)

                            -----Query Job SQL Follows-----                            

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:-- songplays_genres table
   2:with other_genres as (
   3:    select split(a.artist_genre_others) as nested_genres
   4:    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f
   5:    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)
   6:)
   7:
   8:with artist_genres as (
   9:    select
  10:        a.artist_genre
  11:    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f
  12:    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)
  13:    union all
  14:    select
  15:        unnested
  16:    from other_genres, unnest(nested_genres) as unnested
  17:)
  18:select
  19:    *,
  20:    count(*) as count
  21:from artist_genres
  22:where artist_genre is not null
  23:group by artist_genre       
  24:order by count desc
  25:limit 500
  26:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 385, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 338, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 429, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 108, in execute
    _, execute_result = self.adapter.execute(compiled_sql, fetch=True)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 278, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 446, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 437, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 646, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 211, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 199, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [8:1]
2022-12-25 20:04:56.036431 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system.sql)\n  Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [8:1]', 'raw_code': "-- songplays_genres table\r\nwith other_genres as (\r\n    select split(a.artist_genre_others) as nested_genres\r\n    from {{ ref('fct_songplays') }} f\r\n    left join {{ ref('dim_artists') }} a using (artist_id)\r\n)\r\n\r\nwith artist_genres as (\r\n    select\r\n        a.artist_genre\r\n    from {{ ref('fct_songplays') }} f\r\n    left join {{ ref('dim_artists') }} a using (artist_id)\r\n    union all\r\n    select\r\n        unnested\r\n    from other_genres, unnest(nested_genres) as unnested\r\n)\r\nselect\r\n    *,\r\n    count(*) as count\r\nfrom artist_genres\r\nwhere artist_genre is not null\r\ngroup by artist_genre       \r\norder by count desc\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_code': '-- songplays_genres table\nwith other_genres as (\n    select split(a.artist_genre_others) as nested_genres\n    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f\n    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)\n)\n\nwith artist_genres as (\n    select\n        a.artist_genre\n    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f\n    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)\n    union all\n    select\n        unnested\n    from other_genres, unnest(nested_genres) as unnested\n)\nselect\n    *,\n    count(*) as count\nfrom artist_genres\nwhere artist_genre is not null\ngroup by artist_genre       \norder by count desc\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 148, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 68, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system.sql)\n  Syntax error: Expected "(" or "," or keyword SELECT but got keyword WITH at [8:1]', 'raw_code': "-- songplays_genres table\r\nwith other_genres as (\r\n    select split(a.artist_genre_others) as nested_genres\r\n    from {{ ref('fct_songplays') }} f\r\n    left join {{ ref('dim_artists') }} a using (artist_id)\r\n)\r\n\r\nwith artist_genres as (\r\n    select\r\n        a.artist_genre\r\n    from {{ ref('fct_songplays') }} f\r\n    left join {{ ref('dim_artists') }} a using (artist_id)\r\n    union all\r\n    select\r\n        unnested\r\n    from other_genres, unnest(nested_genres) as unnested\r\n)\r\nselect\r\n    *,\r\n    count(*) as count\r\nfrom artist_genres\r\nwhere artist_genre is not null\r\ngroup by artist_genre       \r\norder by count desc\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_code': '-- songplays_genres table\nwith other_genres as (\n    select split(a.artist_genre_others) as nested_genres\n    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f\n    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)\n)\n\nwith artist_genres as (\n    select\n        a.artist_genre\n    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f\n    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)\n    union all\n    select\n        unnested\n    from other_genres, unnest(nested_genres) as unnested\n)\nselect\n    *,\n    count(*) as count\nfrom artist_genres\nwhere artist_genre is not null\ngroup by artist_genre       \norder by count desc\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2022-12-25 20:04:57.097853 (Thread-360): handling poll request
2022-12-25 20:04:57.098257 (Thread-360): 20:04:57  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaec4501c0>]}
2022-12-25 20:04:57.098895 (Thread-360): sending response (<Response 16262 bytes [200 OK]>) to 10.0.192.137
2022-12-25 20:05:05.351780 (Thread-361): handling status request
2022-12-25 20:05:05.352217 (Thread-361): 20:05:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaec4506a0>]}
2022-12-25 20:05:05.352749 (Thread-361): sending response (<Response 1273 bytes [200 OK]>) to 10.0.192.137
2022-12-25 20:05:05.670402 (Thread-362): handling run_sql request
2022-12-25 20:05:05.670817 (Thread-362): 20:05:05  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaec450820>]}
2022-12-25 20:05:08.242170 (Thread-362): sending response (<Response 140 bytes [200 OK]>) to 10.0.192.137
2022-12-25 20:05:08.274325 (MainThread): 20:05:08  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e512ae5-6988-4075-9f12-46fb968012c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fafb4698f70>]}
2022-12-25 20:05:08.274848 (MainThread): 20:05:08  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 431 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 20:05:08.275408 (Thread-1): 20:05:08  Acquiring new bigquery connection "rpc.spotify.request"
2022-12-25 20:05:08.275548 (Thread-1): 20:05:08  Began compiling node rpc.spotify.request
2022-12-25 20:05:08.275649 (Thread-1): 20:05:08  Compiling rpc.spotify.request
2022-12-25 20:05:08.278998 (Thread-1): 20:05:08  finished collecting timing info
2022-12-25 20:05:08.279138 (Thread-1): 20:05:08  Began executing node rpc.spotify.request
2022-12-25 20:05:08.279247 (Thread-1): 20:05:08  Opening a new connection, currently in state init
2022-12-25 20:05:08.283843 (Thread-1): 20:05:08  On rpc.spotify.request: -- songplays_genres table
with other_genres as (
    select split(a.artist_genre_others) as nested_genres
    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f
    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)
),

with artist_genres as (
    select
        a.artist_genre
    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f
    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)
    union all
    select
        unnested
    from other_genres, unnest(nested_genres) as unnested
)
select
    *,
    count(*) as count
from artist_genres
where artist_genre is not null
group by artist_genre       
order by count desc
limit 500
/* limit added automatically by dbt cloud */
2022-12-25 20:05:08.453247 (Thread-363): handling poll request
2022-12-25 20:05:08.453748 (Thread-363): 20:05:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaec458c70>]}
2022-12-25 20:05:08.454629 (Thread-363): sending response (<Response 4193 bytes [200 OK]>) to 10.0.192.137
2022-12-25 20:05:08.457370 (Thread-1): 20:05:08  BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected keyword SELECT but got keyword WITH at [8:1]')
2022-12-25 20:05:09.236095 (Thread-1): 20:05:09  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:US:ac22ae43-f990-45d4-845b-3f9db761b86d&page=queryresults
2022-12-25 20:05:09.236317 (Thread-1): 20:05:09  finished collecting timing info
2022-12-25 20:05:09.236450 (Thread-1): Got an exception: Database Error
  Syntax error: Expected keyword SELECT but got keyword WITH at [8:1]
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 207, in exception_handler
    yield
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 646, in _retry_and_handle
    return retry.retry_target(
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/retry.py", line 191, in retry_target
    return target()
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 429, in fn
    return self._query_and_results(
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 631, in _query_and_results
    iterator = query_job.result(timeout=job_execution_timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/query.py", line 1303, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "/usr/local/lib/python3.8/dist-packages/google/cloud/bigquery/job/base.py", line 679, in result
    return super(_AsyncJob, self).result(timeout=timeout, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/google/api_core/future/polling.py", line 261, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Syntax error: Expected keyword SELECT but got keyword WITH at [8:1]

(job ID: ac22ae43-f990-45d4-845b-3f9db761b86d)

                            -----Query Job SQL Follows-----                            

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:-- songplays_genres table
   2:with other_genres as (
   3:    select split(a.artist_genre_others) as nested_genres
   4:    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f
   5:    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)
   6:),
   7:
   8:with artist_genres as (
   9:    select
  10:        a.artist_genre
  11:    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f
  12:    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)
  13:    union all
  14:    select
  15:        unnested
  16:    from other_genres, unnest(nested_genres) as unnested
  17:)
  18:select
  19:    *,
  20:    count(*) as count
  21:from artist_genres
  22:where artist_genre is not null
  23:group by artist_genre       
  24:order by count desc
  25:limit 500
  26:/* limit added automatically by dbt cloud */
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 385, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 338, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 429, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 108, in execute
    _, execute_result = self.adapter.execute(compiled_sql, fetch=True)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/base/impl.py", line 278, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 446, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 437, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 646, in _retry_and_handle
    return retry.retry_target(
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 211, in exception_handler
    self.handle_error(e, message)
  File "/usr/local/lib/python3.8/dist-packages/dbt/adapters/bigquery/connections.py", line 199, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error
  Syntax error: Expected keyword SELECT but got keyword WITH at [8:1]
2022-12-25 20:05:09.238627 (Thread-1): Got exception RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system.sql)\n  Syntax error: Expected keyword SELECT but got keyword WITH at [8:1]', 'raw_code': "-- songplays_genres table\r\nwith other_genres as (\r\n    select split(a.artist_genre_others) as nested_genres\r\n    from {{ ref('fct_songplays') }} f\r\n    left join {{ ref('dim_artists') }} a using (artist_id)\r\n),\r\n\r\nwith artist_genres as (\r\n    select\r\n        a.artist_genre\r\n    from {{ ref('fct_songplays') }} f\r\n    left join {{ ref('dim_artists') }} a using (artist_id)\r\n    union all\r\n    select\r\n        unnested\r\n    from other_genres, unnest(nested_genres) as unnested\r\n)\r\nselect\r\n    *,\r\n    count(*) as count\r\nfrom artist_genres\r\nwhere artist_genre is not null\r\ngroup by artist_genre       \r\norder by count desc\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_code': '-- songplays_genres table\nwith other_genres as (\n    select split(a.artist_genre_others) as nested_genres\n    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f\n    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)\n),\n\nwith artist_genres as (\n    select\n        a.artist_genre\n    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f\n    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)\n    union all\n    select\n        unnested\n    from other_genres, unnest(nested_genres) as unnested\n)\nselect\n    *,\n    count(*) as count\nfrom artist_genres\nwhere artist_genre is not null\ngroup by artist_genre       \norder by count desc\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/task/sql_commands.py", line 148, in _in_thread
    self.node_results.append(runner.safe_run(self.manifest))
  File "/usr/local/lib/python3.8/dist-packages/dbt/task/base.py", line 403, in safe_run
    result = self.error_result(ctx.node, error, started, [])
  File "/usr/local/lib/python3.8/dist-packages/dbt_rpc/rpc/node_runners.py", line 68, in error_result
    raise error
dbt_rpc.rpc.error.RPCException: RPCException(10003, Database Error, {'type': 'DatabaseException', 'message': 'Database Error in rpc request (from remote system.sql)\n  Syntax error: Expected keyword SELECT but got keyword WITH at [8:1]', 'raw_code': "-- songplays_genres table\r\nwith other_genres as (\r\n    select split(a.artist_genre_others) as nested_genres\r\n    from {{ ref('fct_songplays') }} f\r\n    left join {{ ref('dim_artists') }} a using (artist_id)\r\n),\r\n\r\nwith artist_genres as (\r\n    select\r\n        a.artist_genre\r\n    from {{ ref('fct_songplays') }} f\r\n    left join {{ ref('dim_artists') }} a using (artist_id)\r\n    union all\r\n    select\r\n        unnested\r\n    from other_genres, unnest(nested_genres) as unnested\r\n)\r\nselect\r\n    *,\r\n    count(*) as count\r\nfrom artist_genres\r\nwhere artist_genre is not null\r\ngroup by artist_genre       \r\norder by count desc\nlimit 500\n/* limit added automatically by dbt cloud */", 'compiled_code': '-- songplays_genres table\nwith other_genres as (\n    select split(a.artist_genre_others) as nested_genres\n    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f\n    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)\n),\n\nwith artist_genres as (\n    select\n        a.artist_genre\n    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f\n    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)\n    union all\n    select\n        unnested\n    from other_genres, unnest(nested_genres) as unnested\n)\nselect\n    *,\n    count(*) as count\nfrom artist_genres\nwhere artist_genre is not null\ngroup by artist_genre       \norder by count desc\nlimit 500\n/* limit added automatically by dbt cloud */', 'tags': None}, None)
2022-12-25 20:05:09.651612 (Thread-364): handling poll request
2022-12-25 20:05:09.652020 (Thread-364): 20:05:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaec473100>]}
2022-12-25 20:05:09.652670 (Thread-364): sending response (<Response 16144 bytes [200 OK]>) to 10.0.192.137
2022-12-25 20:05:26.223967 (Thread-365): handling status request
2022-12-25 20:05:26.224382 (Thread-365): 20:05:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaec4734f0>]}
2022-12-25 20:05:26.224919 (Thread-365): sending response (<Response 1273 bytes [200 OK]>) to 10.0.192.137
2022-12-25 20:05:26.410763 (Thread-366): handling run_sql request
2022-12-25 20:05:26.411187 (Thread-366): 20:05:26  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaec473670>]}
2022-12-25 20:05:29.017354 (Thread-366): sending response (<Response 140 bytes [200 OK]>) to 10.0.192.137
2022-12-25 20:05:29.049798 (MainThread): 20:05:29  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '430e4369-4cb9-4df5-982c-c4dab65d652a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4cc0f1100>]}
2022-12-25 20:05:29.050353 (MainThread): 20:05:29  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 431 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 20:05:29.050949 (Thread-1): 20:05:29  Acquiring new bigquery connection "rpc.spotify.request"
2022-12-25 20:05:29.051087 (Thread-1): 20:05:29  Began compiling node rpc.spotify.request
2022-12-25 20:05:29.051179 (Thread-1): 20:05:29  Compiling rpc.spotify.request
2022-12-25 20:05:29.054560 (Thread-1): 20:05:29  finished collecting timing info
2022-12-25 20:05:29.054698 (Thread-1): 20:05:29  Began executing node rpc.spotify.request
2022-12-25 20:05:29.054805 (Thread-1): 20:05:29  Opening a new connection, currently in state init
2022-12-25 20:05:29.059311 (Thread-1): 20:05:29  On rpc.spotify.request: -- songplays_genres table
With other_genres as (
    select split(a.artist_genre_others) as nested_genres
    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f
    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)
),

artist_genres as (
    select
        a.artist_genre
    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_songplays` f
    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)
    union all
    select
        unnested
    from other_genres, unnest(nested_genres) as unnested
)
select
    *,
    count(*) as count
from artist_genres
where artist_genre is not null
group by artist_genre       
order by count desc
limit 500
/* limit added automatically by dbt cloud */
2022-12-25 20:05:29.264804 (Thread-367): handling poll request
2022-12-25 20:05:29.265254 (Thread-367): 20:05:29  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaec4765b0>]}
2022-12-25 20:05:29.266128 (Thread-367): sending response (<Response 4188 bytes [200 OK]>) to 10.0.192.137
2022-12-25 20:05:30.459471 (Thread-368): handling poll request
2022-12-25 20:05:30.459865 (Thread-368): 20:05:30  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaec476730>]}
2022-12-25 20:05:30.460345 (Thread-368): sending response (<Response 399 bytes [200 OK]>) to 10.0.192.137
2022-12-25 20:05:30.580378 (Thread-1): 20:05:30  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:9e572039-384e-4339-9acb-9bd85fb49777:US&page=queryresults
2022-12-25 20:05:30.580697 (Thread-1): 20:05:30  finished collecting timing info
2022-12-25 20:05:31.654994 (Thread-369): handling poll request
2022-12-25 20:05:31.655397 (Thread-369): 20:05:31  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaec403a90>]}
2022-12-25 20:05:31.656428 (Thread-369): sending response (<Response 8089 bytes [200 OK]>) to 10.0.192.137
2022-12-25 20:05:45.708120 (Thread-370): 20:05:45  Unable to do partial parsing because config vars, config profile, or config target have changed
2022-12-25 20:05:45.708542 (Thread-370): 20:05:45  Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaec40c520>]}
2022-12-25 20:05:45.896699 (Thread-370): 20:05:45  Parsing macros/etc.sql
2022-12-25 20:05:45.898919 (Thread-370): 20:05:45  Parsing macros/catalog.sql
2022-12-25 20:05:45.904389 (Thread-370): 20:05:45  Parsing macros/adapters.sql
2022-12-25 20:05:45.924110 (Thread-370): 20:05:45  Parsing macros/adapters/apply_grants.sql
2022-12-25 20:05:45.926631 (Thread-370): 20:05:45  Parsing macros/materializations/seed.sql
2022-12-25 20:05:45.929015 (Thread-370): 20:05:45  Parsing macros/materializations/incremental.sql
2022-12-25 20:05:45.945385 (Thread-370): 20:05:45  Parsing macros/materializations/snapshot.sql
2022-12-25 20:05:45.947009 (Thread-370): 20:05:45  Parsing macros/materializations/table.sql
2022-12-25 20:05:45.953664 (Thread-370): 20:05:45  Parsing macros/materializations/copy.sql
2022-12-25 20:05:45.956193 (Thread-370): 20:05:45  Parsing macros/materializations/view.sql
2022-12-25 20:05:45.958815 (Thread-370): 20:05:45  Parsing macros/utils/intersect.sql
2022-12-25 20:05:45.959239 (Thread-370): 20:05:45  Parsing macros/utils/position.sql
2022-12-25 20:05:45.959803 (Thread-370): 20:05:45  Parsing macros/utils/escape_single_quotes.sql
2022-12-25 20:05:45.960371 (Thread-370): 20:05:45  Parsing macros/utils/safe_cast.sql
2022-12-25 20:05:45.960898 (Thread-370): 20:05:45  Parsing macros/utils/array_construct.sql
2022-12-25 20:05:45.961731 (Thread-370): 20:05:45  Parsing macros/utils/datediff.sql
2022-12-25 20:05:45.962912 (Thread-370): 20:05:45  Parsing macros/utils/timestamps.sql
2022-12-25 20:05:45.963988 (Thread-370): 20:05:45  Parsing macros/utils/array_concat.sql
2022-12-25 20:05:45.964554 (Thread-370): 20:05:45  Parsing macros/utils/right.sql
2022-12-25 20:05:45.965203 (Thread-370): 20:05:45  Parsing macros/utils/array_append.sql
2022-12-25 20:05:45.965975 (Thread-370): 20:05:45  Parsing macros/utils/split_part.sql
2022-12-25 20:05:45.967244 (Thread-370): 20:05:45  Parsing macros/utils/date_trunc.sql
2022-12-25 20:05:45.967797 (Thread-370): 20:05:45  Parsing macros/utils/hash.sql
2022-12-25 20:05:45.968315 (Thread-370): 20:05:45  Parsing macros/utils/except.sql
2022-12-25 20:05:45.968707 (Thread-370): 20:05:45  Parsing macros/utils/bool_or.sql
2022-12-25 20:05:45.969170 (Thread-370): 20:05:45  Parsing macros/utils/dateadd.sql
2022-12-25 20:05:45.969845 (Thread-370): 20:05:45  Parsing macros/utils/listagg.sql
2022-12-25 20:05:45.970835 (Thread-370): 20:05:45  Parsing macros/etc/statement.sql
2022-12-25 20:05:45.975637 (Thread-370): 20:05:45  Parsing macros/etc/datetime.sql
2022-12-25 20:05:45.983585 (Thread-370): 20:05:45  Parsing macros/adapters/apply_grants.sql
2022-12-25 20:05:45.996169 (Thread-370): 20:05:45  Parsing macros/adapters/freshness.sql
2022-12-25 20:05:45.998035 (Thread-370): 20:05:45  Parsing macros/adapters/columns.sql
2022-12-25 20:05:46.006849 (Thread-370): 20:05:46  Parsing macros/adapters/timestamps.sql
2022-12-25 20:05:46.010037 (Thread-370): 20:05:46  Parsing macros/adapters/relation.sql
2022-12-25 20:05:46.023430 (Thread-370): 20:05:46  Parsing macros/adapters/schema.sql
2022-12-25 20:05:46.025531 (Thread-370): 20:05:46  Parsing macros/adapters/persist_docs.sql
2022-12-25 20:05:46.029789 (Thread-370): 20:05:46  Parsing macros/adapters/metadata.sql
2022-12-25 20:05:46.036336 (Thread-370): 20:05:46  Parsing macros/adapters/indexes.sql
2022-12-25 20:05:46.038876 (Thread-370): 20:05:46  Parsing macros/get_custom_name/get_custom_database.sql
2022-12-25 20:05:46.040363 (Thread-370): 20:05:46  Parsing macros/get_custom_name/get_custom_schema.sql
2022-12-25 20:05:46.042705 (Thread-370): 20:05:46  Parsing macros/get_custom_name/get_custom_alias.sql
2022-12-25 20:05:46.044267 (Thread-370): 20:05:46  Parsing macros/python_model/python.sql
2022-12-25 20:05:46.049758 (Thread-370): 20:05:46  Parsing macros/materializations/hooks.sql
2022-12-25 20:05:46.053287 (Thread-370): 20:05:46  Parsing macros/materializations/configs.sql
2022-12-25 20:05:46.055472 (Thread-370): 20:05:46  Parsing macros/materializations/seeds/seed.sql
2022-12-25 20:05:46.061688 (Thread-370): 20:05:46  Parsing macros/materializations/seeds/helpers.sql
2022-12-25 20:05:46.078202 (Thread-370): 20:05:46  Parsing macros/materializations/tests/test.sql
2022-12-25 20:05:46.082334 (Thread-370): 20:05:46  Parsing macros/materializations/tests/helpers.sql
2022-12-25 20:05:46.084243 (Thread-370): 20:05:46  Parsing macros/materializations/tests/where_subquery.sql
2022-12-25 20:05:46.084810 (Thread-371): handling status request
2022-12-25 20:05:46.086681 (Thread-370): 20:05:46  Parsing macros/materializations/models/view/helpers.sql
2022-12-25 20:05:46.087552 (Thread-372): handling status request
2022-12-25 20:05:46.087808 (Thread-371): 20:05:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb101932e0>]}
2022-12-25 20:05:46.089080 (Thread-370): 20:05:46  Parsing macros/materializations/models/view/create_or_replace_view.sql
2022-12-25 20:05:46.089414 (Thread-372): 20:05:46  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe0218430>]}
2022-12-25 20:05:46.089891 (Thread-371): sending response (<Response 187 bytes [200 OK]>) to 10.0.192.137
2022-12-25 20:05:46.093006 (Thread-370): 20:05:46  Parsing macros/materializations/models/view/create_view_as.sql
2022-12-25 20:05:46.093430 (Thread-372): sending response (<Response 187 bytes [200 OK]>) to 10.0.192.137
2022-12-25 20:05:46.096043 (Thread-370): 20:05:46  Parsing macros/materializations/models/view/view.sql
2022-12-25 20:05:46.101578 (Thread-370): 20:05:46  Parsing macros/materializations/models/incremental/strategies.sql
2022-12-25 20:05:46.108098 (Thread-370): 20:05:46  Parsing macros/materializations/models/incremental/column_helpers.sql
2022-12-25 20:05:46.115539 (Thread-370): 20:05:46  Parsing macros/materializations/models/incremental/incremental.sql
2022-12-25 20:05:46.124868 (Thread-370): 20:05:46  Parsing macros/materializations/models/incremental/on_schema_change.sql
2022-12-25 20:05:46.139708 (Thread-370): 20:05:46  Parsing macros/materializations/models/incremental/is_incremental.sql
2022-12-25 20:05:46.141099 (Thread-370): 20:05:46  Parsing macros/materializations/models/incremental/merge.sql
2022-12-25 20:05:46.154817 (Thread-370): 20:05:46  Parsing macros/materializations/models/table/create_table_as.sql
2022-12-25 20:05:46.158094 (Thread-370): 20:05:46  Parsing macros/materializations/models/table/table.sql
2022-12-25 20:05:46.163148 (Thread-370): 20:05:46  Parsing macros/materializations/snapshots/strategies.sql
2022-12-25 20:05:46.177527 (Thread-370): 20:05:46  Parsing macros/materializations/snapshots/snapshot_merge.sql
2022-12-25 20:05:46.179086 (Thread-370): 20:05:46  Parsing macros/materializations/snapshots/snapshot.sql
2022-12-25 20:05:46.189377 (Thread-370): 20:05:46  Parsing macros/materializations/snapshots/helpers.sql
2022-12-25 20:05:46.201014 (Thread-370): 20:05:46  Parsing macros/generic_test_sql/not_null.sql
2022-12-25 20:05:46.201846 (Thread-370): 20:05:46  Parsing macros/generic_test_sql/relationships.sql
2022-12-25 20:05:46.202706 (Thread-370): 20:05:46  Parsing macros/generic_test_sql/unique.sql
2022-12-25 20:05:46.203400 (Thread-370): 20:05:46  Parsing macros/generic_test_sql/accepted_values.sql
2022-12-25 20:05:46.204698 (Thread-370): 20:05:46  Parsing macros/utils/intersect.sql
2022-12-25 20:05:46.205540 (Thread-370): 20:05:46  Parsing macros/utils/position.sql
2022-12-25 20:05:46.206647 (Thread-370): 20:05:46  Parsing macros/utils/escape_single_quotes.sql
2022-12-25 20:05:46.208129 (Thread-370): 20:05:46  Parsing macros/utils/safe_cast.sql
2022-12-25 20:05:46.209256 (Thread-370): 20:05:46  Parsing macros/utils/array_construct.sql
2022-12-25 20:05:46.210743 (Thread-370): 20:05:46  Parsing macros/utils/cast_bool_to_text.sql
2022-12-25 20:05:46.211770 (Thread-370): 20:05:46  Parsing macros/utils/datediff.sql
2022-12-25 20:05:46.212953 (Thread-370): 20:05:46  Parsing macros/utils/concat.sql
2022-12-25 20:05:46.213949 (Thread-370): 20:05:46  Parsing macros/utils/length.sql
2022-12-25 20:05:46.214895 (Thread-370): 20:05:46  Parsing macros/utils/any_value.sql
2022-12-25 20:05:46.215820 (Thread-370): 20:05:46  Parsing macros/utils/data_types.sql
2022-12-25 20:05:46.222247 (Thread-370): 20:05:46  Parsing macros/utils/array_concat.sql
2022-12-25 20:05:46.223296 (Thread-370): 20:05:46  Parsing macros/utils/right.sql
2022-12-25 20:05:46.230256 (Thread-370): 20:05:46  Parsing macros/utils/array_append.sql
2022-12-25 20:05:46.237071 (Thread-370): 20:05:46  Parsing macros/utils/last_day.sql
2022-12-25 20:05:46.238823 (Thread-370): 20:05:46  Parsing macros/utils/split_part.sql
2022-12-25 20:05:46.246182 (Thread-370): 20:05:46  Parsing macros/utils/date_trunc.sql
2022-12-25 20:05:46.247237 (Thread-370): 20:05:46  Parsing macros/utils/literal.sql
2022-12-25 20:05:46.248165 (Thread-370): 20:05:46  Parsing macros/utils/hash.sql
2022-12-25 20:05:46.249370 (Thread-370): 20:05:46  Parsing macros/utils/except.sql
2022-12-25 20:05:46.257165 (Thread-370): 20:05:46  Parsing macros/utils/bool_or.sql
2022-12-25 20:05:46.258639 (Thread-370): 20:05:46  Parsing macros/utils/replace.sql
2022-12-25 20:05:46.260548 (Thread-370): 20:05:46  Parsing macros/utils/dateadd.sql
2022-12-25 20:05:46.262445 (Thread-370): 20:05:46  Parsing macros/utils/listagg.sql
2022-12-25 20:05:46.265704 (Thread-370): 20:05:46  Parsing tests/generic/builtin.sql
2022-12-25 20:05:46.269906 (Thread-370): 20:05:46  Parsing macros/sql/pivot.sql
2022-12-25 20:05:46.275838 (Thread-370): 20:05:46  Parsing macros/sql/star.sql
2022-12-25 20:05:46.282168 (Thread-370): 20:05:46  Parsing macros/sql/get_table_types_sql.sql
2022-12-25 20:05:46.283687 (Thread-370): 20:05:46  Parsing macros/sql/generate_surrogate_key.sql
2022-12-25 20:05:46.286082 (Thread-370): 20:05:46  Parsing macros/sql/deduplicate.sql
2022-12-25 20:05:46.289555 (Thread-370): 20:05:46  Parsing macros/sql/surrogate_key.sql
2022-12-25 20:05:46.291016 (Thread-370): 20:05:46  Parsing macros/sql/get_query_results_as_dict.sql
2022-12-25 20:05:46.293134 (Thread-370): 20:05:46  Parsing macros/sql/date_spine.sql
2022-12-25 20:05:46.297159 (Thread-370): 20:05:46  Parsing macros/sql/get_column_values.sql
2022-12-25 20:05:46.307143 (Thread-370): 20:05:46  Parsing macros/sql/groupby.sql
2022-12-25 20:05:46.310957 (Thread-370): 20:05:46  Parsing macros/sql/get_tables_by_pattern_sql.sql
2022-12-25 20:05:46.317032 (Thread-370): 20:05:46  Parsing macros/sql/nullcheck_table.sql
2022-12-25 20:05:46.324207 (Thread-370): 20:05:46  Parsing macros/sql/get_tables_by_prefix_sql.sql
2022-12-25 20:05:46.325823 (Thread-370): 20:05:46  Parsing macros/sql/safe_divide.sql
2022-12-25 20:05:46.326889 (Thread-370): 20:05:46  Parsing macros/sql/get_relations_by_pattern.sql
2022-12-25 20:05:46.330027 (Thread-370): 20:05:46  Parsing macros/sql/get_relations_by_prefix.sql
2022-12-25 20:05:46.333292 (Thread-370): 20:05:46  Parsing macros/sql/safe_add.sql
2022-12-25 20:05:46.335355 (Thread-370): 20:05:46  Parsing macros/sql/haversine_distance.sql
2022-12-25 20:05:46.340667 (Thread-370): 20:05:46  Parsing macros/sql/unpivot.sql
2022-12-25 20:05:46.346272 (Thread-370): 20:05:46  Parsing macros/sql/generate_series.sql
2022-12-25 20:05:46.350229 (Thread-370): 20:05:46  Parsing macros/sql/get_single_value.sql
2022-12-25 20:05:46.352861 (Thread-370): 20:05:46  Parsing macros/sql/width_bucket.sql
2022-12-25 20:05:46.364062 (Thread-370): 20:05:46  Parsing macros/sql/nullcheck.sql
2022-12-25 20:05:46.373111 (Thread-370): 20:05:46  Parsing macros/sql/union.sql
2022-12-25 20:05:46.384915 (Thread-370): 20:05:46  Parsing macros/sql/get_filtered_columns_in_relation.sql
2022-12-25 20:05:46.387508 (Thread-370): 20:05:46  Parsing macros/jinja_helpers/pretty_time.sql
2022-12-25 20:05:46.388675 (Thread-370): 20:05:46  Parsing macros/jinja_helpers/_is_relation.sql
2022-12-25 20:05:46.389763 (Thread-370): 20:05:46  Parsing macros/jinja_helpers/slugify.sql
2022-12-25 20:05:46.391196 (Thread-370): 20:05:46  Parsing macros/jinja_helpers/_is_ephemeral.sql
2022-12-25 20:05:46.392961 (Thread-370): 20:05:46  Parsing macros/jinja_helpers/log_info.sql
2022-12-25 20:05:46.394053 (Thread-370): 20:05:46  Parsing macros/jinja_helpers/pretty_log_format.sql
2022-12-25 20:05:46.395135 (Thread-370): 20:05:46  Parsing macros/web/get_url_parameter.sql
2022-12-25 20:05:46.396592 (Thread-370): 20:05:46  Parsing macros/web/get_url_path.sql
2022-12-25 20:05:46.398969 (Thread-370): 20:05:46  Parsing macros/web/get_url_host.sql
2022-12-25 20:05:46.400770 (Thread-370): 20:05:46  Parsing macros/generic_tests/expression_is_true.sql
2022-12-25 20:05:46.402671 (Thread-370): 20:05:46  Parsing macros/generic_tests/not_constant.sql
2022-12-25 20:05:46.404657 (Thread-370): 20:05:46  Parsing macros/generic_tests/sequential_values.sql
2022-12-25 20:05:46.408277 (Thread-370): 20:05:46  Parsing macros/generic_tests/not_null_proportion.sql
2022-12-25 20:05:46.411297 (Thread-370): 20:05:46  Parsing macros/generic_tests/at_least_one.sql
2022-12-25 20:05:46.413314 (Thread-370): 20:05:46  Parsing macros/generic_tests/equality.sql
2022-12-25 20:05:46.416709 (Thread-370): 20:05:46  Parsing macros/generic_tests/equal_rowcount.sql
2022-12-25 20:05:46.420579 (Thread-370): 20:05:46  Parsing macros/generic_tests/not_accepted_values.sql
2022-12-25 20:05:46.422582 (Thread-370): 20:05:46  Parsing macros/generic_tests/mutually_exclusive_ranges.sql
2022-12-25 20:05:46.431026 (Thread-370): 20:05:46  Parsing macros/generic_tests/relationships_where.sql
2022-12-25 20:05:46.433059 (Thread-370): 20:05:46  Parsing macros/generic_tests/not_empty_string.sql
2022-12-25 20:05:46.434815 (Thread-370): 20:05:46  Parsing macros/generic_tests/accepted_range.sql
2022-12-25 20:05:46.437066 (Thread-370): 20:05:46  Parsing macros/generic_tests/fewer_rows_than.sql
2022-12-25 20:05:46.441093 (Thread-370): 20:05:46  Parsing macros/generic_tests/unique_combination_of_columns.sql
2022-12-25 20:05:46.443732 (Thread-370): 20:05:46  Parsing macros/generic_tests/recency.sql
2022-12-25 20:05:46.446924 (Thread-370): 20:05:46  Parsing macros/generic_tests/cardinality_equality.sql
2022-12-25 20:05:46.802229 (Thread-370): 20:05:46  1699: static parser successfully parsed mart/fct_top_tracks.sql
2022-12-25 20:05:46.805100 (Thread-370): 20:05:46  1699: static parser successfully parsed mart/fct_songplays.sql
2022-12-25 20:05:46.807807 (Thread-370): 20:05:46  1699: static parser successfully parsed mart/fct_top_artists.sql
2022-12-25 20:05:46.810356 (Thread-370): 20:05:46  1603: static parser failed on mart/dim_artists.sql
2022-12-25 20:05:46.815622 (Thread-370): 20:05:46  1602: parser fallback to jinja rendering on mart/dim_artists.sql
2022-12-25 20:05:46.816879 (Thread-370): 20:05:46  1603: static parser failed on mart/dim_albums.sql
2022-12-25 20:05:46.821478 (Thread-370): 20:05:46  1602: parser fallback to jinja rendering on mart/dim_albums.sql
2022-12-25 20:05:46.822757 (Thread-370): 20:05:46  1603: static parser failed on mart/dim_tracks.sql
2022-12-25 20:05:46.827717 (Thread-370): 20:05:46  1602: parser fallback to jinja rendering on mart/dim_tracks.sql
2022-12-25 20:05:46.829079 (Thread-370): 20:05:46  1699: static parser successfully parsed staging/stg_top_tracks.sql
2022-12-25 20:05:46.831743 (Thread-370): 20:05:46  1699: static parser successfully parsed staging/stg_songplays.sql
2022-12-25 20:05:46.834670 (Thread-370): 20:05:46  1699: static parser successfully parsed staging/stg_top_artists.sql
2022-12-25 20:05:46.837559 (Thread-370): 20:05:46  1699: static parser successfully parsed view/vw_top_track_genres.sql
2022-12-25 20:05:46.840532 (Thread-370): 20:05:46  1699: static parser successfully parsed view/vw_top_artist_genres.sql
2022-12-25 20:05:46.843653 (Thread-370): 20:05:46  1699: static parser successfully parsed view/vw_songplays_genres.sql
2022-12-25 20:05:46.846865 (Thread-370): 20:05:46  1699: static parser successfully parsed view/vw_songplays_albums.sql
2022-12-25 20:05:47.100178 (Thread-370): 20:05:47  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec3500fac0>]}
2022-12-25 20:05:47.385544 (Thread-373): handling status request
2022-12-25 20:05:47.385987 (Thread-373): 20:05:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34f5c880>]}
2022-12-25 20:05:47.387752 (Thread-373): sending response (<Response 48610 bytes [200 OK]>) to 10.0.192.137
2022-12-25 20:05:47.393434 (Thread-374): handling status request
2022-12-25 20:05:47.393723 (Thread-374): 20:05:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34f5c550>]}
2022-12-25 20:05:47.395177 (Thread-374): sending response (<Response 48610 bytes [200 OK]>) to 10.0.192.137
2022-12-25 20:07:38.335047 (Thread-375): handling status request
2022-12-25 20:07:38.336565 (Thread-375): 20:07:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34cd0310>]}
2022-12-25 20:07:38.338359 (Thread-375): sending response (<Response 48610 bytes [200 OK]>) to 10.0.192.137
2022-12-25 20:07:38.592893 (Thread-376): handling run_sql request
2022-12-25 20:07:38.593288 (Thread-376): 20:07:38  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34ca40a0>]}
2022-12-25 20:07:41.218300 (Thread-376): sending response (<Response 140 bytes [200 OK]>) to 10.0.192.137
2022-12-25 20:07:41.250768 (MainThread): 20:07:41  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6025ddc-95fd-40ca-ac35-f83b5dfff1f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f53d8254b20>]}
2022-12-25 20:07:41.251278 (MainThread): 20:07:41  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 431 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 20:07:41.251861 (Thread-1): 20:07:41  Acquiring new bigquery connection "rpc.spotify.request"
2022-12-25 20:07:41.252004 (Thread-1): 20:07:41  Began compiling node rpc.spotify.request
2022-12-25 20:07:41.252092 (Thread-1): 20:07:41  Compiling rpc.spotify.request
2022-12-25 20:07:41.255457 (Thread-1): 20:07:41  finished collecting timing info
2022-12-25 20:07:41.255593 (Thread-1): 20:07:41  Began executing node rpc.spotify.request
2022-12-25 20:07:41.255700 (Thread-1): 20:07:41  Opening a new connection, currently in state init
2022-12-25 20:07:41.260302 (Thread-1): 20:07:41  On rpc.spotify.request: -- top_artist_genres table
With other_genres as (
    select split(a.artist_genre_others) as nested_genres
    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_top_artists` f
    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)
),

artist_genres as (
    select
        a.artist_genre
    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_top_artists` f
    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)
    union all
    select
        unnested
    from other_genres, unnest(nested_genres) as unnested
)
select
    *,
    count(*) as count
from artist_genres
where artist_genre is not null
group by artist_genre       
order by count desc
limit 500
/* limit added automatically by dbt cloud */
2022-12-25 20:07:41.419843 (Thread-377): handling poll request
2022-12-25 20:07:41.420311 (Thread-377): 20:07:41  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34f66c10>]}
2022-12-25 20:07:41.421264 (Thread-377): sending response (<Response 4193 bytes [200 OK]>) to 10.0.192.137
2022-12-25 20:07:42.615346 (Thread-378): handling poll request
2022-12-25 20:07:42.615753 (Thread-378): 20:07:42  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec34fb3f10>]}
2022-12-25 20:07:42.616229 (Thread-378): sending response (<Response 400 bytes [200 OK]>) to 10.0.192.137
2022-12-25 20:07:42.646430 (Thread-1): 20:07:42  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:3737660a-9db4-4c52-8f3e-2cf9a92e402b:US&page=queryresults
2022-12-25 20:07:42.646836 (Thread-1): 20:07:42  finished collecting timing info
2022-12-25 20:07:43.810178 (Thread-379): handling poll request
2022-12-25 20:07:43.810627 (Thread-379): 20:07:43  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb104a6d90>]}
2022-12-25 20:07:43.811791 (Thread-379): sending response (<Response 9232 bytes [200 OK]>) to 10.0.192.137
2022-12-25 20:07:47.296739 (Thread-380): 20:07:47  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-12-25 20:07:47.297365 (Thread-380): 20:07:47  Partial parsing: updated file: spotify://models/view/vw_top_artist_genres.sql
2022-12-25 20:07:47.304901 (Thread-380): 20:07:47  1699: static parser successfully parsed view/vw_top_artist_genres.sql
2022-12-25 20:07:47.364403 (Thread-380): 20:07:47  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb100d7be0>]}
2022-12-25 20:07:47.660886 (Thread-381): handling status request
2022-12-25 20:07:47.661299 (Thread-381): 20:07:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb10196a30>]}
2022-12-25 20:07:47.661839 (Thread-381): sending response (<Response 1611 bytes [200 OK]>) to 10.0.192.137
2022-12-25 20:07:47.668083 (Thread-382): handling status request
2022-12-25 20:07:47.668352 (Thread-382): 20:07:47  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febe00e9970>]}
2022-12-25 20:07:47.668705 (Thread-382): sending response (<Response 1611 bytes [200 OK]>) to 10.0.192.137
2022-12-25 20:11:03.873682 (Thread-383): handling status request
2022-12-25 20:11:03.874664 (Thread-383): 20:11:03  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febf40d4820>]}
2022-12-25 20:11:03.875151 (Thread-383): sending response (<Response 1611 bytes [200 OK]>) to 10.0.192.137
2022-12-25 20:11:04.065600 (Thread-384): handling run_sql request
2022-12-25 20:11:04.066066 (Thread-384): 20:11:04  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7febf40d4550>]}
2022-12-25 20:11:06.659683 (Thread-384): sending response (<Response 140 bytes [200 OK]>) to 10.0.192.137
2022-12-25 20:11:06.692941 (MainThread): 20:11:06  Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '584ca12d-a365-4dfe-8215-bb821749ac4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46a00d71f0>]}
2022-12-25 20:11:06.693449 (MainThread): 20:11:06  Found 13 models, 31 tests, 0 snapshots, 0 analyses, 431 macros, 0 operations, 5 seed files, 0 sources, 0 exposures, 0 metrics
2022-12-25 20:11:06.694038 (Thread-1): 20:11:06  Acquiring new bigquery connection "rpc.spotify.request"
2022-12-25 20:11:06.694181 (Thread-1): 20:11:06  Began compiling node rpc.spotify.request
2022-12-25 20:11:06.694273 (Thread-1): 20:11:06  Compiling rpc.spotify.request
2022-12-25 20:11:06.697721 (Thread-1): 20:11:06  finished collecting timing info
2022-12-25 20:11:06.697856 (Thread-1): 20:11:06  Began executing node rpc.spotify.request
2022-12-25 20:11:06.697964 (Thread-1): 20:11:06  Opening a new connection, currently in state init
2022-12-25 20:11:06.702477 (Thread-1): 20:11:06  On rpc.spotify.request: -- top_track_genres table
With other_genres as (
    select split(a.artist_genre_others) as nested_genres
    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_top_tracks` f
    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)
),

track_genres as (
    select
        a.artist_genre
    from `dbt-demo-data-372717`.`dbt_ddemo`.`fct_top_tracks` f
    left join `dbt-demo-data-372717`.`dbt_ddemo`.`dim_artists` a using (artist_id)
    union all
    select
        unnested
    from other_genres, unnest(nested_genres) as unnested
)
select
    *,
    count(*) as count
from track_genres
where artist_genre is not null
group by artist_genre       
order by count desc
limit 500
/* limit added automatically by dbt cloud */
2022-12-25 20:11:06.910941 (Thread-385): handling poll request
2022-12-25 20:11:06.911394 (Thread-385): 20:11:06  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb10108610>]}
2022-12-25 20:11:06.912332 (Thread-385): sending response (<Response 4188 bytes [200 OK]>) to 10.0.192.137
2022-12-25 20:11:07.963954 (Thread-1): 20:11:07  BigQuery adapter: https://console.cloud.google.com/bigquery?project=dbt-demo-data-372717&j=bq:eafe8374-5773-444e-a1f4-b3491fd387bb:US&page=queryresults
2022-12-25 20:11:07.964299 (Thread-1): 20:11:07  finished collecting timing info
2022-12-25 20:11:08.118745 (Thread-386): handling poll request
2022-12-25 20:11:08.119180 (Thread-386): 20:11:08  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb100d1e50>]}
2022-12-25 20:11:08.119728 (Thread-386): sending response (<Response 1230 bytes [200 OK]>) to 10.0.192.137
2022-12-25 20:11:09.320514 (Thread-387): handling poll request
2022-12-25 20:11:09.320952 (Thread-387): 20:11:09  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb10198d90>]}
2022-12-25 20:11:09.350526 (Thread-387): sending response (<Response 8270 bytes [200 OK]>) to 10.0.192.137
2022-12-25 20:11:15.076402 (Thread-388): 20:11:15  Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
2022-12-25 20:11:15.077064 (Thread-388): 20:11:15  Partial parsing: updated file: spotify://models/view/vw_top_track_genres.sql
2022-12-25 20:11:15.083966 (Thread-388): 20:11:15  1699: static parser successfully parsed view/vw_top_track_genres.sql
2022-12-25 20:11:15.145870 (Thread-388): 20:11:15  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed7c96d0>]}
2022-12-25 20:11:15.844941 (Thread-389): handling status request
2022-12-25 20:11:15.845347 (Thread-389): 20:11:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed7bf1f0>]}
2022-12-25 20:11:15.845878 (Thread-389): sending response (<Response 1609 bytes [200 OK]>) to 10.0.192.137
2022-12-25 20:11:15.912133 (Thread-390): handling status request
2022-12-25 20:11:15.912484 (Thread-390): 20:11:15  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec28414910>]}
2022-12-25 20:11:15.912933 (Thread-390): sending response (<Response 1609 bytes [200 OK]>) to 10.0.192.137
2022-12-25 20:11:21.000116 (Thread-391): 20:11:21  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-12-25 20:11:21.000359 (Thread-391): 20:11:21  Partial parsing enabled, no changes found, skipping parsing
2022-12-25 20:11:21.007802 (Thread-391): 20:11:21  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb1005ceb0>]}
2022-12-25 20:11:21.402297 (Thread-392): handling status request
2022-12-25 20:11:21.402752 (Thread-392): 20:11:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed7bcf40>]}
2022-12-25 20:11:21.403272 (Thread-392): sending response (<Response 1273 bytes [200 OK]>) to 10.0.192.137
2022-12-25 20:11:21.564304 (Thread-393): handling status request
2022-12-25 20:11:21.564716 (Thread-393): 20:11:21  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaed7bc880>]}
2022-12-25 20:11:21.565178 (Thread-393): sending response (<Response 1273 bytes [200 OK]>) to 10.0.192.137
2022-12-25 20:11:24.684913 (Thread-394): 20:11:24  Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
2022-12-25 20:11:24.685139 (Thread-394): 20:11:24  Partial parsing enabled, no changes found, skipping parsing
2022-12-25 20:11:24.692299 (Thread-394): 20:11:24  Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaec12c8e0>]}
2022-12-25 20:11:25.046936 (Thread-395): handling status request
2022-12-25 20:11:25.047360 (Thread-395): 20:11:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb10052a90>]}
2022-12-25 20:11:25.047878 (Thread-395): sending response (<Response 1273 bytes [200 OK]>) to 10.0.192.137
2022-12-25 20:11:25.189480 (Thread-396): handling status request
2022-12-25 20:11:25.189906 (Thread-396): 20:11:25  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb10052850>]}
2022-12-25 20:11:25.190381 (Thread-396): sending response (<Response 1273 bytes [200 OK]>) to 10.0.192.137
2022-12-25 20:11:33.995140 (Thread-397): handling status request
2022-12-25 20:11:33.995557 (Thread-397): 20:11:33  Sending event: {'category': 'dbt', 'action': 'rpc_request', 'label': 'c90ee146-f111-49e8-9a08-ea22f9545476', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feb100526d0>]}
2022-12-25 20:11:33.996021 (Thread-397): sending response (<Response 1273 bytes [200 OK]>) to 10.0.192.137
